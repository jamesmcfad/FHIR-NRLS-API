<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="To support the creation of NRL pointers">
<meta name="keywords" content="fhirfor_providers,  structured rest documentreference">
<title>API Create Interaction | NRL</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="FHIR-NRLS-API" href="https://developer.nhs.uk/apis/nrl/feed.xml">





    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> NRL API | FHIR&reg;</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="Search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="API Create Interaction">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                








<ul id="mysidebar" class="nav">

    <!-- <p style="font-size:2em;">-->

       <!-- <img src="images/interopen.png" height="48px" alt="INTEROpen Logo"/>
    INTEROPen</p>
    <p style="font-size:16px;">Supported by -->
    <img src="images/logo.png"   alt="NHS Digital Logo"/>
    <!--</p>-->


    <li class="sidebarTitle">NRL 2.3.0-beta API <i>specification</i></li>
    
    
    
    <li>
        <a href="#">Overview</a>
        <ul>
            
            
            
            <li><a href="index.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="overview_guide_versioning.html">Product Versioning</a></li>
            
            
            
            
            
            
            <li><a href="overview_release_notes.html">Release Notes</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Solution</a>
        <ul>
            
            
            
            <li><a href="overview_concepts.html">Concepts</a></li>
            
            
            
            
            
            
            <li><a href="overview_behaviours.html">Behaviour</a></li>
            
            
            
            
            
            
            <li><a href="overview_principles.html">Principles</a></li>
            
            
            
            
            
            
            <li><a href="overview_data_model.html">Data model</a></li>
            
            
            
            
            
            
            <li><a href="overview_interactions.html">Interactions</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">General Guidance</a>
        <ul>
            
            
            
            <li><a href="pointer_identity.html">Pointer Identity</a></li>
            
            
            
            
            
            
            <li><a href="pointer_errors.html">Pointer Errors</a></li>
            
            
            
            
            
            
            <li><a href="pointer_lifecycle.html">Pointer Lifecycle</a></li>
            
            
            
            
            
            
            <li><a href="pointer_maintenance.html">Pointer Maintenance</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Development Guidance</a>
        <ul>
            
            
            
            <li><a href="explore.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="development_general_api_guidance.html">General API Guidance</a></li>
            
            
            
            <li class="subfolders">
                <a href="#">DocumentReference API Interactions</a>
                <ul>
                    
                    
                    
                    <li class="active"><a href="api_interaction_create.html">Create</a></li>
                    
                    
                    
                    
                    
                    <li><a href="api_interaction_supersede.html">Create (Supersede)</a></li>
                    
                    
                    
                    
                    
                    <li><a href="api_interaction_update.html">Update</a></li>
                    
                    
                    
                    
                    
                    <li><a href="api_interaction_delete.html">Delete</a></li>
                    
                    
                    
                    
                    
                    <li><a href="api_interaction_read.html">Read</a></li>
                    
                    
                    
                    
                    
                    <li><a href="api_interaction_search.html">Search</a></li>
                    
                    
                    
                </ul>
            </li>
            
            
            
            <li class="subfolders">
                <a href="#">Record Retrieval Guidance</a>
                <ul>
                    
                    
                    
                    <li><a href="retrieval_overview.html">Overview</a></li>
                    
                    
                    
                    
                    
                    <li><a href="retrieval_interaction_read.html">Read Interaction</a></li>
                    
                    
                    
                    
                    
                    <li><a href="retrieval_consumer_guidance.html">Consumer Guidance</a></li>
                    
                    
                    
                    
                    
                    <li><a href="retrieval_provider_guidance.html">Provider Guidance</a></li>
                    
                    
                    
                    
                    
                    <li><a href="retrieval_formats.html">Formats</a></li>
                    
                    
                    
                </ul>
            </li>
            
            
            
            
            
            
            <li><a href="explore_reference.html">FHIR Profile Reference</a></li>
            
            
            
            
            
            
            <li><a href="explore_fhir_open_source_guidance.html">FHIR Open-Source Resources</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
    <li>
        <a href="#">Integrate With Spine</a>
        <ul>
            
            
            
            <li><a href="integration_authentication_authorisation.html">Authentication &amp; Authorisation</a></li>
            
            
            
            
            
            
            <li><a href="explore_rbac_mapping.html">Access Control</a></li>
            
            
            
            
            
            
            <li><a href="development_api_security_guidance.html">Security</a></li>
            
            
            
            
            
            
            <li><a href="integration_access_tokens_JWT.html">Access Tokens (JWT)</a></li>
            
            
            
            
            
            
            <li><a href="integration_auditing.html">Auditing</a></li>
            
            
            
            
            
            
            <li><a href="integration_personal_demographics_service.html">Personal Demographics Service</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
        
            <li><a href="/assure.html">Assure</a></li>
        
    
        
    
    <li>
        <a href="#">Help &amp; Support</a>
        <ul>
            
            
            
            <li><a href="support_faq.html">Frequently Asked Questions (FAQ)</a></li>
            
            
            
            
            
            
            <li><a href="support_communications.html">Communication Channels</a></li>
            
            
            
            
        </ul>
     </li>
       
        
    
        
            <li><a href="/tags.html">Tags</a></li>
        
    
        
    
        
            <li><a href="/overview_glossary.html">Glossary</a></li>
        
    
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    <!--</li>-->
</ul>
<!--</div>-->

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-header">
   <h1 class="post-title-main">API Create Interaction</h1>
</div>

<script>
    $(function() {
        $('a[href^="http://"], a[href^="https://"]')
            .attr('target', '_blank') // open all external links in new tab
            .attr('rel', 'noopener noreferrer'); // https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/
    });
</script>



<div class="post-content">

   
    <div class="summary">To support the creation of NRL pointers</div>
   

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.
<!-- removed h3 and h4 from toc KGM 10/JULY/2017 -->
$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    

  <div markdown="span" class="alert alert-warning" role="alert"><i class="fa fa-warning"></i> <b>Important:</b> This site is under active development by NHS Digital and is intended to provide all the technical resources you need to successfully develop with the National Record Locator API. This project is being developed using an agile methodology, so iterative updates to content will be added on a regular basis.</div>

  
<h2 id="0-references">References</h2>

<table border="0" width="100%">
    <tr>
        <td><div class="alert alert-info" role="alert"><i class="fa fa-gavel"></i> <b>NHS Digital Profile:</b><br /> <a href="https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1">DocumentReference</a></div></td>
        <td><div class="alert alert-danger" role="alert"><i class="fa fa-fire"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href="https://www.hl7.org/fhir/STU3/documentreference.html">DocumentReference</a></div> </td>
          <td><div class="alert alert-success" role="alert"><i class="fa fa-cog"></i> <b>User Stories:</b><br /> - </div></td>
        <!--<td><div markdown="span" class="alert alert-success" role="alert"><i class="fa fa-cog"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->
</tr>
</table>

<h2 id="create">Create</h2>

<p>Provider interaction to support the creation of NRL pointers.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href="explore.html#2-prerequisites-for-nrl-api">Development Guidance</a> page MUST be followed when using this interaction.</p>

<h2 id="create-request-headers">Create Request Headers</h2>

<p>Provider API create requests support the following HTTP request headers:</p>

<table>
  <thead>
    <tr>
      <th>Header</th>
      <th>Value</th>
      <th>Conformance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">Accept</code></td>
      <td>The <code class="highlighter-rouge">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class="highlighter-rouge">application/fhir+json</code> or <code class="highlighter-rouge">application/fhir+xml</code>. See the RESTful API <a href="development_general_api_guidance.html#content-types">Content types</a> section.</td>
      <td>OPTIONAL</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">Authorization</code></td>
      <td>The <code class="highlighter-rouge">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href="integration_access_tokens_JWT.html">Access Tokens (JWT)</a> for details.</td>
      <td>REQUIRED</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">fromASID</code></td>
      <td>Client System ASID</td>
      <td>REQUIRED</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">toASID</code></td>
      <td>The Spine ASID</td>
      <td>REQUIRED</td>
    </tr>
  </tbody>
</table>

<h2 id="create-operation">Create Operation</h2>

<div class="alert alert-success" role="alert">
<code class="highlighter-rouge">POST [baseUrl]/DocumentReference</code>
</div>

<p>Provider systems:</p>

<ul>
  <li>MUST construct and send a new Pointer (DocumentReference) resource that conforms to the NRL-DocumentReference-1 profile and submit this to NRL using the FHIR RESTful <a href="https://www.hl7.org/fhir/http.html#create">create</a> interaction.</li>
  <li>MUST include the URI of the NRL-DocumentReference-1 profile StructureDefinition in the DocumentReference.meta.profile element of the DocumentReference resource.</li>
  <li>MUST include all of the mandatory data-elements contained in the <code class="highlighter-rouge">NRL-DocumentReference-1</code> profile when constructing a DocumentReference. The mandatory data-elements are detailed on the <a href="explore_reference.html#2-nrl-data-model-to-fhir-profile-mapping">Developer FHIR Resource</a> page.</li>
  <li>MUST supply <code class="highlighter-rouge">subject</code>, <code class="highlighter-rouge">custodian</code> and <code class="highlighter-rouge">author</code> attributes as absolute literal references, the formats of which can be found on the <a href="explore_reference.html#6-identifiers">Developer FHIR Resource</a> page.</li>
  <li>MUST only create pointers for records where they are the pointer owner (custodian).</li>
</ul>

<p>For all create requests the <code class="highlighter-rouge">custodian</code> ODS code in the DocumentReference resource MUST be affiliated with the <code class="highlighter-rouge">Client System ASID</code> value in the <code class="highlighter-rouge">fromASID</code> HTTP request header sent to the NRL.</p>

<h3 id="xml-example-of-a-new-documentreference-resource-pointer">XML Example of a New DocumentReference Resource (Pointer)</h3>

<div class="github-sample-wrapper scroll-height-350">

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;DocumentReference</span> <span class="na">xmlns=</span><span class="s">"http://hl7.org/fhir"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">value=</span><span class="s">"c037a0cb-0c77-4976-83a1-a5d2703e6aa3-23325861873450086113"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;meta&gt;</span>
        <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/meta&gt;</span>
    <span class="nt">&lt;status</span> <span class="na">value=</span><span class="s">"current"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;coding&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"http://snomed.info/sct"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"736253002"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"Mental health crisis plan"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/coding&gt;</span>
    <span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;class&gt;</span>
        <span class="nt">&lt;coding&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"http://snomed.info/sct"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"734163000"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"Care plan"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/coding&gt;</span>
    <span class="nt">&lt;/class&gt;</span>
    <span class="nt">&lt;subject&gt;</span>
        <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/subject&gt;</span>
    <span class="nt">&lt;indexed</span> <span class="na">value=</span><span class="s">"2016-03-08T15:26:01+01:00"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;author&gt;</span>
        <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">"https://directory.spineservices.nhs.uk/STU3/Organization/RGD"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/author&gt;</span>
    <span class="nt">&lt;custodian&gt;</span>
        <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">"https://directory.spineservices.nhs.uk/STU3/Organization/RR8"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/custodian&gt;</span>
    <span class="nt">&lt;content&gt;</span>
        <span class="nt">&lt;attachment&gt;</span>
            <span class="nt">&lt;contentType</span> <span class="na">value=</span><span class="s">"application/pdf"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;url</span> <span class="na">value=</span><span class="s">"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;creation</span> <span class="na">value=</span><span class="s">"2016-03-08T15:26:00+01:00"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/attachment&gt;</span>
        <span class="nt">&lt;format&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"urn:nhs-ic:unstructured"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"Unstructured Document"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/format&gt;</span>
        <span class="nt">&lt;extension</span> <span class="na">url=</span><span class="s">"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;valueCodeableConcept&gt;</span>
                <span class="nt">&lt;coding&gt;</span>
                    <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1"</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"static"</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"Static"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/coding&gt;</span>
            <span class="nt">&lt;/valueCodeableConcept&gt;</span>
        <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;/content&gt;</span>
    <span class="nt">&lt;context&gt;</span>
        <span class="nt">&lt;period&gt;</span>
            <span class="nt">&lt;start</span> <span class="na">value=</span><span class="s">"2016-03-07T13:34:00+01:00"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/period&gt;</span>
        <span class="nt">&lt;practiceSetting&gt;</span>
            <span class="nt">&lt;coding&gt;</span>
                <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"http://snomed.info/sct"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"708168004"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"Mental health service"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/coding&gt;</span>
        <span class="nt">&lt;/practiceSetting&gt;</span>
    <span class="nt">&lt;/context&gt;</span>
<span class="nt">&lt;/DocumentReference&gt;</span></code></pre></figure>

</div>

<h3 id="json-example-of-a-new-documentreference-resource-pointer">JSON Example of a New DocumentReference Resource (Pointer)</h3>
<div class="github-sample-wrapper scroll-height-350">

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="s2">"resourceType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DocumentReference"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c037a0cb-0c77-4976-83a1-a5d2703e6aa3-23325861873450086113"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"profile"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1"</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"current"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"coding"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://snomed.info/sct"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"736253002"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mental health crisis plan"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"coding"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://snomed.info/sct"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"734163000"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Care plan"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"indexed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-08T15:26:01+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://directory.spineservices.nhs.uk/STU3/Organization/RGD"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"custodian"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://directory.spineservices.nhs.uk/STU3/Organization/RR8"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"attachment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/pdf"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"creation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-08T15:26:00+01:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"urn:nhs-ic:unstructured"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unstructured Document"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"extension"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"valueCodeableConcept"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"coding"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                            </span><span class="p">{</span><span class="w">
                                </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1"</span><span class="p">,</span><span class="w">
                                </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"static"</span><span class="p">,</span><span class="w">
                                </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Static"</span><span class="w">
                            </span><span class="p">}</span><span class="w">
                        </span><span class="p">]</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"context"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"period"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-07T13:34:00+01:00"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"practiceSetting"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"coding"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://snomed.info/sct"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"708168004"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mental health service"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

</div>

<h2 id="create-response">Create Response</h2>

<h3 id="success">Success</h3>

<ul>
  <li>MUST return a <code class="highlighter-rouge">201</code> <strong>CREATED</strong> HTTP status code on successful execution of the interaction and the entry has been successfully created in the NRL.</li>
  <li>MUST return a response body containing a payload with an <code class="highlighter-rouge">OperationOutcome</code> resource that conforms to the <a href="http://hl7.org/fhir/STU3/operationoutcome.html">‘Operation Outcome’</a> core FHIR resource (see the table below).</li>
  <li>MUST return an HTTP <code class="highlighter-rouge">Location</code> response header containing the full resolvable URL to the newly created ‘single’ DocumentReference.
    <ul>
      <li>The URL will contain the ‘server’ assigned <code class="highlighter-rouge">logical Id</code> of the new DocumentReference resource.</li>
      <li>The URL format MUST be: <code class="highlighter-rouge">https://[host]/[path]/[id]</code>.</li>
      <li>An example <code class="highlighter-rouge">Location</code> response header:
        <ul>
          <li><code class="highlighter-rouge">https://psis-sync.national.ncrs.nhs.uk/DocumentReference/297c3492-3b78-11e8-b333-6c3be5a609f5-54477876544511209789</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>When a resource has been created it will have a <code class="highlighter-rouge">versionId</code> of 1.</li>
</ul>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> The versionId is an integer that is assigned and maintained by the NRL server. When a new DocumentReference is created the server assigns it a versionId of 1. The versionId will be incremented during an update or supersede transaction. See <a href="api_interaction_update.html">API Interaction - Update</a> and <a href="api_interaction_supersede.html">API Interaction - Supersede</a> for more details on these transactions.<br /><br /> The NRL server will ignore any versionId value sent by a client in a create interaction. Instead, the server will ensure that the newly assigned versionId adheres to the rules laid out above. 
</div>

<p>The table summarises the <code class="highlighter-rouge">create</code> interaction HTTP response code and the values expected to be conveyed in the successful response body <code class="highlighter-rouge">OperationOutcome</code> payload:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Code</th>
      <th>issue-severity</th>
      <th>issue-type</th>
      <th>Details.Code</th>
      <th>Details.Display</th>
      <th>Details.Text</th>
      <th>Diagnostics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>201</td>
      <td>information</td>
      <td>informational</td>
      <td>RESOURCE_CREATED</td>
      <td>New resource created</td>
      <td>Spine message UUID</td>
      <td>Successfully created resource DocumentReference</td>
    </tr>
  </tbody>
</table>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> Upon successful creation of a pointer the NRL Service returns in the response payload an OperationOutcome resource with the OperationOutcome.issue.details.text element populated with a Spine internal message UUID. This UUID is used to identify the client’s Create transaction within Spine. A client system SHOULD reference the UUID in any calls raised with the Deployment Issues Resolution Team. The UUID will be used to retrieve log entries that relate to a specific client transaction.</div>

<h3 id="failure">Failure</h3>

<p>The following errors can be triggered when performing this operation:</p>

<ul>
  <li><a href="development_general_api_guidance.html#invalid-request-message">Invalid Request Message</a></li>
  <li><a href="development_general_api_guidance.html#invalid-resource">Invalid Resource</a></li>
  <li><a href="development_general_api_guidance.html#organisation-not-found">Organisation not found</a></li>
  <li><a href="development_general_api_guidance.html#invalid-nhs-number">Invalid NHS Number</a></li>
  <li><a href="development_general_api_guidance.html#parameters">Invalid Parameter</a></li>
  <li><a href="development_general_api_guidance.html#duplicate-resource">Duplicate Resource</a></li>
  <li><a href="development_general_api_guidance.html#headers">Missing or Invalid Headers</a></li>
</ul>

<h3 id="ensuring-that-masteridentifier-is-unique">Ensuring that <code class="highlighter-rouge">masterIdentifier</code> Is Unique</h3>

<p>The masterIdentifier should be unique within the NRL. For more information see the discussion on <a href="pointer_identity.html">Pointer identifiers</a>. The masterIdentifer is a <a href="https://www.hl7.org/fhir/datatypes.html#Identifier">FHIR identifier</a> and for NRL the system and value properties are mandatory.</p>

<p>The system defines how the value is made unique. As the FHIR specification says this might be a recognised standard that describes how this uniqueness is generated.</p>

<p>The NRL recommends the use of either an OID or a UUID as an Identifier in keeping with the need for the masterIdentifier value to be unique. In this case then the system MUST be “urn:ietf:rfc:3986” (see the <a href="https://www.hl7.org/fhir/identifier-registry.html">FHIR identifier registry</a> for details) and the value is of the form –</p>

<p>•	OID -  urn:oid:[oidValue] <br />
•	UUID - urn:uuid:[uuidValue]</p>

<p>See the <a href="https://www.hl7.org/fhir/datatypes-examples.html#Identifier">example</a> OID and UUID based Identifiers from the FHIR specification.</p>

<h2 id="code-examples">Code Examples</h2>

<h3 id="post-a-pointer-with-c">POST a Pointer with C</h3>

<p>The following code samples are taken from the NRL Demonstrator application which has both Consumer and Provider client implementations built in. More information about the design solution can be found
on the <a href="https://github.com/nhsconnect/nrls-reference-implementation/wiki">NRL Demonstrator Wiki</a></p>

<p>First we generate a base pointer request model that includes the custodian and author details, and the specific care plan attachment details that are later used to build our pointer (DocumentReference). 
These pointer values are taken from the demo crisis plan that is created for the Demonstrator Provider system.</p>

<p>Then we call our DocumentReference service GenerateAndCreatePointer method which will generate our pointer (DocumentReference) using the values stored in the model, build a POST command request and then start the call to the NRL API.</p>

<div class="github-sample-wrapper">
<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128">This Github Sample</a> is by <a href="https://github.com/nhsconnect">nhsconnect</a>
  </div>
  <div class="meta-info">
    Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128 <a href="https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128">view</a> <a href="https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">pointerRequest</span> <span class="p">=</span> <span class="n">NrlsPointerRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">crisisPlan</span><span class="p">.</span><span class="n">OrgCode</span><span class="p">,</span> <span class="n">crisisPlan</span><span class="p">.</span><span class="n">OrgCode</span><span class="p">,</span> <span class="n">crisisPlan</span><span class="p">.</span><span class="n">PatientNhsNumber</span><span class="p">,</span> <span class="s">$"https://spine-proxy.national.ncrs.nhs.uk/</span><span class="p">{</span><span class="n">newCrisisPlan</span><span class="p">.</span><span class="n">Id</span><span class="p">}</span><span class="s">/mental-health-care-plan.pdf"</span><span class="p">,</span> <span class="s">"application/pdf"</span><span class="p">,</span> <span class="n">MentalHealthCrisisPlanTypeCode</span><span class="p">,</span> <span class="n">MentalHealthCrisisPlanTypeDisplay</span><span class="p">,</span> <span class="n">crisisPlan</span><span class="p">.</span><span class="n">Asid</span><span class="p">);</span>

<span class="c1">//Create new NRLS pointer</span>
<span class="kt">var</span> <span class="n">newPointer</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_documentReferenceServices</span><span class="p">.</span><span class="nf">GenerateAndCreatePointer</span><span class="p">(</span><span class="n">pointerRequest</span><span class="p">);</span></code></pre></figure>

</div>

<p><br />
Within the DocumentReference service GenerateAndCreatePointer method we generate our pointer model and then serialise this generated model ready for posting:</p>

<div class="github-sample-wrapper">
<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54">This Github Sample</a> is by <a href="https://github.com/nhsconnect">nhsconnect</a>
  </div>
  <div class="meta-info">
    Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54 <a href="https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54">view</a> <a href="https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="p">{</span>
    <span class="kt">var</span> <span class="n">pointerJson</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FhirJsonSerializer</span><span class="p">().</span><span class="nf">SerializeToString</span><span class="p">(</span><span class="n">pointer</span><span class="p">);</span></code></pre></figure>

</div>

<p><br />
<b>Calling the NRL</b><br />
Using our POST command request model we create a connection to the NRL using HttpClient.</p>

<p>You can view the common connection code example <a href="connectioncode_example.html">here</a>.</p>

<p><b>Explore the NRL</b><br />
You can explore and test the NRL POST command using Swagger in the <a href="https://data.developer.nhs.uk/nrls-ri/index.html#/Nrls/createPointer">NRL API Reference Implementation</a>.</p>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> The code in these examples is standard C# v7.2 taken directly from the <a href="https://nrls.digital.nhs.uk">NRL Demonstrator</a> code.<br /><br />The official <b><a href="https://ewoutkramer.github.io/fhir-net-api/">.NET FHIR Library</a></b> is utilised to construct, test, parse, and serialize FHIR models with ease.</div>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tags.html?tags=fhir" class="btn btn-default navbar-btn cursorNorm" role="button">fhir</a>
        
        
        
        <a href="tags.html?tags=for_providers" class="btn btn-default navbar-btn cursorNorm" role="button">for providers</a>
        
        
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                    <img class="pull-left" src="images/explanatoryline.png" alt="NHS Digital Explanatory Line"/>
                    <br/>
                    &copy;2020 NHS Digital<br />
                     Site last generated: Mar 30, 2020 <br />
                    6f68aaa672cc33d7cfbcf7b81b91ebc455b910a9<br/>
                    <br/>
                    <!-- OGL Licence -->
                    <div class="open-government-licence">
                        <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license" class="no_icon"><img src="images/licence/ogl-symbol-41px-retina-black.png"></img></a>
                        <p>All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license" class="no_icon">Open Government Licence v3.0</a>, except where otherwise stated</p>
                    </div>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99659472-1', 'auto');
  ga('send', 'pageview');

</script>

 


</body>

</html>
