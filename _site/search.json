[
  
  


	{
		
		"title": "Page Not Found",
		"tags": "",
		"keywords": "",
		"url": "404.html",
		"summary": "",
		"content": "<p>Sorry, but the page you were trying to view does not exist. Try searching for it or looking at the URL to see if it looks correct.</p>\n"
		
	}
	,

	{
		
		"title": "Capability Statement",
		"tags": "fhir",
		"keywords": "foundations fhir",
		"url": "api_foundation_conformance.html",
		"summary": "A capability statement is a set of capabilities of a FHIR Server that may be used as a statement of actual server functionality or a statement of required or desired server implementation.",
		"content": "\n<h2 id=\"0-references\">0. References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> - </div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"http://www.hl7.org/fhir/STU3/capabilitystatement.html\">CapabilityStatement</a></div> </td>\n        <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n</tr>\n</table>\n\n<h2 id=\"1-capabilities\">1. Capabilities</h2>\n\n<p>API to support getting the NRL server capability statement.</p>\n\n<!--Alternatively, an HTTP OPTIONS request against the root of the FHIR server will also return the conformance profile:-->\n\n<!--<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">-\n`OPTIONS [baseUrl]/`\n</div>-->\n\n<h3 id=\"11-capabilities-request-headers\">1.1 Capabilities Request Headers</h3>\n\n<p>The Capabilities Interaction supports the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand. This will be one of <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<!--\n| Header               | Value |Conformance |\n|----------------------|-------|-------|\n| `Accept`      | The `Accept` header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API [Content types](development_general_api_guidance.html#content-types) section. | OPTIONAL |\n| `Authorization`      | The `Authorization` header will carry the base64url encoded JSON web token required for audit on the spine - see [Cross Organisation Audit and Provenance](integration_cross_organisation_audit_and_provenance.html) for details. | REQUIRED |\n| `Ssp-TraceID`        | Client System TraceID (i.e. GUID/UUID). This is a unique ID that the client system should provide. It can be used to identify specific requests when troubleshooting issues with API calls. All calls into the service should have a unique TraceID so they can be uniquely identified later if required. | REQUIRED |\n| `Ssp-From`           | Client System ASID | REQUIRED |\n| `Ssp-To`             | The Spine ASID | REQUIRED |\n| `Ssp-InteractionID`  | `urn:nhs:names:services:nrls:fhir:rest:read:metadata`| REQUIRED |\n| `Ssp-Version`  | `1` | REQUIRED |\n\nNote: The Ssp-Version defaults to 1 if not supplied (this is currently the only version of the API). This indicates the major version of the interaction, so when new major releases of this specification are released (for example releases with breaking changes), implementors will need to specify the correct version in this header.\n-->\n\n<h3 id=\"12-capabilities-interaction-get-the-nrl-capabilitystatement\">1.2 Capabilities Interaction (Get the NRL CapabilityStatement)</h3>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">GET [baseUrl]/metadata</code>\n</div>\n\n<p>The <code class=\"highlighter-rouge\">/metadata</code> path on the root of the NRL FHIR server will return the capability statement for the FHIR server.</p>\n\n<p>For details of this interaction - see <a href=\"https://www.hl7.org/fhir/STU3/http.html#capabilities\">HL7 FHIR STU3 RESTful API</a>.</p>\n\n<!--All requests MUST contain a valid <code class=\"highlighter-rouge\">Authorization</code> header and MAY contain an <code class=\"highlighter-rouge\">Accept</code> header with at least one of the following: <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>.-->\n\n<h3 id=\"13-capabilities-response\">1.3 Capabilities Response</h3>\n\n<p>Success:</p>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">200</code> <strong>OK</strong> HTTP status code on successful retrieval of the capability statement.</li>\n  <li>MUST return a capability statement which conforms to the standard <a href=\"http://hl7.org/fhir/STU3/capabilitystatement.html\">FHIR CapabilityStatement</a>\n</li>\n</ul>\n\n<p>Error Handling:</p>\n\n<p>The NRL Server is expected to always be able to return a valid capability statement.</p>\n\n<h2 id=\"2-example\">2. Example</h2>\n\n<h3 id=\"21-capabilities-request-query\">2.1 Capabilities Request Query</h3>\n\n<p>Retrieve the capability statement from the NRL Server, the format of the response body will be xml.</p>\n\n<h4 id=\"211-curl\">2.1.1. cURL</h4>\n\n<pre class=\"embedcurl\" title=\"Read Server Capability Statement\" width=\"100%\" height=\"200px\">curl -H 'Accept: application/fhir+xml' -H 'Authorization: BEARER [token]' -X GET '[baseUrl]/metadata'</pre>\n<!-- You only need to reference this script once per page. -->\n<script src=\"https://www.embedcurl.com/embedcurl.min.js\" async=\"\"></script>\n\n<h3 id=\"32-response-headers\">2.2 Query Response</h3>\n\n<h4 id=\"32-response-headers\">2.2.1 Http Headers</h4>\n\n<script src=\"https://gist.github.com/swk003/1fb79ea938f6f5f984069819a29c2356.js\"></script>\n\n<h4 id=\"32-response-headers\">2.2.2 Response Body</h4>\n\n<!--### 2.2.2 Response Body ###-->\n\n<p>An example NRL CapabilityStatement of kind <code class=\"highlighter-rouge\">Requirements</code> is shown below:</p>\n\n<script src=\"https://gist.github.com/swk003/2961c7f768ff4ddc44c483fb6ac80833.js\"></script>\n\n<!--<script src=\"https://gist.github.com/IOPS-DEV/873579911893ce480f15393917812587.js\"></script>-->\n\n<h3 id=\"23-c\">2.3 C</h3>\n\n<div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-check-square-o\"></i> <b>Tip:</b> C# code snippets utilise Ewout Kramer’s <a href=\"https://github.com/ewoutkramer/fhir-net-api\">fhir-net-api</a> library which is the official .NET API for HL7® FHIR®.</div>\n\n<div class=\"language-csharp highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kt\">var</span> <span class=\"n\">client</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">FhirClient</span><span class=\"p\">(</span><span class=\"s\">\"http://[fhir_base]/\"</span><span class=\"p\">);</span>\n<span class=\"n\">client</span><span class=\"p\">.</span><span class=\"n\">PreferredFormat</span> <span class=\"p\">=</span> <span class=\"n\">ResourceFormat</span><span class=\"p\">.</span><span class=\"n\">Json</span><span class=\"p\">;</span>\n<span class=\"kt\">var</span> <span class=\"n\">resource</span> <span class=\"p\">=</span> <span class=\"n\">client</span><span class=\"p\">.</span><span class=\"nf\">CapabilityStatement</span><span class=\"p\">();</span>\n<span class=\"n\">FhirSerializer</span><span class=\"p\">.</span><span class=\"nf\">SerializeResourceToXml</span><span class=\"p\">(</span><span class=\"n\">resource</span><span class=\"p\">).</span><span class=\"nf\">Dump</span><span class=\"p\">();</span>\n</code></pre></div></div>\n"
		
	}
	,

	{
		
		"title": "API Create Interaction",
		"tags": "fhirfor_providers",
		"keywords": "structured rest documentreference",
		"url": "api_interaction_create.html",
		"summary": "To support the creation of NRL pointers",
		"content": "\n<h2 id=\"0-references\">References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">DocumentReference</a></div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"https://www.hl7.org/fhir/STU3/documentreference.html\">DocumentReference</a></div> </td>\n          <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n        <!--<td><div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->\n</tr>\n</table>\n\n<h2 id=\"create\">Create</h2>\n\n<p>Provider interaction to support the creation of NRL pointers.</p>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href=\"explore.html#2-prerequisites-for-nrl-api\">Development Guidance</a> page MUST be followed when using this interaction.</p>\n\n<h2 id=\"create-request-headers\">Create Request Headers</h2>\n\n<p>Provider API create requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"create-operation\">Create Operation</h2>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">POST [baseUrl]/DocumentReference</code>\n</div>\n\n<p>Provider systems:</p>\n\n<ul>\n  <li>MUST construct and send a new Pointer (DocumentReference) resource that conforms to the NRL-DocumentReference-1 profile and submit this to NRL using the FHIR RESTful <a href=\"https://www.hl7.org/fhir/http.html#create\">create</a> interaction.</li>\n  <li>MUST include the URI of the NRL-DocumentReference-1 profile StructureDefinition in the DocumentReference.meta.profile element of the DocumentReference resource.</li>\n  <li>MUST include all of the mandatory data-elements contained in the <code class=\"highlighter-rouge\">NRL-DocumentReference-1</code> profile when constructing a DocumentReference. The mandatory data-elements are detailed on the <a href=\"explore_reference.html#2-nrl-data-model-to-fhir-profile-mapping\">Developer FHIR Resource</a> page.</li>\n  <li>MUST supply <code class=\"highlighter-rouge\">subject</code>, <code class=\"highlighter-rouge\">custodian</code> and <code class=\"highlighter-rouge\">author</code> attributes as absolute literal references, the formats of which can be found on the <a href=\"explore_reference.html#6-identifiers\">Developer FHIR Resource</a> page.</li>\n  <li>MUST only create pointers for records where they are the pointer owner (custodian).</li>\n</ul>\n\n<p>For all create requests the <code class=\"highlighter-rouge\">custodian</code> ODS code in the DocumentReference resource MUST be affiliated with the <code class=\"highlighter-rouge\">Client System ASID</code> value in the <code class=\"highlighter-rouge\">fromASID</code> HTTP request header sent to the NRL.</p>\n\n<h3 id=\"xml-example-of-a-new-documentreference-resource-pointer\">XML Example of a New DocumentReference Resource (Pointer)</h3>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference</span> <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"c037a0cb-0c77-4976-83a1-a5d2703e6aa3-23325861873450086113\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n\n<h3 id=\"json-example-of-a-new-documentreference-resource-pointer\">JSON Example of a New DocumentReference Resource (Pointer)</h3>\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"DocumentReference\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"c037a0cb-0c77-4976-83a1-a5d2703e6aa3-23325861873450086113\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"meta\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"profile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"status\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"current\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"736253002\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health crisis plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"class\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"734163000\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Care plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"subject\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"indexed\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"author\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"custodian\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"content\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"attachment\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"contentType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"application/pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"creation\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"format\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:nhs-ic:unstructured\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Unstructured Document\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"extension\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"valueCodeableConcept\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                            </span><span class=\"p\">{</span><span class=\"w\">\n                                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"static\"</span><span class=\"p\">,</span><span class=\"w\">\n                                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Static\"</span><span class=\"w\">\n                            </span><span class=\"p\">}</span><span class=\"w\">\n                        </span><span class=\"p\">]</span><span class=\"w\">\n                    </span><span class=\"p\">}</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"context\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"period\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"start\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"w\">\n        </span><span class=\"p\">},</span><span class=\"w\">\n        </span><span class=\"s2\">\"practiceSetting\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"708168004\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health service\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<h2 id=\"create-response\">Create Response</h2>\n\n<h3 id=\"success\">Success</h3>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">201</code> <strong>CREATED</strong> HTTP status code on successful execution of the interaction and the entry has been successfully created in the NRL.</li>\n  <li>MUST return a response body containing a payload with an <code class=\"highlighter-rouge\">OperationOutcome</code> resource that conforms to the <a href=\"http://hl7.org/fhir/STU3/operationoutcome.html\">‘Operation Outcome’</a> core FHIR resource (see the table below).</li>\n  <li>MUST return an HTTP <code class=\"highlighter-rouge\">Location</code> response header containing the full resolvable URL to the newly created ‘single’ DocumentReference.\n    <ul>\n      <li>The URL will contain the ‘server’ assigned <code class=\"highlighter-rouge\">logical Id</code> of the new DocumentReference resource.</li>\n      <li>The URL format MUST be: <code class=\"highlighter-rouge\">https://[host]/[path]/[id]</code>.</li>\n      <li>An example <code class=\"highlighter-rouge\">Location</code> response header:\n        <ul>\n          <li><code class=\"highlighter-rouge\">https://psis-sync.national.ncrs.nhs.uk/DocumentReference/297c3492-3b78-11e8-b333-6c3be5a609f5-54477876544511209789</code></li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>When a resource has been created it will have a <code class=\"highlighter-rouge\">versionId</code> of 1.</li>\n</ul>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The versionId is an integer that is assigned and maintained by the NRL server. When a new DocumentReference is created the server assigns it a versionId of 1. The versionId will be incremented during an update or supersede transaction. See <a href=\"api_interaction_update.html\">API Interaction - Update</a> and <a href=\"api_interaction_supersede.html\">API Interaction - Supersede</a> for more details on these transactions.<br /><br /> The NRL server will ignore any versionId value sent by a client in a create interaction. Instead, the server will ensure that the newly assigned versionId adheres to the rules laid out above. \n</div>\n\n<p>The table summarises the <code class=\"highlighter-rouge\">create</code> interaction HTTP response code and the values expected to be conveyed in the successful response body <code class=\"highlighter-rouge\">OperationOutcome</code> payload:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Details.Text</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>201</td>\n      <td>information</td>\n      <td>informational</td>\n      <td>RESOURCE_CREATED</td>\n      <td>New resource created</td>\n      <td>Spine message UUID</td>\n      <td>Successfully created resource DocumentReference</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Upon successful creation of a pointer the NRL Service returns in the response payload an OperationOutcome resource with the OperationOutcome.issue.details.text element populated with a Spine internal message UUID. This UUID is used to identify the client’s Create transaction within Spine. A client system SHOULD reference the UUID in any calls raised with the Deployment Issues Resolution Team. The UUID will be used to retrieve log entries that relate to a specific client transaction.</div>\n\n<h3 id=\"failure\">Failure</h3>\n\n<p>The following errors can be triggered when performing this operation:</p>\n\n<ul>\n  <li><a href=\"development_general_api_guidance.html#invalid-request-message\">Invalid Request Message</a></li>\n  <li><a href=\"development_general_api_guidance.html#invalid-resource\">Invalid Resource</a></li>\n  <li><a href=\"development_general_api_guidance.html#organisation-not-found\">Organisation not found</a></li>\n  <li><a href=\"development_general_api_guidance.html#invalid-nhs-number\">Invalid NHS Number</a></li>\n  <li><a href=\"development_general_api_guidance.html#parameters\">Invalid Parameter</a></li>\n  <li><a href=\"development_general_api_guidance.html#duplicate-resource\">Duplicate Resource</a></li>\n  <li><a href=\"development_general_api_guidance.html#headers\">Missing or Invalid Headers</a></li>\n</ul>\n\n<h3 id=\"ensuring-that-masteridentifier-is-unique\">Ensuring that <code class=\"highlighter-rouge\">masterIdentifier</code> Is Unique</h3>\n\n<p>The masterIdentifier should be unique within the NRL. For more information see the discussion on <a href=\"pointer_identity.html\">Pointer identifiers</a>. The masterIdentifer is a <a href=\"https://www.hl7.org/fhir/datatypes.html#Identifier\">FHIR identifier</a> and for NRL the system and value properties are mandatory.</p>\n\n<p>The system defines how the value is made unique. As the FHIR specification says this might be a recognised standard that describes how this uniqueness is generated.</p>\n\n<p>The NRL recommends the use of either an OID or a UUID as an Identifier in keeping with the need for the masterIdentifier value to be unique. In this case then the system MUST be “urn:ietf:rfc:3986” (see the <a href=\"https://www.hl7.org/fhir/identifier-registry.html\">FHIR identifier registry</a> for details) and the value is of the form –</p>\n\n<p>•\tOID -  urn:oid:[oidValue] <br />\n•\tUUID - urn:uuid:[uuidValue]</p>\n\n<p>See the <a href=\"https://www.hl7.org/fhir/datatypes-examples.html#Identifier\">example</a> OID and UUID based Identifiers from the FHIR specification.</p>\n\n<h2 id=\"code-examples\">Code Examples</h2>\n\n<h3 id=\"post-a-pointer-with-c\">POST a Pointer with C</h3>\n\n<p>The following code samples are taken from the NRL Demonstrator application which has both Consumer and Provider client implementations built in. More information about the design solution can be found\non the <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/wiki\">NRL Demonstrator Wiki</a></p>\n\n<p>First we generate a base pointer request model that includes the custodian and author details, and the specific care plan attachment details that are later used to build our pointer (DocumentReference). \nThese pointer values are taken from the demo crisis plan that is created for the Demonstrator Provider system.</p>\n\n<p>Then we call our DocumentReference service GenerateAndCreatePointer method which will generate our pointer (DocumentReference) using the values stored in the model, build a POST command request and then start the call to the NRL API.</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L125-L128\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"kt\">var</span> <span class=\"n\">pointerRequest</span> <span class=\"p\">=</span> <span class=\"n\">NrlsPointerRequest</span><span class=\"p\">.</span><span class=\"nf\">Create</span><span class=\"p\">(</span><span class=\"n\">crisisPlan</span><span class=\"p\">.</span><span class=\"n\">OrgCode</span><span class=\"p\">,</span> <span class=\"n\">crisisPlan</span><span class=\"p\">.</span><span class=\"n\">OrgCode</span><span class=\"p\">,</span> <span class=\"n\">crisisPlan</span><span class=\"p\">.</span><span class=\"n\">PatientNhsNumber</span><span class=\"p\">,</span> <span class=\"s\">$\"https://spine-proxy.national.ncrs.nhs.uk/</span><span class=\"p\">{</span><span class=\"n\">newCrisisPlan</span><span class=\"p\">.</span><span class=\"n\">Id</span><span class=\"p\">}</span><span class=\"s\">/mental-health-care-plan.pdf\"</span><span class=\"p\">,</span> <span class=\"s\">\"application/pdf\"</span><span class=\"p\">,</span> <span class=\"n\">MentalHealthCrisisPlanTypeCode</span><span class=\"p\">,</span> <span class=\"n\">MentalHealthCrisisPlanTypeDisplay</span><span class=\"p\">,</span> <span class=\"n\">crisisPlan</span><span class=\"p\">.</span><span class=\"n\">Asid</span><span class=\"p\">);</span>\n\n<span class=\"c1\">//Create new NRLS pointer</span>\n<span class=\"kt\">var</span> <span class=\"n\">newPointer</span> <span class=\"p\">=</span> <span class=\"k\">await</span> <span class=\"n\">_documentReferenceServices</span><span class=\"p\">.</span><span class=\"nf\">GenerateAndCreatePointer</span><span class=\"p\">(</span><span class=\"n\">pointerRequest</span><span class=\"p\">);</span></code></pre></figure>\n\n</div>\n\n<p><br />\nWithin the DocumentReference service GenerateAndCreatePointer method we generate our pointer model and then serialise this generated model ready for posting:</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L53-L54\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"p\">{</span>\n    <span class=\"kt\">var</span> <span class=\"n\">pointerJson</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">FhirJsonSerializer</span><span class=\"p\">().</span><span class=\"nf\">SerializeToString</span><span class=\"p\">(</span><span class=\"n\">pointer</span><span class=\"p\">);</span></code></pre></figure>\n\n</div>\n\n<p><br />\n<b>Calling the NRL</b><br />\nUsing our POST command request model we create a connection to the NRL using HttpClient.</p>\n\n<p>You can view the common connection code example <a href=\"connectioncode_example.html\">here</a>.</p>\n\n<p><b>Explore the NRL</b><br />\nYou can explore and test the NRL POST command using Swagger in the <a href=\"https://data.developer.nhs.uk/nrls-ri/index.html#/Nrls/createPointer\">NRL API Reference Implementation</a>.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The code in these examples is standard C# v7.2 taken directly from the <a href=\"https://nrls.digital.nhs.uk\">NRL Demonstrator</a> code.<br /><br />The official <b><a href=\"https://ewoutkramer.github.io/fhir-net-api/\">.NET FHIR Library</a></b> is utilised to construct, test, parse, and serialize FHIR models with ease.</div>\n\n"
		
	}
	,

	{
		
		"title": "API Delete Interaction",
		"tags": "fhirfor_providers",
		"keywords": "structured rest documentreference",
		"url": "api_interaction_delete.html",
		"summary": "To support the deletion of NRL pointers.",
		"content": "\n<h2 id=\"0-references\">References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">DocumentReference</a></div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"https://www.hl7.org/fhir/STU3/documentreference.html\">DocumentReference</a></div> </td>\n          <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n        <!--<td><div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->\n</tr>\n</table>\n\n<h2 id=\"delete\">Delete</h2>\n\n<p>Provider interaction to support the deletion of NRL pointers.</p>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href=\"explore.html#2-prerequisites-for-nrl-api\">Development Guidance</a> page MUST be followed when using this interaction.</p>\n\n<h2 id=\"delete-request-headers\">Delete Request Headers</h2>\n\n<p>Provider API delete requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"delete-operation\">Delete Operation</h2>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> All query parameters must be percent encoded. In particular, the pipe (<code class=\"highlighter-rouge\">|</code>) character must be percent encoded (<code class=\"highlighter-rouge\">%7C</code>).</div>\n\n<p>Provider systems MUST only delete pointers for records where they are the pointer owner (custodian).</p>\n\n<p>For all delete requests the <code class=\"highlighter-rouge\">custodian</code> ODS code in the DocumentReference to be deleted MUST be affiliated with the Client System <code class=\"highlighter-rouge\">ASID</code> value in the <code class=\"highlighter-rouge\">fromASID</code> HTTP request header sent to the NRL.</p>\n\n<h3 id=\"delete-by-id\">Delete by <code class=\"highlighter-rouge\">id</code></h3>\n\n<p>The API supports the delete by ID interaction which allows a provider to delete an existing pointer based on the logical ID of the pointer.</p>\n\n<p>The logical id can be obtained from the Location header which is contained in the create response - see the <a href=\"api_interaction_create.html#create-response\">Create API Interaction</a> for details.</p>\n\n<p>To accomplish this, the provider issues an HTTP DELETE as shown:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">DELETE [baseUrl]/DocumentReference/[id]</code>\n</div>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">DELETE [baseUrl]/DocumentReference/da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142\n</span></code>\nDelete the DocumentReference resource for a pointer with a logical id of 'da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142'.</pre>\n</div>\n\n<h3 id=\"conditional-delete-by-id\">Conditional Delete by <code class=\"highlighter-rouge\">id</code></h3>\n\n<p>The API supports the conditional delete by <code class=\"highlighter-rouge\">id</code> interaction which allows a provider to delete an existing pointer based on the search parameter <code class=\"highlighter-rouge\">_id</code> which refers to the logical id of the pointer.</p>\n\n<p>The logical id can be obtained from the Location header which is contained in the create response - see the <a href=\"api_interaction_create.html#create-response\">Create API Interaction</a> for details.</p>\n\n<p>To accomplish this, the provider issues an HTTP DELETE as shown:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">DELETE [baseUrl]/DocumentReference?_id=[id]</code>\n</div>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\">\n<code><span class=\"err\">DELETE [baseUrl]/DocumentReference?_id=da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142\n</span></code>\nDelete the DocumentReference resource for a pointer conditionally with a logical id of 'da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142'.</pre>\n</div>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> Conditional delete by logical ID may be deprecated in the future, therefore it is recommended to implement <a href=\"#delete-by-id\">delete by ID</a> as a path variable.</div>\n\n<h3 id=\"conditional-delete-by-masteridentifier\">Conditional Delete by <code class=\"highlighter-rouge\">masterIdentifier</code>‘*`</h3>\n\n<p>The API supports the conditional delete by <code class=\"highlighter-rouge\">masterIdentifier</code> interaction which allows a provider to delete an existing pointer using the masterIdentifier\nso they do not have to persist or query for the NRL generated logical id for the Pointer.</p>\n\n<p>To accomplish this, the provider issues an HTTP DELETE as shown:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">DELETE [baseUrl]/DocumentReference?subject=[https://demographics.spineservices.nhs.uk/STU3/Patient/[nhsNumber]&amp;identifier=[system]%7C[value]</code>\n</div>\n\n<p><em>[nhsNumber]</em> - The NHS number of the patient whose <code class=\"highlighter-rouge\">DocumentReference</code>s the client is requesting</p>\n\n<p><em>[system]</em> - The namespace of the masterIdentifier value that is associated with the DocumentReference(s)</p>\n\n<p><em>[value]</em> - The value of the masterIdentifier that is associated with the DocumentReference(s)</p>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\">\n<code><span class=\"err\">DELETE [baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210&amp;identifier=urn:ietf:rfc:3986%7Curn:oid:1.3.6.1.4.1.21367.2005.3.71\n</span></code>\nDelete the DocumentReference resource for a pointer with a subject and identifier.</pre>\n</div>\n\n<h2 id=\"delete-response\">Delete Response</h2>\n\n<p>The 'delete' interaction removes an existing resource. The interaction is performed by an HTTP DELETE of the <code class=\"highlighter-rouge\">DocumentReference</code> resource.</p>\n\n<p>Success:</p>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">200</code> <strong>OK</strong> HTTP status code on successful execution of the interaction.</li>\n  <li>MUST return a response body containing a payload with an <code class=\"highlighter-rouge\">OperationOutcome</code> resource that conforms to the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\">‘Spine-OperationOutcome-1’</a> FHIR profile.</li>\n</ul>\n\n<p>The table summarises the successful <code class=\"highlighter-rouge\">delete</code> interaction scenario and includes HTTP response code and the values expected to be conveyed in the response body <code class=\"highlighter-rouge\">OperationOutcome</code> payload:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Details.Text</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>200</td>\n      <td>information</td>\n      <td>informational</td>\n      <td>RESOURCE_DELETED</td>\n      <td>Resource removed</td>\n      <td>Spine message UUID</td>\n      <td>Successfully removed resource DocumentReference: [url]</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Upon successful deletion of a pointer the NRL Service returns in the response payload an OperationOutcome resource with the OperationOutcome.issue.details.text element populated with a Spine internal message UUID. This UUID is used to identify the client’s Delete transaction within Spine. A client system SHOULD reference the UUID in any calls raised with the Deployment Issues Resolution Team. The UUID will be used to retrieve log entries that relate to a specific client transaction.</div>\n\n<p>Failure:</p>\n\n<p>The following errors can be triggered when performing this operation:</p>\n\n<ul>\n  <li><a href=\"development_general_api_guidance.html#resource-not-found\">No record found</a></li>\n  <li><a href=\"development_general_api_guidance.html#invalid-resource\">Invalid Resource</a></li>\n</ul>\n\n<h2 id=\"code-examples\">Code Examples</h2>\n\n<h3 id=\"delete-a-pointer-with-c\">DELETE a Pointer with C</h3>\n\n<p>The following code samples are taken from the NRL Demonstrator application which has both Consumer and Provider client implementations built in. More information about the design solution can be found\non the <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/wiki\">NRL Demonstrator Wiki</a></p>\n\n<p>First we generate a base pointer request model that includes the pointer logical id used for the _id parameter.\nThe logical id is obtained from a mapping stored within the Demonstrator that maps the Provider system crisis plans to NRL pointers.</p>\n\n<p>Then we call our DocumentReference service DeletePointer method which will build a DELETE command request and then start the call to the NRL API.</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L158-L160\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L158-L160 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L158-L160\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Epr/CrisisPlanService.cs#L158-L160\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"kt\">var</span> <span class=\"n\">pointerRequest</span> <span class=\"p\">=</span> <span class=\"n\">NrlsPointerRequest</span><span class=\"p\">.</span><span class=\"nf\">Delete</span><span class=\"p\">(</span><span class=\"n\">pointerMap</span><span class=\"p\">.</span><span class=\"n\">NrlsPointerId</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Asid</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">OrgCode</span><span class=\"p\">);</span>\n\n<span class=\"kt\">var</span> <span class=\"n\">outcome</span> <span class=\"p\">=</span> <span class=\"k\">await</span> <span class=\"n\">_documentReferenceServices</span><span class=\"p\">.</span><span class=\"nf\">DeletePointer</span><span class=\"p\">(</span><span class=\"n\">pointerRequest</span><span class=\"p\">);</span></code></pre></figure>\n\n</div>\n<p><br />\n<b>Calling the NRL</b><br />\nUsing our DELETE command request model we create a connection to the NRL using HttpClient.</p>\n\n<p>You can view the common connection code example <a href=\"connectioncode_example.html\">here</a>.</p>\n\n<p><b>Explore the NRL</b><br />\nYou can explore and test the NRL DELETE command using Swagger in the <a href=\"https://data.developer.nhs.uk/nrls-ri/index.html#/Nrls/deletePointer\">NRL API Reference Implementation</a>.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The code in these examples is standard C# v7.2 taken directly from the <a href=\"https://nrls.digital.nhs.uk\">NRL Demonstrator</a> code.<br /><br />The official <b><a href=\"https://ewoutkramer.github.io/fhir-net-api/\">.NET FHIR Library</a></b> is utilised to construct, test, parse, and serialize FHIR models with ease.</div>\n\n"
		
	}
	,

	{
		
		"title": "API Read Interaction",
		"tags": "fhirpointersfor_consumers",
		"keywords": "structured rest documentreference",
		"url": "api_interaction_read.html",
		"summary": "To support retrieval of an NRL pointer",
		"content": "\n<h2 id=\"0-references\">References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">DocumentReference</a></div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"https://www.hl7.org/fhir/STU3/documentreference.html\">DocumentReference</a></div> </td>\n          <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n        <!--<td><div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->\n</tr>\n</table>\n\n<h2 id=\"read\">Read</h2>\n\n<p>Consumer interaction to support the retrieval of a single NRL pointer.</p>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href=\"explore.html#2-prerequisites-for-nrl-api\">Development Guidance</a> page MUST be followed when using this interaction.</p>\n\n<h2 id=\"read-request-headers\">Read Request Headers</h2>\n\n<p>Consumer and Provider API read requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"read-operation\">Read Operation</h2>\n\n<p>The read interaction allows a consumer or provider to retrieve a single pointer (DocumentReference) by logical ID. The consumer or provider must issue an HTTP GET as shown:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">GET [baseUrl]/DocumentReference/[id]</code>\n</div>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\">\n<code><span class=\"err\">GET [baseUrl]/DocumentReference/da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142\n</span></code>\nRead the DocumentReference resource for a pointer with the logical id of 'da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142'.</pre>\n</div>\n\n<p>Note the status of the pointer must be “current” for the pointer to be retrieved.</p>\n\n<h2 id=\"read-response\">Read Response</h2>\n\n<p>Success:</p>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">200</code> <strong>SUCCESS</strong> HTTP status code on successful execution of the interaction.</li>\n  <li>MUST return a response body containing a DocumentReference resource which conforms to the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1 FHIR profile</a> and has the status “current”.</li>\n</ul>\n\n<!--\n<div markdown=\"span\" class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> When a document/record is to be retrieved via the SSP then the Consumer MUST percent encode the `content.attachment.url` property, taken from an NRL pointer, and prefix it with the SSP server URL. For more details, see the [Retrieval Read](retrieval_interaction_read.html#retrieval-via-the-ssp) interaction page.</div>\n\n-->\n\n<p>Example Successful Response:</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;relatesTo&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;target&gt;</span>\n            <span class=\"nt\">&lt;identifier&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/identifier&gt;</span>\n        <span class=\"nt\">&lt;/target&gt;</span>\n    <span class=\"nt\">&lt;/relatesTo&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n\n<p>Failure:</p>\n\n<p>The following errors can be triggered when performing this operation:</p>\n\n<ul>\n  <li><a href=\"development_general_api_guidance.html#invalid-request-message\">Invalid Request Message</a></li>\n  <li><a href=\"development_general_api_guidance.html#parameters\">Invalid Parameter</a></li>\n  <li><a href=\"development_general_api_guidance.html#resource-not-found\">Resource Not Found</a></li>\n  <li><a href=\"development_general_api_guidance.html#inactive-documentreference\">Inactive Document Reference</a></li>\n</ul>\n\n<h2 id=\"example-scenario\">Example Scenario</h2>\n\n<p>An authorised NRL Consumer retrieves a pointer to patient’s relevant health record using the NRL to discover potentially vital information to support a patient’s emergency crisis care.</p>\n\n<h3 id=\"request-query\">Request Query</h3>\n\n<p>Return DocumentReference resource (pointer) with logical ID 0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261. The format of the response body will be XML.</p>\n\n<h4 id=\"curl\">cURL</h4>\n\n<pre class=\"embedcurl\" title=\"Read DocumentReference\" width=\"100%\" height=\"200px\">curl -H 'Accept: application/fhir+xml' -H 'Authorization: BEARER [token]' -X GET  '[baseUrl]/DocumentReference/0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261'</pre>\n<!-- You only need to reference this script once per page. -->\n<script src=\"https://www.embedcurl.com/embedcurl.min.js\" async=\"\"></script>\n\n<h4 id=\"query-response-http-headers\">Query Response Http Headers</h4>\n\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>HTTP/1.1 200 OK\nServer: nginx/1.10.0 (Ubuntu)\nDate: Mon, 19 Jun 2017 08:36:12 GMT\nContent-Type: application/fhir+xml;charset=utf-8\nLast-Modified: Mon, 19 Jun 2017 08:36:12 GMT\n</code></pre></div></div>\n\n<h4 id=\"query-response\">Query Response</h4>\n\n<h5 id=\"pointer-documentreference-returned\"><strong>Pointer (DocumentReference) Returned:</strong></h5>\n\n<ul>\n  <li>HTTP 200-Request was successfully executed</li>\n  <li>DocumentReference that conforms to the <code class=\"highlighter-rouge\">NRL-DocumentReference-1</code> profile.</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;relatesTo&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;target&gt;</span>\n            <span class=\"nt\">&lt;identifier&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/identifier&gt;</span>\n        <span class=\"nt\">&lt;/target&gt;</span>\n    <span class=\"nt\">&lt;/relatesTo&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n\n<h5 id=\"no-record-pointer-matched\"><strong>No Record (Pointer) Matched:</strong></h5>\n\n<ul>\n  <li>HTTP 404-Not Found. No record found.</li>\n  <li>OperationOutcome resource that conforms to the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\">‘Spine-OperationOutcome-1’</a> profile</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;OperationOutcome</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"5a4171ac-486e-11e8-9ffc-6c3be5a609f5-34326129638901216693\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;issue&gt;</span>\n        <span class=\"nt\">&lt;severity</span> <span class=\"na\">value=</span><span class=\"s\">\"warning\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"not-found\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;details&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/Spine-ErrorOrWarningCode-1\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"NO_RECORD_FOUND\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"No record found\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/details&gt;</span>\n        <span class=\"nt\">&lt;diagnostics</span> <span class=\"na\">value=</span><span class=\"s\">\"DocumentReference not found\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/issue&gt;</span>\n<span class=\"nt\">&lt;/OperationOutcome&gt;</span></code></pre></figure>\n\n</div>\n\n<h5 id=\"error-response-operationoutcome-returned\"><strong>Error Response (OperationOutcome) Returned:</strong></h5>\n\n<ul>\n  <li>HTTP 400-Bad Request.</li>\n  <li>OperationOutcome resource that conforms to the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\">‘Spine-OperationOutcome-1’</a> profile if the resource cannot be returned</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;OperationOutcome</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"5a4171ac-486e-11e8-9ffc-6c3be5a609f5-34326129638901216693\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;issue&gt;</span>\n        <span class=\"nt\">&lt;severity</span> <span class=\"na\">value=</span><span class=\"s\">\"warning\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"invalid\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;details&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/Spine-ErrorOrWarningCode-1\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"BAD_REQUEST\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Bad Request\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/details&gt;</span>\n        <span class=\"nt\">&lt;diagnostics</span> <span class=\"na\">value=</span><span class=\"s\">\"DocumentReference status is not 'current'\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/issue&gt;</span>\n<span class=\"nt\">&lt;/OperationOutcome&gt;</span></code></pre></figure>\n\n</div>\n\n<p>See the <a href=\"development_general_api_guidance.html#error-handling\">general API guidance</a> for all HTTP Error response codes supported by the NRL.</p>\n"
		
	}
	,

	{
		
		"title": "API Search Interaction",
		"tags": "fhirpointersfor_consumers",
		"keywords": "structured rest documentreference",
		"url": "api_interaction_search.html",
		"summary": "To support parameterised search of the NRL.",
		"content": "\n<h2 id=\"0-references\">References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">DocumentReference</a></div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"https://www.hl7.org/fhir/STU3/documentreference.html\">DocumentReference</a></div> </td>\n          <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n        <!--<td><div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->\n</tr>\n</table>\n\n<h2 id=\"search\">Search</h2>\n\n<p>Consumer interaction to support parameterised search of the NRL.</p>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href=\"explore.html#2-prerequisites-for-nrl-api\">Development Guidance</a> page MUST be followed when using this interaction.</p>\n\n<h2 id=\"search-request-headers\">Search Request Headers</h2>\n\n<p>Consumer and Provider API search requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"search-documentreference\">Search DocumentReference</h2>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">GET [baseUrl]/DocumentReference?[searchParameters]</code>\n</div>\n\n<p>Though the NRL does not keep a version history of each DocumentReference, each one does hold a versionId.</p>\n\n<!--Though the NRL does not keep a version history of each DocumentReference, each one does hold a versionId to support the NRL update strategy. -->\n\n<h2 id=\"search-parameters\">Search Parameters</h2>\n\n<p>\nThis implementation guide outlines the search parameters for the DocumentReference resource in the table below. \n\n<!--To be conformant, consumer systems are required to implement all of the MUST parameters.\nSystems may implement the full list of search parameters for the DocumentReference resource (<a href=\"https://www.hl7.org/fhir/STU3/documentreference.html#search\">HL7 FHIR STU3 DocumentReference</a>).-->\n</p>\n<!--\n<div markdown=\"span\" class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Details on the Search Parameters selection and feedback process can be found here [Search Parameters](profiles_search_parameters.html)</div>\n<br>\n-->\n\n<table style=\"min-width:100%;width:100%\">\n<tr id=\"clinical\">\n    <th style=\"width:15%;\">Name</th>\n    <th style=\"width:15%;\">Type</th>\n    <th style=\"width:30%;\">Description</th>\n    <th style=\"width:5%;\">Conformance</th>\n    <th style=\"width:35%;\">Path</th>\n</tr>\n<!--\n<tr>\n    <td><code class=\"highlighter-rouge\">patient</code></td>\n    <td><code class=\"highlighter-rouge\">reference</code></td>\n    <td>Who/what is the subject of the document</td>\n    <td>RECOMMENDED</td>\n    <td>DocumentReference.subject<br>(Patient)</td>\n</tr>\n\n<tr>\n    <td><code class=\"highlighter-rouge\">period</code></td>\n    <td><code class=\"highlighter-rouge\">date</code></td>\n    <td>Time of service that is being documented</td>\n    <td>RECOMMENDED</td>\n    <td>DocumentReference.context.period</td>\n</tr>\n<tr>\n    <td><code class=\"highlighter-rouge\">type</code></td>\n    <td><code class=\"highlighter-rouge\">token</code></td>\n    <td>Kind of document (SNOMED CT if possible)</td>\n    <td>RECOMMENDED</td>\n    <td>DocumentReference.type</td>\n</tr> \n-->\n<tr>\n    <td><code class=\"highlighter-rouge\">_id</code></td>\n    <td><code class=\"highlighter-rouge\">token</code></td>\n    <td>The logical id of the resource</td>\n    <td>RECOMMENDED</td>\n    <td>DocumentReference.id</td>\n</tr>\n<tr>\n    <td><code class=\"highlighter-rouge\">custodian</code></td>\n    <td><code class=\"highlighter-rouge\">reference</code></td>\n    <td>Organisation which maintains the document reference</td>\n    <td>OPTIONAL</td>\n    <td>DocumentReference.custodian<br />(Organisation ODS Code)</td>\n</tr>\n<tr>\n    <td><code class=\"highlighter-rouge\">subject</code></td>\n    <td><code class=\"highlighter-rouge\">reference</code></td>\n    <td>Who/what is the subject of the document</td>\n    <td>RECOMMENDED</td>\n    <td>DocumentReference.subject<br />(Patient NHS Number)</td>\n</tr>\n<tr>\n    <td><code class=\"highlighter-rouge\">type</code></td>\n    <td><code class=\"highlighter-rouge\">token</code></td>\n    <td>Kind of document (SNOMED CT)</td>\n    <td>OPTIONAL</td>\n    <td>DocumentReference.type</td>\n</tr> \n<tr>\n    <td><code class=\"highlighter-rouge\">_summary</code></td>\n    <td><code class=\"highlighter-rouge\">Summary</code></td>\n    <td>Total number of matching results</td>\n    <td>OPTIONAL</td>\n    <td>N/A</td>\n</tr>\n</table>\n\n<p>When the <code class=\"highlighter-rouge\">_id</code> search parameter is used by a client it MUST only be used as a single search parameter and MUST not be used in conjunction with any other search parameter to form part of a combination search query with the exception of ‘_format’ parameter.</p>\n\n<p>When the <code class=\"highlighter-rouge\">subject</code> parameter is used by a client it MAY be used in conjunction with the <code class=\"highlighter-rouge\">custodian</code> and <code class=\"highlighter-rouge\">type</code> search parameters to form a combination search query. The <code class=\"highlighter-rouge\">custodian</code> and <code class=\"highlighter-rouge\">type</code> search parameters MUST only be used to form combination search queries.</p>\n\n<div class=\"alert alert-info\" role=\"alert\">\n    <i class=\"fa fa-info-circle\"></i> <b>Note:</b> The format of the parameters must be of the form:<br />\n\t<br />\n\t<b>Subject:</b> <code class=\"highlighter-rouge\">https://demographics.spineservices.nhs.uk/STU3/Patient/[NHS Number]</code>.<br />\n\t<b>Custodian:</b> <code class=\"highlighter-rouge\">https://directory.spineservices.nhs.uk/STU3/Organization/[ODS Code]</code>.<br />\n\t<b>Type:</b> <code class=\"highlighter-rouge\">http://snomed.info/sct|[code]</code>.\n\t\n</div>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Please make sure that all query parameters are percent encoded. In particular the pipe (|) character must be percent encoded (%7C).</div>\n\n<h4 id=\"_id\"> _id</h4>\n\n<p>The search parameter <code class=\"highlighter-rouge\">_id</code> refers to the logical id of the DocumentReference resource and can be used when the search context specifies the DocumentReference resource type.</p>\n\n<p>Functionally this search is the equivalent to a simple pointer read operation.</p>\n\n<p>See <a href=\"https://www.hl7.org/fhir/stu3/search.html#id\">_id</a> for details on this parameter. The _id parameter can be used as follows:</p>\n\n<!--\n<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?patient=[id]</div>\n\n\n<p>This MUST be supported for all endpoint provider systems.</p>\n\n<p> <code class=\"highlighter-rouge\">id</code> is the logical id of the patient on the server which can be obtained by a <a href=\"api_entity_patient.html\">Patient </a> resource query.</p>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient=42\n</span></code>\nReturn all DocumentReference resources for Patients with a logical id of 42</pre>\n</div>\n\n-->\n<div class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?_id=[id]</div>\n\n<p>When the <code class=\"highlighter-rouge\">_id</code> search parameter is used by a client, this search parameter MUST only be used as a single search parameter and MUST not be used in conjunction with any other parameter to form part of a combination search query with the exception of ‘_format’ parameter.</p>\n\n<!--<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject.identifier=[system]|[code]</div>-->\n\n<!--\n<p>This MUST be supported for all consumer systems.</p>\n\n<p>This SHOULD be supported by <a href=\"https://en.wikipedia.org/wiki/Middleware\">middleware</a> systems (e.g. <a href=\"https://en.wikipedia.org/wiki/Enterprise_application_integration\">enterprise application integration (EAI)</a> and the <a href=\"https://en.wikipedia.org/wiki/Enterprise_service_bus\">enterprise service bus (ESB)</a>) and MAY be supported for endpoint provider systems.</p> \n-->\n\n<!--\n<p><code class=\"highlighter-rouge\">system</code> is a uniform resource identifier which defines which CodeSystem the identifer belongs to. For NHS Number this would be <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/nhs-number</code> and <code class=\"highlighter-rouge\">code</code> would be the NHS Number.</p>\n-->\n<!--\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?_id=da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142\n</span></code>\nReturn the DocumentReference resource for a pointer with a logical identifier of da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142</pre>\n</div>\n\n\n<div markdown=\"span\" class=\"alert alert-info\" role=\"alert\">\n    <i class=\"fa fa-info-circle\"></i> <b>Note:</b> The format of the logical identifier is: [TBC].\n</div>\n-->\n<!--\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject.identifier=https://fhir.nhs.uk/Id/nhs-number|9876543210\n</span></code>\nReturn all DocumentReference resources for subjects (Patients) with a NHS Number of 9876543210</pre>\n</div>\n-->\n\n<!--\n<p> Suppliers and organisations MAY create their own `systemUri`s for local patient identifiers, e.g. the fictional Jorvik NHS Trust could use <code class=\"highlighter-rouge\">http://fhir.jorvik.nhs.uk/Patient</code> to identify a number as the trusts hospital number.</p>\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient.identifier=https://fhir.jorvik.nhs.uk/Patient|12345678\n</span></code>\nReturn all DocumentReference resources for Patients with Jorvik Trust Hospital Number of 12345678</pre>\n</div>\n-->\n\n<h4 id=\"subject\"> subject</h4>\n\n<p>See <a href=\"https://www.hl7.org/fhir/STU3/search.html#reference\">reference</a> for details on this parameter. The subject parameter can be used as follows:</p>\n\n<!--\n<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?patient=[id]</div>\n\n\n<p>This MUST be supported for all endpoint provider systems.</p>\n\n<p> <code class=\"highlighter-rouge\">id</code> is the logical id of the patient on the server which can be obtained by a <a href=\"api_entity_patient.html\">Patient </a> resource query.</p>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient=42\n</span></code>\nReturn all DocumentReference resources for Patients with a logical id of 42</pre>\n</div>\n\n-->\n<div class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject=[reference]</div>\n\n<!--<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject.identifier=[system]|[code]</div>-->\n\n<!--\n<p>This MUST be supported for all consumer systems.</p>\n\n<p>This SHOULD be supported by <a href=\"https://en.wikipedia.org/wiki/Middleware\">middleware</a> systems (e.g. <a href=\"https://en.wikipedia.org/wiki/Enterprise_application_integration\">enterprise application integration (EAI)</a> and the <a href=\"https://en.wikipedia.org/wiki/Enterprise_service_bus\">enterprise service bus (ESB)</a>) and MAY be supported for endpoint provider systems.</p> \n-->\n\n<!--\n<p><code class=\"highlighter-rouge\">system</code> is a uniform resource identifier which defines which CodeSystem the identifer belongs to. For NHS Number this would be <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/nhs-number</code> and <code class=\"highlighter-rouge\">code</code> would be the NHS Number.</p>\n-->\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\n</span></code>\nReturn all DocumentReference resources for a patient with a NHS Number of 9876543210</pre>\n</div>\n\n<!--\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject.identifier=https://fhir.nhs.uk/Id/nhs-number|9876543210\n</span></code>\nReturn all DocumentReference resources for subjects (Patients) with a NHS Number of 9876543210</pre>\n</div>\n-->\n\n<!--\n<p> Suppliers and organisations MAY create their own `systemUri`s for local patient identifiers, e.g. the fictional Jorvik NHS Trust could use <code class=\"highlighter-rouge\">http://fhir.jorvik.nhs.uk/Patient</code> to identify a number as the trusts hospital number.</p>\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient.identifier=https://fhir.jorvik.nhs.uk/Patient|12345678\n</span></code>\nReturn all DocumentReference resources for Patients with Jorvik Trust Hospital Number of 12345678</pre>\n</div>\n-->\n\n<h4 id=\"subject and custodian\"> subject and custodian</h4>\n\n<!--<p>See <a href=\"https://www.hl7.org/fhir/STU3/search.html#reference\">reference</a> for details on this parameter. The patient parameter can be used as follows:</p>-->\n\n<!--\n<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?patient=[id]</div>\n\n\n<p>This MUST be supported for all endpoint provider systems.</p>\n\n<p> <code class=\"highlighter-rouge\">id</code> is the logical id of the patient on the server which can be obtained by a <a href=\"api_entity_patient.html\">Patient </a> resource query.</p>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient=42\n</span></code>\nReturn all DocumentReference resources for Patients with a logical id of 42</pre>\n</div>\n\n-->\n<div class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject=[reference]&amp;custodian=[reference]<br />\n</div>\n\n<!--<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject.identifier=[system]|[code]</div>-->\n\n<!--\n<p>This MUST be supported for all consumer systems.</p>\n\n<p>This SHOULD be supported by <a href=\"https://en.wikipedia.org/wiki/Middleware\">middleware</a> systems (e.g. <a href=\"https://en.wikipedia.org/wiki/Enterprise_application_integration\">enterprise application integration (EAI)</a> and the <a href=\"https://en.wikipedia.org/wiki/Enterprise_service_bus\">enterprise service bus (ESB)</a>) and MAY be supported for endpoint provider systems.</p> \n-->\n\n<!--\n<p><code class=\"highlighter-rouge\">system</code> is a uniform resource identifier which defines which CodeSystem the identifer belongs to. For NHS Number this would be <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/nhs-number</code> and <code class=\"highlighter-rouge\">code</code> would be the NHS Number.</p>\n-->\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210&amp;custodian=https://directory.spineservices.nhs.uk/STU3/Organization/RR8\n</span></code>\nReturn all DocumentReference resources for a patient with a NHS Number of 9876543210 and a pointer provider ODS code of RR8.</pre>\n</div>\n\n<!--\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject.identifier=https://fhir.nhs.uk/Id/nhs-number|9876543210\n</span></code>\nReturn all DocumentReference resources for subjects (Patients) with a NHS Number of 9876543210</pre>\n</div>\n-->\n\n<!--\n<p> Suppliers and organisations MAY create their own `systemUri`s for local patient identifiers, e.g. the fictional Jorvik NHS Trust could use <code class=\"highlighter-rouge\">http://fhir.jorvik.nhs.uk/Patient</code> to identify a number as the trusts hospital number.</p>\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient.identifier=https://fhir.jorvik.nhs.uk/Patient|12345678\n</span></code>\nReturn all DocumentReference resources for Patients with Jorvik Trust Hospital Number of 12345678</pre>\n</div>\n-->\n\n<h4 id=\"subject and type\"> subject and type</h4>\n\n<!--<p>See <a href=\"https://www.hl7.org/fhir/STU3/search.html#reference\">reference</a> for details on this parameter. The patient parameter can be used as follows:</p>-->\n\n<!--\n<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?patient=[id]</div>\n\n\n<p>This MUST be supported for all endpoint provider systems.</p>\n\n<p> <code class=\"highlighter-rouge\">id</code> is the logical id of the patient on the server which can be obtained by a <a href=\"api_entity_patient.html\">Patient </a> resource query.</p>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient=42\n</span></code>\nReturn all DocumentReference resources for Patients with a logical id of 42</pre>\n</div>\n\n-->\n<div class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject=[reference]&amp;type.coding=http://snomed.info/sct%7C[code]<br />\n</div>\n\n<!--<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject.identifier=[system]|[code]</div>-->\n\n<!--\n<p>This MUST be supported for all consumer systems.</p>\n\n<p>This SHOULD be supported by <a href=\"https://en.wikipedia.org/wiki/Middleware\">middleware</a> systems (e.g. <a href=\"https://en.wikipedia.org/wiki/Enterprise_application_integration\">enterprise application integration (EAI)</a> and the <a href=\"https://en.wikipedia.org/wiki/Enterprise_service_bus\">enterprise service bus (ESB)</a>) and MAY be supported for endpoint provider systems.</p> \n-->\n\n<!--\n<p><code class=\"highlighter-rouge\">system</code> is a uniform resource identifier which defines which CodeSystem the identifer belongs to. For NHS Number this would be <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/nhs-number</code> and <code class=\"highlighter-rouge\">code</code> would be the NHS Number.</p>\n-->\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210&amp;type.coding=http://snomed.info/sct%7C736253002\n</span></code>\nReturn all DocumentReference records for a patient with NHS Number of 9876543210 and a pointer type of Mental Health Crisis plan.</pre>\n</div>\n\n<!--\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject.identifier=https://fhir.nhs.uk/Id/nhs-number|9876543210\n</span></code>\nReturn all DocumentReference resources for subjects (Patients) with a NHS Number of 9876543210</pre>\n</div>\n-->\n\n<!--\n<p> Suppliers and organisations MAY create their own `systemUri`s for local patient identifiers, e.g. the fictional Jorvik NHS Trust could use <code class=\"highlighter-rouge\">http://fhir.jorvik.nhs.uk/Patient</code> to identify a number as the trusts hospital number.</p>\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?patient.identifier=https://fhir.jorvik.nhs.uk/Patient|12345678\n</span></code>\nReturn all DocumentReference resources for Patients with Jorvik Trust Hospital Number of 12345678</pre>\n</div>\n-->\n\n<h4 id=\"_id\"> _summary</h4>\n\n<p>The search parameter <code class=\"highlighter-rouge\">_summary</code> allows the client to retrieve the number of <code class=\"highlighter-rouge\">DocumentReference</code>s that match a given search.</p>\n\n<p>See <a href=\"https://www.hl7.org/fhir/search.html#summary\">_summary</a> for details on this parameter. The _summary parameter can be used as follows:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\nGET [baseUrl]/DocumentReference?subject=[reference]&amp;_summary=count</div>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\"><code><span class=\"err\">GET [baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210&amp;_summary=count\n</span></code>\nReturn a count of resources for a patient with a NHS Number of 9876543210</pre>\n</div>\n\n<p>The <code class=\"highlighter-rouge\">_summary</code> search parameter must be set to the value ‘count’ to retrieve the number of matching results.\nOther FHIR values for this search parameter are not supported.</p>\n\n<h2 id=\"search-response\">Search Response</h2>\n\n<p>Success:</p>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">200</code> <strong>OK</strong> HTTP status code on successful execution of the interaction.</li>\n  <li>MUST return a <code class=\"highlighter-rouge\">Bundle</code> of <code class=\"highlighter-rouge\">type</code> searchset, containing either:\n    <ul>\n      <li>\n        <p>One or more <code class=\"highlighter-rouge\">DocumentReference</code> resources that conform to the NRL DocumentReference FHIR profile and that have the status value of “current”.</p>\n\n        <div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The version of the pointer model (FHIR profile) will be indicated in the <code class=\"highlighter-rouge\">DocumentReference.meta.profile</code> metadata attribute for each pointer (see <a href=\"explore_reference.html#1-profiles\">FHIR Resources &amp; References</a>). A ‘Bundle’ may contain pointers which conform to different versions of the pointer model.</div>\n      </li>\n      <li>\n        <p>A <code class=\"highlighter-rouge\">0</code> (zero) total value indicating no record was matched, i.e. an empty <code class=\"highlighter-rouge\">Bundle</code>.</p>\n\n        <div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The NRL Service will ONLY return an empty bundle if a Spine Clincals record exists and there is no DocumentReference for that specific Clinicals record.</div>\n      </li>\n    </ul>\n\n    <p><!--<div markdown=\"span\" class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The returned searchset bundle does NOT currently support: <br/> <br/> (1) the `self link`, which carries the encoded parameters that were actually used to process the search. <br/> <br/> (2) the identity of resources in the entry using the `fullUrl` element. <br/> <br/> (3) resources matched in a successful search using the `search.mode` element. <br/> <br/> NB: The NRL Service will ONLY return an empty bundle if a Spine Clincals record exists and there is no DocumentReference for that specific Clinicals record.</div>\n--></p>\n  </li>\n  <li>\n    <p>Where a DocumentReference is returned, it MUST include the versionId <!--and fullUrl--> of the current version of the DocumentReference resource.</p>\n  </li>\n  <li>\n    <p>When a Consumer retrieves a DocumentReference if the masterIdentifier is set then it SHOULD be included in the returned DocumentReference.</p>\n  </li>\n  <li>When a Consumer retrieves a DocumentReference if the relatesTo is set then it SHOULD be included in the returned DocumentReference.</li>\n</ul>\n\n<p>Failure:</p>\n\n<p>The following errors can be triggered when performing this operation:</p>\n\n<ul>\n  <li><a href=\"development_general_api_guidance.html#invalid-nhs-number\">Invalid NHS number</a></li>\n  <li><a href=\"development_general_api_guidance.html#parameters\">Invalid parameter</a></li>\n  <li><a href=\"development_general_api_guidance.html#resource-not-found\">No record found</a></li>\n</ul>\n\n<h2 id=\"example-scenario\">Example Scenario</h2>\n\n<p>An authorised NRL Consumer searches for a patient’s relevant health record using the NRL to discover potentially vital information to support a patient’s emergency crisis care.</p>\n\n<h3 id=\"request-query\">Request Query</h3>\n\n<p>Return all DocumentReference resources (pointers) for a patient with a NHS Number of 9876543210. The format of the response body will be XML.</p>\n\n<h4 id=\"curl\">cURL</h4>\n\n<pre class=\"embedcurl\" title=\"Search DocumentReference\" width=\"100%\" height=\"200px\">curl -H 'Accept: application/fhir+xml' -H 'Authorization: BEARER [token]' -X GET  '[baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210&amp;_format=xml'</pre>\n<!-- You only need to reference this script once per page. -->\n<script src=\"https://www.embedcurl.com/embedcurl.min.js\" async=\"\"></script>\n\n<h4 id=\"query-response-http-headers\">Query Response Http Headers</h4>\n\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>HTTP/1.1 200 OK\nServer: nginx/1.10.0 (Ubuntu)\nDate: Mon, 19 Jun 2017 08:36:12 GMT\nContent-Type: application/fhir+xml;charset=utf-8\nLast-Modified: Mon, 19 Jun 2017 08:36:12 GMT\n</code></pre></div></div>\n\n<h4 id=\"query-response\">Query Response</h4>\n\n<h5 id=\"single-pointer-documentreference-returned\"><strong>Single Pointer (DocumentReference) Returned:</strong></h5>\n\n<ul>\n  <li>HTTP 200-Request was successfully executed</li>\n  <li>Bundle resource of type searchset containing a total value ‘1’ DocumentReference resource that conforms to the <code class=\"highlighter-rouge\">NRL-DocumentReference-1</code> profile.</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;Bundle</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"dd9724d1-7b61-44e2-9023-b72e6b966018-76563212455590986546\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">\"searchset\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;total</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;link&gt;</span>\n        <span class=\"nt\">&lt;relation</span> <span class=\"na\">value=</span><span class=\"s\">\"self\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference?subject=https%3A%2F%2Fdemographics.spineservices.nhs.uk%2FSTU3%2FPatient%2F9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;entry&gt;</span>\n        <span class=\"nt\">&lt;fullUrl</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference/0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;resource&gt;</span>\n            <span class=\"nt\">&lt;DocumentReference&gt;</span>\n                <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;meta&gt;</span>\n                    <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span> \n                <span class=\"nt\">&lt;/meta&gt;</span>\n                <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n                <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;type&gt;</span>\n                    <span class=\"nt\">&lt;coding&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/coding&gt;</span>\n                <span class=\"nt\">&lt;/type&gt;</span>\n                <span class=\"nt\">&lt;class&gt;</span>\n                    <span class=\"nt\">&lt;coding&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/coding&gt;</span>\n                <span class=\"nt\">&lt;/class&gt;</span>\n                <span class=\"nt\">&lt;subject&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/subject&gt;</span>\n                <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;author&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/author&gt;</span>\n                <span class=\"nt\">&lt;custodian&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/custodian&gt;</span>\n                <span class=\"nt\">&lt;relatesTo&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;target&gt;</span>\n                        <span class=\"nt\">&lt;identifier&gt;</span>\n                            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;/identifier&gt;</span>\n                    <span class=\"nt\">&lt;/target&gt;</span>\n                <span class=\"nt\">&lt;/relatesTo&gt;</span>\n                <span class=\"nt\">&lt;content&gt;</span>\n                    <span class=\"nt\">&lt;attachment&gt;</span>\n                        <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/attachment&gt;</span>\n                    <span class=\"nt\">&lt;format&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/format&gt;</span>\n                    <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n                        <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                            <span class=\"nt\">&lt;coding&gt;</span>\n                                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;/coding&gt;</span>\n                        <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n                    <span class=\"nt\">&lt;/extension&gt;</span>\n                <span class=\"nt\">&lt;/content&gt;</span>\n                <span class=\"nt\">&lt;context&gt;</span>\n                    <span class=\"nt\">&lt;period&gt;</span>\n                        <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/period&gt;</span>\n                    <span class=\"nt\">&lt;practiceSetting&gt;</span>\n                        <span class=\"nt\">&lt;coding&gt;</span>\n                            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;/coding&gt;</span>\n                    <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n                <span class=\"nt\">&lt;/context&gt;</span>\n            <span class=\"nt\">&lt;/DocumentReference&gt;</span>\n        <span class=\"nt\">&lt;/resource&gt;</span>\n        <span class=\"nt\">&lt;search&gt;</span>\n            <span class=\"nt\">&lt;mode</span> <span class=\"na\">value=</span><span class=\"s\">\"match\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/search&gt;</span>\n    <span class=\"nt\">&lt;/entry&gt;</span>\n<span class=\"nt\">&lt;/Bundle&gt;</span></code></pre></figure>\n\n</div>\n\n<h5 id=\"multiple-pointers-documentreference-returned\"><strong>Multiple Pointers (DocumentReference) Returned:</strong></h5>\n\n<ul>\n  <li>HTTP 200-Request was successfully executed</li>\n  <li>Bundle resource of type searchset containing a total value ‘2’ DocumentReference resources that conform to the <code class=\"highlighter-rouge\">NRL-DocumentReference-1</code> profile</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;Bundle</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"dd9724d1-7b61-44e2-9023-b72e6b966018-54446768443265458908\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">\"searchset\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;total</span> <span class=\"na\">value=</span><span class=\"s\">\"2\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;link&gt;</span>\n        <span class=\"nt\">&lt;relation</span> <span class=\"na\">value=</span><span class=\"s\">\"self\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference?subject=https%3A%2F%2Fdemographics.spineservices.nhs.uk%2FSTU3%2FPatient%2F9876543211\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;entry&gt;</span>\n        <span class=\"nt\">&lt;fullUrl</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference/0353e505-f7be-4c20-8f4e-337e79a32c51-58778905432232112312\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;resource&gt;</span>\n            <span class=\"nt\">&lt;DocumentReference&gt;</span>\n                <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"0353e505-f7be-4c20-8f4e-337e79a32c51-58778905432232112312\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;meta&gt;</span>\n                    <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span> \n                <span class=\"nt\">&lt;/meta&gt;</span>\n                <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.11\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n                <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;type&gt;</span>\n                    <span class=\"nt\">&lt;coding&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/coding&gt;</span>\n                <span class=\"nt\">&lt;/type&gt;</span>\n                <span class=\"nt\">&lt;class&gt;</span>\n                    <span class=\"nt\">&lt;coding&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/coding&gt;</span>\n                <span class=\"nt\">&lt;/class&gt;</span>\n                <span class=\"nt\">&lt;subject&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543211\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/subject&gt;</span>\n                <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2018-07-01T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;author&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/author&gt;</span>\n                <span class=\"nt\">&lt;custodian&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/custodian&gt;</span>\n                <span class=\"nt\">&lt;content&gt;</span>\n                    <span class=\"nt\">&lt;attachment&gt;</span>\n                        <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisTeam\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2018-07-01T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/attachment&gt;</span>\n                    <span class=\"nt\">&lt;format&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:record-contact\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Contact details (HTTP Unsecured)\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/format&gt;</span>\n                    <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n                        <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                            <span class=\"nt\">&lt;coding&gt;</span>\n                                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;/coding&gt;</span>\n                        <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n                    <span class=\"nt\">&lt;/extension&gt;</span>\n                <span class=\"nt\">&lt;/content&gt;</span>\n                <span class=\"nt\">&lt;context&gt;</span>\n                    <span class=\"nt\">&lt;period&gt;</span>\n                        <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2017-05-12T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/period&gt;</span>\n                    <span class=\"nt\">&lt;practiceSetting&gt;</span>\n                        <span class=\"nt\">&lt;coding&gt;</span>\n                            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;/coding&gt;</span>\n                    <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n                <span class=\"nt\">&lt;/context&gt;</span>\n            <span class=\"nt\">&lt;/DocumentReference&gt;</span>\n        <span class=\"nt\">&lt;/resource&gt;</span>\n        <span class=\"nt\">&lt;search&gt;</span>\n            <span class=\"nt\">&lt;mode</span> <span class=\"na\">value=</span><span class=\"s\">\"match\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/search&gt;</span>\n    <span class=\"nt\">&lt;/entry&gt;</span>\n    <span class=\"nt\">&lt;entry&gt;</span>\n        <span class=\"nt\">&lt;fullUrl</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference/5303c09e-de28-4622-9416-62ab0b22e15a-54598780989231213433\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;resource&gt;</span>\n            <span class=\"nt\">&lt;DocumentReference&gt;</span>\n                <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"5303c09e-de28-4622-9416-62ab0b22e15a-54598780989231213433\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;meta&gt;</span>\n                    <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span> \n                <span class=\"nt\">&lt;/meta&gt;</span>\n                <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.10\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n                <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;type&gt;</span>\n                    <span class=\"nt\">&lt;coding&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/coding&gt;</span>\n                <span class=\"nt\">&lt;/type&gt;</span>\n                <span class=\"nt\">&lt;class&gt;</span>\n                    <span class=\"nt\">&lt;coding&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/coding&gt;</span>\n                <span class=\"nt\">&lt;/class&gt;</span>\n                <span class=\"nt\">&lt;subject&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543211\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/subject&gt;</span>\n                <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2018-07-02T11:25:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;author&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/author&gt;</span>\n                <span class=\"nt\">&lt;custodian&gt;</span>\n                    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/custodian&gt;</span>\n                <span class=\"nt\">&lt;relatesTo&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;target&gt;</span>\n                        <span class=\"nt\">&lt;identifier&gt;</span>\n                            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.9\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;/identifier&gt;</span>\n                    <span class=\"nt\">&lt;/target&gt;</span>\n                <span class=\"nt\">&lt;/relatesTo&gt;</span>\n                <span class=\"nt\">&lt;content&gt;</span>\n                    <span class=\"nt\">&lt;attachment&gt;</span>\n                        <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/attachment&gt;</span>\n                    <span class=\"nt\">&lt;format&gt;</span>\n                        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/format&gt;</span>\n                    <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n                        <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                            <span class=\"nt\">&lt;coding&gt;</span>\n                                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;/coding&gt;</span>\n                        <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n                    <span class=\"nt\">&lt;/extension&gt;</span>\n                <span class=\"nt\">&lt;/content&gt;</span>\n                <span class=\"nt\">&lt;context&gt;</span>\n                    <span class=\"nt\">&lt;period&gt;</span>\n                        <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;end</span> <span class=\"na\">value=</span><span class=\"s\">\"2017-02-13T14:11:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;/period&gt;</span>\n                    <span class=\"nt\">&lt;practiceSetting&gt;</span>\n                        <span class=\"nt\">&lt;coding&gt;</span>\n                            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n                        <span class=\"nt\">&lt;/coding&gt;</span>\n                    <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n                <span class=\"nt\">&lt;/context&gt;</span>\n            <span class=\"nt\">&lt;/DocumentReference&gt;</span>\n        <span class=\"nt\">&lt;/resource&gt;</span>\n        <span class=\"nt\">&lt;search&gt;</span>\n            <span class=\"nt\">&lt;mode</span> <span class=\"na\">value=</span><span class=\"s\">\"match\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/search&gt;</span>\n    <span class=\"nt\">&lt;/entry&gt;</span>\n<span class=\"nt\">&lt;/Bundle&gt;</span></code></pre></figure>\n\n</div>\n\n<h5 id=\"no-record-pointer-matched\"><strong>No Record (Pointer) Matched:</strong></h5>\n\n<ul>\n  <li>HTTP 200-Request was successfully executed</li>\n  <li>Empty bundle resource of type searchset containing a ‘0’ (zero) total value indicating no record was matched</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;Bundle</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"de258b7f-2f0b-4b41-afcb-964d9995fd4f-65447656980012115439\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">\"searchset\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;total</span> <span class=\"na\">value=</span><span class=\"s\">\"0\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;link&gt;</span>\n        <span class=\"nt\">&lt;relation</span> <span class=\"na\">value=</span><span class=\"s\">\"self\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference?subject=https%3A%2F%2Fdemographics.spineservices.nhs.uk%2FSTU3%2FPatient%2F9876543213\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n<span class=\"nt\">&lt;/Bundle&gt;</span></code></pre></figure>\n\n</div>\n\n<h5 id=\"error-response-operationoutcome-returned\"><strong>Error Response (OperationOutcome) Returned:</strong></h5>\n\n<ul>\n  <li>HTTP 400-Bad Request. Invalid Parameter.</li>\n  <li>OperationOutcome resource that conforms to the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\">‘Spine-OperationOutcome-1’</a> profile if the search cannot be executed (not that there is no match)</li>\n</ul>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;OperationOutcome</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"5a4171ac-486e-11e8-9ffc-6c3be5a609f5-34326129638901216693\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;issue&gt;</span>\n        <span class=\"nt\">&lt;severity</span> <span class=\"na\">value=</span><span class=\"s\">\"error\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"invalid\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;details&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/Spine-ErrorOrWarningCode-1\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"INVALID_PARAMETER\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Invalid parameter\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/details&gt;</span>\n        <span class=\"nt\">&lt;diagnostics</span> <span class=\"na\">value=</span><span class=\"s\">\"The given resource URL does not conform to the expected format - https://demographics.spineservices.nhs.uk/STU3/Patient/[NHS Number]\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/issue&gt;</span>\n<span class=\"nt\">&lt;/OperationOutcome&gt;</span></code></pre></figure>\n\n</div>\n\n<p>See the <a href=\"development_general_api_guidance.html#error-handling\">general API guidance</a> for all HTTP Error response codes supported by the NRL.</p>\n\n<h5 id=\"_summarycount-response\"><strong><code class=\"highlighter-rouge\">_summary=count</code> Response:</strong></h5>\n\n<ul>\n  <li>Response body MUST return a valid XML or JSON formatted Bundle of type searchset, containing a bundle that reports the \ntotal number of resources that match in Bundle.total, but with no entries, and no prev/next/last links. Note that the Bundle.total \nonly include the total number of matching <code class=\"highlighter-rouge\">DocumentReference</code>s.</li>\n</ul>\n\n<p>Examples</p>\n<ul>\n  <li>Three <code class=\"highlighter-rouge\">DocumentReference</code>s exist for patient with NHS number passed into the search</li>\n</ul>\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;Bundle</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"de258b7f-2f0b-4b41-afcb-964d9995fdf-98874345667801234356\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">\"searchset\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;total</span> <span class=\"na\">value=</span><span class=\"s\">\"3\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;link&gt;</span>\n        <span class=\"nt\">&lt;relation</span> <span class=\"na\">value=</span><span class=\"s\">\"self\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference?subject=https%3A%2F%2Fdemographics.spineservices.nhs.uk%2FSTU3%2FPatient%2F9876543214&amp;amp;_summary=count\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n<span class=\"nt\">&lt;/Bundle&gt;</span> </code></pre></figure>\n\n</div>\n\n<ul>\n  <li>No <code class=\"highlighter-rouge\">DocumentReference</code>s exist for patient with NHS number passed into the search</li>\n</ul>\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;Bundle</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"de258b7f-2f0b-4b41-afcb-964d5995fd4f-16547321986190065387\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">\"searchset\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;total</span> <span class=\"na\">value=</span><span class=\"s\">\"0\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;link&gt;</span>\n        <span class=\"nt\">&lt;relation</span> <span class=\"na\">value=</span><span class=\"s\">\"self\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference?subject=https%3A%2F%2Fdemographics.spineservices.nhs.uk%2FSTU3%2FPatient%2F9876543213&amp;amp;_summary=count\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/link&gt;</span>\n<span class=\"nt\">&lt;/Bundle&gt;</span> </code></pre></figure>\n\n</div>\n\n<h2 id=\"code-examples\">Code Examples</h2>\n\n<h3 id=\"get-pointers-with-c\">GET Pointers with C</h3>\n\n<p>The following code samples are taken from the NRL Demonstrator application which has both Consumer and Provider client implementations built in. More information about the design solution can be found on the <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/wiki\">NRL Demonstrator Wiki</a></p>\n\n<p>First we generate a base pointer request model that includes the patient’s NHS Number used for the subject parameter. \nThe NHS Number is obtained through a stub PDS Trace performed within the Demonstrator Consumer system.</p>\n\n<p>Then we call our DocumentReference service GetPointersBundle method which will build a GET command request and then start the call to the NRL API.</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Nrls/PointerService.cs#L34-L36\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.Services/Service/Nrls/PointerService.cs#L34-L36 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Nrls/PointerService.cs#L34-L36\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.Services/Service/Nrls/PointerService.cs#L34-L36\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"kt\">var</span> <span class=\"n\">pointerRequest</span> <span class=\"p\">=</span> <span class=\"n\">NrlsPointerRequest</span><span class=\"p\">.</span><span class=\"nf\">Search</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">OrgCode</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Id</span><span class=\"p\">,</span> <span class=\"k\">null</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Asid</span><span class=\"p\">,</span> <span class=\"k\">null</span><span class=\"p\">);</span>\n\n<span class=\"kt\">var</span> <span class=\"n\">pointerResponse</span> <span class=\"p\">=</span> <span class=\"k\">await</span> <span class=\"n\">_docRefService</span><span class=\"p\">.</span><span class=\"nf\">GetPointersBundle</span><span class=\"p\">(</span><span class=\"n\">pointerRequest</span><span class=\"p\">);</span></code></pre></figure>\n\n</div>\n\n<p>Once we have received pointers from the NRL when then look up the custodian (and author) organisation details using the ODS Code’s held within each pointer via a stub ODS lookup. We can then present actual organisation details to the end users.</p>\n\n<p><b>Calling the NRL</b><br />\nUsing our GET command request model we create a connection to the NRL using HttpClient.</p>\n\n<p>You can view the common connection code example <a href=\"connectioncode_example.html\">here</a>.</p>\n\n<p><b>Explore the NRL</b><br />\nYou can explore and test the NRL GET command using Swagger in the <a href=\"https://data.developer.nhs.uk/nrls-ri/index.html#/Nrls/searchPointers\">NRL API Reference Implementation</a>.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The code in these examples is standard C# v7.2 taken directly from the <a href=\"https://nrls.digital.nhs.uk\">NRL Demonstrator</a> code.<br /><br />The official <b><a href=\"https://ewoutkramer.github.io/fhir-net-api/\">.NET FHIR Library</a></b> is utilised to construct, test, parse, and serialize FHIR models with ease.</div>\n\n"
		
	}
	,

	{
		
		"title": "API Supersede Interaction",
		"tags": "fhirfor_providers",
		"keywords": "structured supersede rest documentreference",
		"url": "api_interaction_supersede.html",
		"summary": "To support the superseding of NRL pointers",
		"content": "\n<h2 id=\"0-references\">References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">DocumentReference</a></div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"https://www.hl7.org/fhir/STU3/documentreference.html\">DocumentReference</a></div> </td>\n          <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n        <!--<td><div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->\n</tr>\n</table>\n\n<h2 id=\"create-supersede\">Create (Supersede)</h2>\n\n<p>Provider interaction to support superseding NRL pointers. \nCreate with Supersede (abbreviated to Supersede) is an extension of the <a href=\"api_interaction_create.html\">Create Interaction</a>.\nThe Supersede functionality will be used in cases where a Provider wishes to replace one DocumentReference with another, newer one.</p>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href=\"explore.html#2-prerequisites-for-nrl-api\">Development Guidance</a> page MUST be followed when using this interaction.</p>\n\n<h2 id=\"supersede-request-headers\">Supersede Request Headers</h2>\n\n<p>Provider API supersede requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"supersede-operation\">Supersede Operation</h2>\n\n<p>The NRL API does not allow a true Update operation (the HTTP <code class=\"highlighter-rouge\">PUT</code> verb is not supported).</p>\n\n<p>Instead, a pointer can be replaced by superseding it with a newer version that contains the updated attributes.</p>\n\n<p>A Provider transitions an existing Pointer’s status from “current” to “superseded” as part of the act of creating its replacement. The Create action allows specifying an existing DocumentReference to be superseded. The process is as follows:</p>\n\n<ol>\n  <li>The Provider assembles a new DocumentReference resource</li>\n  <li>The Provider populates the <code class=\"highlighter-rouge\">relatesTo</code> property with a new target element which holds:\n    <ul>\n      <li>A reference that is the logical identifier of the existing DocumentReference or an identifier that is the masterIdentifier of the existing DocumentReference</li>\n      <li>The action code “replaces”</li>\n    </ul>\n  </li>\n  <li>The Provider POSTs the DocumentReference resource</li>\n  <li>The NRL will transactionally:\n    <ol>\n      <li>Create the new DocumentReference, marking it as “current”</li>\n      <li>Resolve the existing DocumentReference using <code class=\"highlighter-rouge\">relatesTo.target</code></li>\n      <li>Mark that DocumentReference as “superseded”</li>\n      <li>Set the version number of the newly-created DocumentReference to its predecessor’s version +1</li>\n    </ol>\n  </li>\n</ol>\n\n<p>Provider systems MUST only supersede pointers for records where they are the pointer owner (custodian).</p>\n\n<p>The target property within the relatesTo attribute must be either a reference or a FHIR identifier, depending on whether a provider chooses to supersede by logical ID or supersede by master identifier.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> NRL supports the ability to update a pointers status from \"current\" to \"entered-in-error\" using the HTTP PATCH verb. For more details, see the <a href=\"api_interaction_update.html\">Update Interaction</a> page.</div>\n\n<h2 id=\"supersede-by-logical-id\">Supersede by Logical ID</h2>\n\n<p>To supersede by logical ID, the relatesTo.target attribute on the DocumentReference should be a FHIR reference property i.e. an absolute literal reference to a DocumentReference held within NRL. The value should be a URL in the form of read by logical ID.</p>\n\n<p>Example of a DocumentReference relatesTo property populated using a FHIR reference.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"relatesTo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"replaces\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"s2\">\"target\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference/0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<h2 id=\"supersede-by-master-identifier\">Supersede by Master Identifier</h2>\n\n<p>To supersede by Master identifier, the relatesTo.target attribute on the DocumentReference should be a FHIR identifier. The Identifier is interpreted as the masterIdentifier of a DocumentReference held within NRL.</p>\n\n<p>Example of a DocumentReference relatesTo property populated using a FHIR identifier.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"relatesTo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"replaces\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"s2\">\"target\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"identifier\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:ietf:rfc:3986\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"value\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<p>In both cases (use of reference or identifier values) the patient NHS Number on the new (to be created) DocumentReference and the DocumentReference being superseded must match. For more details, see <a href=\"development_general_api_guidance.html#patient-mismatch\">Error Handling Guidance</a>.</p>\n\n<p>If both the target.reference property and the target.identifier property are populated then the NRL will use the target.reference property to resolve the DocumentReference. If a DocumentReference is found, then the MasterIdentifier of the returned DocumentReference must match the identifier in the relatesTo collection. For more details, see <a href=\"development_general_api_guidance.html#masteridentifier-mismatch\">Error Handling Guidance</a>.</p>\n\n<p>The NRL will only accept one relatesTo element. Requests that contain multiple relatesTo elements will be rejected. For more details, see <a href=\"development_general_api_guidance.html#documentreferencerelatesto\">Error Handling Guidance</a>.</p>\n\n<h3 id=\"supersede-by-logical-id-xml-example\">Supersede by Logical ID XML Example</h3>\n\n<p>An XML Example of a DocumentReference resource that supersedes an existing DocumentReference by Logical ID.</p>\n\n<p>Please note the addition of the relatesTo property within the DocumentReference example below.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;relatesTo&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;target&gt;</span>\n            <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference/0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/target&gt;</span>\n    <span class=\"nt\">&lt;/relatesTo&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n\n<h3 id=\"supersede-by-logical-id-json-example\">Supersede by Logical ID JSON Example</h3>\n\n<p>A JSON Example of a DocumentReference resource that supersedes an existing DocumentReference by Logical ID.</p>\n\n<p>Please note the addition of the relatesTo property within the DocumentReference example below.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json-doc\" data-lang=\"json-doc\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"DocumentReference\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"meta\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"profile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"status\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"current\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"736253002\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health crisis plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"class\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"734163000\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Care plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"subject\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"indexed\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"author\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"custodian\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"content\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"attachment\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"contentType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"application/pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"creation\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"format\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:nhs-ic:unstructured\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Unstructured Document\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"extension\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"valueCodeableConcept\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                        </span><span class=\"p\">{</span><span class=\"w\">\n                            </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"static\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Static\"</span><span class=\"w\">\n                        </span><span class=\"p\">}</span><span class=\"w\">\n                    </span><span class=\"p\">]</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"relatesTo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"replaces\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"s2\">\"target\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://psis-sync.national.ncrs.nhs.uk/DocumentReference/0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"context\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"period\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"start\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"w\">\n        </span><span class=\"p\">},</span><span class=\"w\">\n        </span><span class=\"s2\">\"practiceSetting\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"708168004\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health service\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<h3 id=\"supersede-by-master-identifier-xml-example\">Supersede by Master Identifier XML Example</h3>\n\n<p>An XML Example of a DocumentReference resource that supersedes an existing DocumentReference by Master Identifier.</p>\n\n<p>Please note the addition of the relatesTo property within the DocumentReference example below.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;relatesTo&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;target&gt;</span>\n            <span class=\"nt\">&lt;identifier&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/identifier&gt;</span>\n        <span class=\"nt\">&lt;/target&gt;</span>\n    <span class=\"nt\">&lt;/relatesTo&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n\n<h3 id=\"supersede-by-master-identifier-json-example\">Supersede by Master Identifier JSON Example</h3>\n\n<p>A JSON Example of a DocumentReference resource that supersedes an existing DocumentReference by Master Identifier.</p>\n\n<p>Please note the addition of the relatesTo property within the DocumentReference example below.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json-doc\" data-lang=\"json-doc\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"DocumentReference\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"meta\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"profile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"masterIdentifier\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:ietf:rfc:3986\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"s2\">\"value\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"status\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"current\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"736253002\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health crisis plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"class\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"734163000\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Care plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"subject\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"indexed\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"author\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"custodian\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"content\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"attachment\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"contentType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"application/pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"creation\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"format\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:nhs-ic:unstructured\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Unstructured Document\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"extension\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"valueCodeableConcept\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                        </span><span class=\"p\">{</span><span class=\"w\">\n                            </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"static\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Static\"</span><span class=\"w\">\n                        </span><span class=\"p\">}</span><span class=\"w\">\n                    </span><span class=\"p\">]</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"relatesTo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"replaces\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"s2\">\"target\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"identifier\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:ietf:rfc:3986\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"value\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"context\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"period\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"start\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"w\">\n        </span><span class=\"p\">},</span><span class=\"w\">\n        </span><span class=\"s2\">\"practiceSetting\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"708168004\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health service\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<h2 id=\"response\">Response</h2>\n\n<p>Success and Failure:</p>\n\n<p>As an extension of the Create interaction, the success and failure responses are the same for Supersede as they are for Create.</p>\n\n<p>See <a href=\"api_interaction_create.html#create-response\">Create Interaction - Responses</a> for details of the expected response behaviours and codes.</p>\n\n<h2 id=\"code-examples\">Code Examples</h2>\n\n<p>When either Creating or Superseding a Pointer, the same HTTP POST verb is used.</p>\n\n<p>See <a href=\"api_interaction_create.html#code-examples\">Create Interaction - Code Examples</a> for an example of POSTing a pointer.</p>\n"
		
	}
	,

	{
		
		"title": "API Update Interaction",
		"tags": "fhirfor_providers",
		"keywords": "structured update rest documentreference",
		"url": "api_interaction_update.html",
		"summary": "To support the update of NRL pointers",
		"content": "\n<h2 id=\"0-references\">References</h2>\n\n<table border=\"0\" width=\"100%\">\n    <tr>\n        <td><div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-gavel\"></i> <b>NHS Digital Profile:</b><br /> <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">DocumentReference</a></div></td>\n        <td><div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-fire\"></i>  <b>HL7 FHIR STU3 Resource:</b><br /> <a href=\"https://www.hl7.org/fhir/STU3/documentreference.html\">DocumentReference</a></div> </td>\n          <td><div class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br /> - </div></td>\n        <!--<td><div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-cog\"></i> <b>User Stories:</b><br> [User Stories]( )</div></td>-->\n</tr>\n</table>\n\n<h2 id=\"update\">Update</h2>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> The Supersede interaction previously detailed on this page has been moved to the <a href=\"api_interaction_supersede.html\">Supersede Interaction</a> page.</div>\n\n<p>Provider interaction to support the update of NRL pointers. The update functionality will be used in cases where a Provider wishes to update a pointer status value, changing it from “current” to “entered-in-error”.</p>\n\n<h2 id=\"prerequisites\">Prerequisites</h2>\n\n<p>In addition to the requirements on this page the general guidance and requirements detailed on the <a href=\"explore.html#2-prerequisites-for-nrl-api\">Development Guidance</a> page MUST be followed when using this interaction.</p>\n\n<h2 id=\"update-request-headers\">Update Request Headers</h2>\n\n<p>Provider API update requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Accept</code></td>\n      <td>The <code class=\"highlighter-rouge\">Accept</code> header indicates the format of the response the client is able to understand, this will be one of the following <code class=\"highlighter-rouge\">application/fhir+json</code> or <code class=\"highlighter-rouge\">application/fhir+xml</code>. See the RESTful API <a href=\"development_general_api_guidance.html#content-types\">Content types</a> section.</td>\n      <td>OPTIONAL</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">fromASID</code></td>\n      <td>Client System ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">toASID</code></td>\n      <td>The Spine ASID</td>\n      <td>REQUIRED</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"update-operation\">Update Operation</h2>\n\n<p>Provider systems MUST construct a <a href=\"https://www.hl7.org/fhir/STU3/fhirpatch.html\">FHIRPath PATCH Parameters resource</a> and submit this to NRL using the FHIR RESTful <a href=\"https://www.hl7.org/fhir/STU3/http.html#patch\">patch</a> interaction.</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">PATCH [baseUrl]/DocumentReference/[id]</code>\n</div>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\">\n<code><span class=\"err\">PATCH [baseUrl]/DocumentReference/da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142\n</span></code>\nUpdate the DocumentReference resource status for a pointer with the logical id of 'da2b6e8a-3c8f-11e8-baae-6c3be5a609f5-584d385036514c383142'.</pre>\n</div>\n\n<p>The API supports the conditional update interaction which allows a provider to update a pointer using the masterIdentifier so they do not have to persist or query for the NRL generated logical id for the pointer. The query parameters should be used as shown:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">PATCH [baseUrl]/DocumentReference?subject=[https://demographics.spineservices.nhs.uk/STU3/Patient/[nhsNumber]&amp;amp;identifier=[system]%7C[value]</code>\n</div>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\">\n<code><span class=\"err\">PATCH [baseUrl]/DocumentReference?subject=https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210&amp;identifier=urn:ietf:rfc:3986%7Curn:oid:1.3.6.1.4.1.21367.2005.3.71\n</span></code>\nUpdate the DocumentReference resource status for a pointer with a subject and identifier.</pre>\n</div>\n\n<p><em>[nhsNumber]</em> - The NHS number of the patient whose <code class=\"highlighter-rouge\">DocumentReference</code>s the client is requesting</p>\n\n<p><em>[system]</em> - The namespace of the masterIdentifier value that is associated with the DocumentReference(s)</p>\n\n<p><em>[value]</em> - The value of the masterIdentifier that is associated with the DocumentReference(s)</p>\n\n<p>Providers systems MUST only update pointers for records where they are the pointer owner (custodian).\nFor all update requests the custodian ODS code in the DocumentReference resource MUST be affiliated with the Client System ASID value in the fromASID HTTP request header sent to the NRL.</p>\n\n<p>The FHIRPath PATCH operation must be encoded in a Parameters resource as follows:</p>\n<ul>\n  <li>A single operation as a Parameter named “operation”</li>\n  <li>The single parameter has a series of mandatory parts, with required values as listed in  following table:</li>\n</ul>\n\n<table>\n  <thead>\n    <tr>\n      <th>Parameter</th>\n      <th>Type</th>\n      <th>Required Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Type</code></td>\n      <td>code</td>\n      <td><code class=\"highlighter-rouge\">replace</code></td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Path</code></td>\n      <td>string</td>\n      <td><code class=\"highlighter-rouge\">DocumentReference.status</code></td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Value</code></td>\n      <td>string</td>\n      <td><code class=\"highlighter-rouge\">entered-in-error</code></td>\n    </tr>\n  </tbody>\n</table>\n\n<p>Only the first parameter within the Parameters resource will be used to perform a PATCH. Any additional parameters included within the request will not be processed. More details on the validation of the Parameters resource can be found in the <a href=\"development_general_api_guidance.html#invalid-resource\">error handling guidance</a>.</p>\n\n<p>XML and JSON examples of the FHIRPath Parameters resource are shown below.</p>\n\n<h3 id=\"xml-fhirpath-patch-parameters-resource\">XML FHIRPath PATCH Parameters Resource</h3>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;Parameters</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;parameter&gt;</span>\n        <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"operation\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;part&gt;</span>\n            <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"type\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">\"replace\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/part&gt;</span>\n        <span class=\"nt\">&lt;part&gt;</span>\n            <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"path\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;valueString</span> <span class=\"na\">value=</span><span class=\"s\">\"DocumentReference.status\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/part&gt;</span>\n        <span class=\"nt\">&lt;part&gt;</span>\n            <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"value\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;valueString</span> <span class=\"na\">value=</span><span class=\"s\">\"entered-in-error\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/part&gt;</span>\n    <span class=\"nt\">&lt;/parameter&gt;</span>\n<span class=\"nt\">&lt;/Parameters&gt;</span></code></pre></figure>\n\n</div>\n\n<h3 id=\"json-fhirpath-patch-parameters-resource\">JSON FHIRPath PATCH Parameters Resource</h3>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Parameters\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"parameter\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"operation\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"s2\">\"part\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"type\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"valueCode\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"replace\"</span><span class=\"w\">\n                </span><span class=\"p\">},</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"path\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"valueString\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"DocumentReference.status\"</span><span class=\"w\">\n                </span><span class=\"p\">},</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"value\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"valueString\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"entered-in-error\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<h2 id=\"response\">Response</h2>\n\n<p>Success:</p>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">200</code> <strong>SUCCESS</strong> HTTP status code on successful execution of the interaction and the entry has been successfully updated in the NRL.</li>\n  <li>MUST return a response body containing a payload with an <code class=\"highlighter-rouge\">OperationOutcome</code> resource that conforms to the <a href=\"http://hl7.org/fhir/STU3/operationoutcome.html\">‘Operation Outcome’</a> core FHIR resource (see the table below).</li>\n  <li>When a resource has been updated, its <code class=\"highlighter-rouge\">versionId</code> will be incremented.</li>\n</ul>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The <code class=\"highlighter-rouge\">versionId</code> is an integer that is assigned and maintained by the NRL server. When a new DocumentReference is created, the server assigns it a <code class=\"highlighter-rouge\">versionId</code> of 1. The <code class=\"highlighter-rouge\">versionId</code> will be incremented during an update or supersede transaction. <br /><br /> The NRL server will ignore any <code class=\"highlighter-rouge\">versionId</code> value sent by a client in a <code class=\"highlighter-rouge\">create</code> interaction. Instead, the server will ensure that the newly assigned <code class=\"highlighter-rouge\">versionId</code> adheres to the rules laid out above.\n</div>\n\n<p>The table summarises the <code class=\"highlighter-rouge\">update</code> interaction HTTP response code and the values expected to be conveyed in the successful response body <code class=\"highlighter-rouge\">OperationOutcome</code> payload:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Details.Text</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>200</td>\n      <td>information</td>\n      <td>informational</td>\n      <td>RESOURCE_UPDATED</td>\n      <td>Resource has been updated</td>\n      <td>Spine message UUID</td>\n      <td>Successfully updated resource DocumentReference</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Upon successful update of a pointer the NRL Service returns in the response payload an OperationOutcome resource with the OperationOutcome.issue.details.text element populated with a Spine internal message UUID. This UUID is used to identify the client’s Update transaction within Spine. A client system SHOULD reference the UUID in any calls raised with the Deployment Issues Resolution Team. The UUID will be used to retrieve log entries that relate to a specific client transaction.</div>\n\n<p>Failure:</p>\n\n<p>The following errors can be triggered when performing this operation:</p>\n\n<ul>\n  <li><a href=\"development_general_api_guidance.html#invalid-request-message\">Invalid Request Message</a></li>\n  <li><a href=\"development_general_api_guidance.html#update-invalid-resource-errors\">Invalid Resource</a></li>\n  <li><a href=\"development_general_api_guidance.html#parameters\">Invalid Parameter</a></li>\n  <li><a href=\"development_general_api_guidance.html#resource-not-found\">Resource Not Found</a></li>\n  <li><a href=\"development_general_api_guidance.html#inactive-documentreference\">Inactive Document Reference</a></li>\n</ul>\n"
		
	}
	,

	{
		
		"title": "Assure Overview",
		"tags": "assurancefor_providersfor_consumers",
		"keywords": "assure accredit",
		"url": "assure.html",
		"summary": "These pages assist with the NRL Service Assurance Process",
		"content": "<h3 id=\"solution-assurance-process-overview\">Solution Assurance Process Overview</h3>\n\n<ol>\n  <li>\n    <p>The Programme Team will provide Suppliers with the necessary information and materials to enable them to determine the feasibility of developing a technical product. This can be done with a combination of face-to-face meetings and video-conference software. The NRL onboarding guide will be provided, detailing the full end-to-end process for integrating with the NRL. A copy can be obtained from <a href=\"https://digital.nhs.uk/services/national-record-locator-nrl\">the NRL Service page</a>.</p>\n  </li>\n  <li>\n    <p>The Supplier completes a Usage and Settings document to get Programme approval for usage and settings of the NRL.</p>\n\n    <p><em>Note</em>: The Usage and Settings document is not needed for the pilot stage.</p>\n  </li>\n  <li>\n    <p>The <a href=\"mailto:itkconformance@nhs.net\">Solution Assurance team</a> will work with the supplier throughout development and assurance, providing assistance with technical support and test and assurance queries. They are also responsible for reviewing and certifying Supplier submissions.</p>\n  </li>\n  <li>\n    <p>As part of this process, the supplier will need to complete a SCAL (Supplier Conformance and Assessment List). The SCAL should be completed by adding comments and referencing evidence where needed.</p>\n  </li>\n  <li>\n    <p>A baseline version of the SCAL can be downloaded from the onboarding guide. A copy of this can be obtained from <a href=\"https://digital.nhs.uk/services/national-record-locator-nrl\">the NRL Service page</a>. The SCAL will be customised for each Supplier by the Solution Assurance team to reflect only the requirements and related tests that are in scope for the Supplier product.</p>\n  </li>\n  <li>\n    <p>The Supplier should carry out initial development against <a href=\"https://developer.nhs.uk/testcentre/itk-nrls/\">TKW testbench</a>.</p>\n  </li>\n  <li>\n    <p>Further testing can be done in the test environments OpenTest or DEV. These environments will be populated with test data which will support all test cases identified by the SCAL. Suppliers will be able to carry out their own initial testing in these environments.</p>\n  </li>\n  <li>\n    <p>Further data can be added to test environments by suppliers using a self-service portal.</p>\n  </li>\n  <li>\n    <p>Solution Assurance will provide access to the test environments.</p>\n  </li>\n  <li>\n    <p>While connected to the INT test environment, the Supplier will be expected to execute the System Test cases provided by NHS Digital as identified within the SCAL. The linked evidence of screenshots and message logs from these tests will be captured and provided to NHS Digital for validation. The Functional Integration Tests against a PTL environment (specifically INT) provides risk mitigation against the live service deployment.</p>\n  </li>\n  <li>\n    <p>Some negative Functional Tests which form part of the assurance will be performed against TKW testbench.</p>\n  </li>\n  <li>\n    <p>On successful completion of testing, Solution Assurance will provide a Conformance Certificate, and the SCAL will be updated to reflect this status.</p>\n  </li>\n  <li>\n    <p>In parallel, the non-test-related SCAL tabs will be completed by the supplier.</p>\n  </li>\n  <li>\n    <p>Any open defects relating to the test will be shared with NHS Digital stakeholders for agreement regarding a work off plan. Work off plan items may need to be resolved prior to Go Live/Post Pilot.</p>\n  </li>\n  <li>\n    <p>The supplier is now ready for a live deployment, which will be managed by the NHS Digital Operations and Service Management team. This will involve the end-user organisation completing an EUD (End User Declaration) via the EUOP (End User Online Portal), providing sign-off to NHS Digital.</p>\n\n    <div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> There may be some additional Clinical Safety group involvement at this stage, if the SCAL assessment flags their sign-off as being required. The same applies to the IG assessment, which may also flag NHS Digital sign-off required.</div>\n  </li>\n</ol>\n\n"
		
	}
	,

	{
		
		"title": "Connection Code",
		"tags": "developmentfhir",
		"keywords": "structured rest",
		"url": "connectioncode_example.html",
		"summary": "Connection code Examples",
		"content": "<h2 id=\"common-nrl-connection-code-examples\">Common NRL Connection Code Examples</h2>\n\n<h3 id=\"connecting-with-c\">Connecting with C</h3>\n\n<p>The following code samples are taken from the NRL Demonstrator application which has both Consumer and Provider client implementations built in. More information about the design solution can be found\non the <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/wiki\">NRL Demonstrator Wiki</a></p>\n\n<p>To start we create a base command request model that defines the type of request we want to make (GET, POST or DELETE) and then sets the required attributes.\nWithin the model the full url to the NRL API is constructed including appending any required parameter values passed in.</p>\n\n<p>At this point we also generate our JWT using the ASID, ODS Code and User Role Profile ID values that are passed in.</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L91-L112\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L91-L112 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L91-L112\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/DocumentReferences/DocumentReferenceServices.cs#L91-L112\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"k\">private</span> <span class=\"n\">CommandRequest</span> <span class=\"nf\">BuildRequest</span><span class=\"p\">(</span><span class=\"kt\">string</span> <span class=\"n\">asid</span><span class=\"p\">,</span> <span class=\"kt\">string</span> <span class=\"n\">resourceId</span><span class=\"p\">,</span> <span class=\"kt\">string</span> <span class=\"n\">nhsNumber</span><span class=\"p\">,</span> <span class=\"kt\">string</span> <span class=\"n\">custodianOrgCode</span><span class=\"p\">,</span> <span class=\"kt\">string</span> <span class=\"n\">typeCode</span><span class=\"p\">,</span> <span class=\"kt\">string</span> <span class=\"n\">jwtOrgCode</span><span class=\"p\">,</span> <span class=\"n\">HttpMethod</span> <span class=\"n\">method</span><span class=\"p\">,</span> <span class=\"n\">HttpContent</span> <span class=\"n\">content</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"kt\">var</span> <span class=\"n\">command</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"n\">CommandRequest</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">BaseUrl</span> <span class=\"p\">=</span> <span class=\"s\">$\"</span><span class=\"p\">{(</span><span class=\"n\">_spineSettings</span><span class=\"p\">.</span><span class=\"n\">NrlsUseSecure</span> <span class=\"p\">?</span> <span class=\"n\">_spineSettings</span><span class=\"p\">.</span><span class=\"n\">NrlsSecureServerUrl</span> <span class=\"p\">:</span> <span class=\"n\">_spineSettings</span><span class=\"p\">.</span><span class=\"n\">NrlsServerUrl</span><span class=\"p\">)}</span><span class=\"s\">\"</span><span class=\"p\">,</span>\n        <span class=\"n\">ResourceId</span> <span class=\"p\">=</span> <span class=\"n\">resourceId</span><span class=\"p\">,</span>\n        <span class=\"n\">ResourceType</span> <span class=\"p\">=</span> <span class=\"n\">ResourceType</span><span class=\"p\">.</span><span class=\"n\">DocumentReference</span><span class=\"p\">,</span>\n        <span class=\"n\">SearchParams</span> <span class=\"p\">=</span> <span class=\"nf\">GetParams</span><span class=\"p\">(</span><span class=\"n\">nhsNumber</span><span class=\"p\">,</span> <span class=\"n\">custodianOrgCode</span><span class=\"p\">,</span> <span class=\"n\">resourceId</span><span class=\"p\">,</span> <span class=\"n\">typeCode</span><span class=\"p\">),</span>\n        <span class=\"n\">Method</span> <span class=\"p\">=</span> <span class=\"n\">method</span><span class=\"p\">,</span>\n        <span class=\"n\">Content</span> <span class=\"p\">=</span> <span class=\"n\">content</span><span class=\"p\">,</span>\n        <span class=\"n\">UseSecure</span> <span class=\"p\">=</span> <span class=\"n\">_spineSettings</span><span class=\"p\">.</span><span class=\"n\">NrlsUseSecure</span><span class=\"p\">,</span>\n        <span class=\"n\">ClientThumbprint</span> <span class=\"p\">=</span> <span class=\"nf\">ClientSettings</span><span class=\"p\">(</span><span class=\"n\">asid</span><span class=\"p\">)?.</span><span class=\"n\">Thumbprint</span><span class=\"p\">,</span>\n        <span class=\"n\">ServerThumbprint</span> <span class=\"p\">=</span> <span class=\"n\">_spineSettings</span><span class=\"p\">.</span><span class=\"n\">SpineThumbprint</span>\n    <span class=\"p\">};</span>\n\n    <span class=\"kt\">var</span> <span class=\"n\">jwt</span> <span class=\"p\">=</span> <span class=\"n\">JwtFactory</span><span class=\"p\">.</span><span class=\"nf\">Generate</span><span class=\"p\">(</span><span class=\"n\">method</span> <span class=\"p\">==</span> <span class=\"n\">HttpMethod</span><span class=\"p\">.</span><span class=\"n\">Get</span> <span class=\"p\">?</span> <span class=\"n\">JwtScopes</span><span class=\"p\">.</span><span class=\"n\">Read</span> <span class=\"p\">:</span> <span class=\"n\">JwtScopes</span><span class=\"p\">.</span><span class=\"n\">Write</span><span class=\"p\">,</span> <span class=\"n\">jwtOrgCode</span><span class=\"p\">,</span> <span class=\"s\">\"fakeRoleId\"</span><span class=\"p\">,</span> <span class=\"n\">asid</span><span class=\"p\">,</span> <span class=\"n\">command</span><span class=\"p\">.</span><span class=\"n\">FullUrl</span><span class=\"p\">.</span><span class=\"n\">AbsoluteUri</span><span class=\"p\">,</span> <span class=\"n\">SystemUrlBase</span><span class=\"p\">);</span>\n\n    <span class=\"n\">command</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">.</span><span class=\"nf\">Add</span><span class=\"p\">(</span><span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">Authorization</span><span class=\"p\">,</span> <span class=\"s\">$\"Bearer </span><span class=\"p\">{</span><span class=\"n\">jwt</span><span class=\"p\">}</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n    <span class=\"n\">command</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">.</span><span class=\"nf\">Add</span><span class=\"p\">(</span><span class=\"n\">FhirConstants</span><span class=\"p\">.</span><span class=\"n\">HeaderFromAsid</span><span class=\"p\">,</span> <span class=\"n\">asid</span><span class=\"p\">);</span>\n    <span class=\"n\">command</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">.</span><span class=\"nf\">Add</span><span class=\"p\">(</span><span class=\"n\">FhirConstants</span><span class=\"p\">.</span><span class=\"n\">HeaderToAsid</span><span class=\"p\">,</span> <span class=\"n\">_spineSettings</span><span class=\"p\">.</span><span class=\"n\">SpineAsid</span><span class=\"p\">);</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">command</span><span class=\"p\">;</span></code></pre></figure>\n\n</div>\n<p><br />\nOnce we have our command request model we call the FhirConnector service to start the actual call to the NRL.\nWe first build our HTTP message. At this point we also add in our NRL specific headers that are held in our base request model and add in our DocumentReference model (http content) if we are performing a create (POST).</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L115-L144\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L115-L144 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L115-L144\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L115-L144\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"k\">private</span> <span class=\"n\">HttpRequestMessage</span> <span class=\"nf\">GetMessage</span><span class=\"p\">(</span><span class=\"n\">CommandRequest</span> <span class=\"n\">request</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"kt\">var</span> <span class=\"n\">httpRequest</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">HttpRequestMessage</span><span class=\"p\">()</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">RequestUri</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">Uri</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">FullUrl</span><span class=\"p\">.</span><span class=\"n\">AbsoluteUri</span><span class=\"p\">),</span>\n        <span class=\"n\">Method</span> <span class=\"p\">=</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Method</span><span class=\"p\">,</span>\n        <span class=\"n\">Headers</span> <span class=\"p\">=</span>\n            <span class=\"p\">{</span>\n                <span class=\"p\">{</span> <span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">Accept</span><span class=\"p\">,</span> <span class=\"s\">$\"</span><span class=\"p\">{</span><span class=\"n\">ContentType</span><span class=\"p\">.</span><span class=\"n\">JSON_CONTENT_HEADER</span><span class=\"p\">}</span><span class=\"s\">\"</span><span class=\"p\">},</span>\n                <span class=\"p\">{</span> <span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">AcceptEncoding</span><span class=\"p\">,</span> <span class=\"s\">\"gzip, deflate\"</span> <span class=\"p\">},</span>\n                <span class=\"p\">{</span> <span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">AcceptLanguage</span><span class=\"p\">,</span> <span class=\"s\">\"en-GB,en\"</span> <span class=\"p\">},</span>\n                <span class=\"p\">{</span> <span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">CacheControl</span><span class=\"p\">,</span> <span class=\"s\">\"no-cache\"</span> <span class=\"p\">},</span>\n                <span class=\"p\">{</span> <span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">Connection</span><span class=\"p\">,</span> <span class=\"s\">\"Keep-Alive\"</span> <span class=\"p\">},</span>\n                <span class=\"p\">{</span> <span class=\"n\">HeaderNames</span><span class=\"p\">.</span><span class=\"n\">Host</span><span class=\"p\">,</span> <span class=\"s\">$\"</span><span class=\"p\">{</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">FullUrl</span><span class=\"p\">.</span><span class=\"n\">Host</span><span class=\"p\">}{(</span><span class=\"s\">\":\"</span> <span class=\"p\">+</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">FullUrl</span><span class=\"p\">.</span><span class=\"n\">Port</span> <span class=\"p\">??</span> <span class=\"s\">\"\"</span><span class=\"p\">)}</span><span class=\"s\">\"</span> <span class=\"p\">},</span>\n            <span class=\"p\">}</span>\n    <span class=\"p\">};</span>\n\n    <span class=\"c1\">//Add additional Spine Headers</span>\n    <span class=\"k\">foreach</span> <span class=\"p\">(</span><span class=\"kt\">var</span> <span class=\"n\">header</span> <span class=\"k\">in</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">httpRequest</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">.</span><span class=\"nf\">Add</span><span class=\"p\">(</span><span class=\"n\">header</span><span class=\"p\">.</span><span class=\"n\">Key</span><span class=\"p\">,</span> <span class=\"n\">header</span><span class=\"p\">.</span><span class=\"n\">Value</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Content</span> <span class=\"p\">!=</span> <span class=\"k\">null</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">httpRequest</span><span class=\"p\">.</span><span class=\"n\">Content</span> <span class=\"p\">=</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">Content</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">httpRequest</span><span class=\"p\">;</span>\n<span class=\"p\">}</span></code></pre></figure>\n\n</div>\n<p><br />\nThen we add in our certificate handling for mutual authentication:</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L100-L111\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L100-L111 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L100-L111\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L100-L111\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"p\">{</span>\n    <span class=\"kt\">var</span> <span class=\"n\">handler</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">HttpClientHandler</span><span class=\"p\">();</span>\n\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">UseSecure</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n        <span class=\"n\">handler</span><span class=\"p\">.</span><span class=\"n\">ClientCertificateOptions</span> <span class=\"p\">=</span> <span class=\"n\">ClientCertificateOption</span><span class=\"p\">.</span><span class=\"n\">Manual</span><span class=\"p\">;</span>\n        <span class=\"n\">handler</span><span class=\"p\">.</span><span class=\"n\">SslProtocols</span> <span class=\"p\">=</span> <span class=\"n\">SslProtocols</span><span class=\"p\">.</span><span class=\"n\">Tls12</span><span class=\"p\">;</span>\n        <span class=\"n\">handler</span><span class=\"p\">.</span><span class=\"n\">ClientCertificates</span><span class=\"p\">.</span><span class=\"nf\">Add</span><span class=\"p\">(</span><span class=\"nf\">ClientCertificate</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">ClientThumbprint</span><span class=\"p\">));</span>\n        <span class=\"n\">handler</span><span class=\"p\">.</span><span class=\"n\">ServerCertificateCustomValidationCallback</span> <span class=\"p\">=</span> <span class=\"p\">(</span><span class=\"n\">sender</span><span class=\"p\">,</span> <span class=\"n\">cert</span><span class=\"p\">,</span> <span class=\"n\">chain</span><span class=\"p\">,</span> <span class=\"n\">errors</span><span class=\"p\">)</span> <span class=\"p\">=&gt;</span> <span class=\"nf\">ValidateServer</span><span class=\"p\">(</span><span class=\"n\">sender</span><span class=\"p\">,</span> <span class=\"n\">cert</span><span class=\"p\">,</span> <span class=\"n\">chain</span><span class=\"p\">,</span> <span class=\"n\">errors</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">ServerThumbprint</span><span class=\"p\">);</span>\n        <span class=\"n\">handler</span><span class=\"p\">.</span><span class=\"n\">CheckCertificateRevocationList</span> <span class=\"p\">=</span> <span class=\"k\">false</span><span class=\"p\">;</span> <span class=\"c1\">//TODO: turn this on</span>\n    <span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<p><br />\nNext we make the call to the NRL API and then parse the response.\nHere we are expecting either a FHIR Bundle or a FHIR OperationOutcome both of which inherit from a FHIR Resource.\nThere is a check here to see if we have a success type HTTP response code. If not then we immediately raise an error.</p>\n\n<div class=\"github-sample-wrapper\">\n<div class=\"github-sample-reference\">\n  <div class=\"author-info\">\n    <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L48-L92\">This Github Sample</a> is by <a href=\"https://github.com/nhsconnect\">nhsconnect</a>\n  </div>\n  <div class=\"meta-info\">\n    Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L48-L92 <a href=\"https://github.com/nhsconnect/nrls-reference-implementation/blob/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L48-L92\">view</a> <a href=\"https://raw.githubusercontent.com/nhsconnect/nrls-reference-implementation/d6e952bd1ee53988bb8005b3a27f3fe16355b3ab/Demonstrator/Demonstrator.NRLSAdapter/Helpers/FhirConnector.cs#L48-L92\">raw</a>\n  </div>\n</div>\n\n<figure class=\"highlight\"><pre><code class=\"language-csharp\" data-lang=\"csharp\"><span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"kt\">var</span> <span class=\"n\">client</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">HttpClient</span><span class=\"p\">(</span><span class=\"n\">handler</span><span class=\"p\">))</span>\n<span class=\"p\">{</span>\n    <span class=\"kt\">var</span> <span class=\"n\">httpRequest</span> <span class=\"p\">=</span> <span class=\"nf\">GetMessage</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">);</span>\n\n    <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"n\">HttpResponseMessage</span> <span class=\"n\">res</span> <span class=\"p\">=</span> <span class=\"k\">await</span> <span class=\"n\">client</span><span class=\"p\">.</span><span class=\"nf\">SendAsync</span><span class=\"p\">(</span><span class=\"n\">httpRequest</span><span class=\"p\">))</span>\n    <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"n\">HttpContent</span> <span class=\"n\">content</span> <span class=\"p\">=</span> <span class=\"n\">res</span><span class=\"p\">.</span><span class=\"n\">Content</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n        <span class=\"c1\">//res.EnsureSuccessStatusCode(); //will throw a HttpRequestException to catch in future</span>\n\n        <span class=\"kt\">var</span> <span class=\"n\">data</span> <span class=\"p\">=</span> <span class=\"n\">content</span><span class=\"p\">.</span><span class=\"nf\">ReadAsStreamAsync</span><span class=\"p\">().</span><span class=\"n\">Result</span><span class=\"p\">;</span>\n\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"p\">==</span> <span class=\"k\">null</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"nf\">HttpRequestException</span><span class=\"p\">(</span><span class=\"s\">$\"Request resulted in nothing for: </span><span class=\"p\">{</span><span class=\"n\">request</span><span class=\"p\">.</span><span class=\"n\">FullUrl</span><span class=\"p\">}</span><span class=\"s\">.\"</span><span class=\"p\">);</span>\n        <span class=\"p\">}</span>\n\n        <span class=\"k\">if</span><span class=\"p\">(</span><span class=\"n\">res</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">?.</span><span class=\"n\">Location</span> <span class=\"p\">!=</span> <span class=\"k\">null</span><span class=\"p\">)</span>\n        <span class=\"p\">{</span>\n            <span class=\"n\">fhirResponse</span><span class=\"p\">.</span><span class=\"n\">ResponseLocation</span> <span class=\"p\">=</span> <span class=\"n\">res</span><span class=\"p\">.</span><span class=\"n\">Headers</span><span class=\"p\">.</span><span class=\"n\">Location</span><span class=\"p\">;</span>\n        <span class=\"p\">}</span>\n\n        <span class=\"k\">using</span> <span class=\"p\">(</span><span class=\"kt\">var</span> <span class=\"n\">reader</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">StreamReader</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">Encoding</span><span class=\"p\">.</span><span class=\"n\">UTF8</span><span class=\"p\">))</span>\n        <span class=\"p\">{</span>\n            <span class=\"k\">try</span>\n            <span class=\"p\">{</span>\n                <span class=\"kt\">var</span> <span class=\"n\">body</span> <span class=\"p\">=</span> <span class=\"n\">reader</span><span class=\"p\">.</span><span class=\"nf\">ReadToEnd</span><span class=\"p\">();</span>\n\n                <span class=\"k\">if</span><span class=\"p\">(!</span><span class=\"kt\">string</span><span class=\"p\">.</span><span class=\"nf\">IsNullOrEmpty</span><span class=\"p\">(</span><span class=\"n\">body</span><span class=\"p\">))</span>\n                <span class=\"p\">{</span>\n                    <span class=\"kt\">var</span> <span class=\"n\">jsonParser</span> <span class=\"p\">=</span> <span class=\"k\">new</span> <span class=\"nf\">FhirJsonParser</span><span class=\"p\">();</span>\n                    <span class=\"n\">fhirResponse</span><span class=\"p\">.</span><span class=\"n\">Resource</span> <span class=\"p\">=</span> <span class=\"n\">jsonParser</span><span class=\"p\">.</span><span class=\"n\">Parse</span><span class=\"p\">&lt;</span><span class=\"n\">Resource</span><span class=\"p\">&gt;(</span><span class=\"n\">body</span><span class=\"p\">);</span>\n                <span class=\"p\">}</span>\n\n                <span class=\"k\">if</span> <span class=\"p\">(!</span><span class=\"n\">res</span><span class=\"p\">.</span><span class=\"n\">IsSuccessStatusCode</span><span class=\"p\">)</span>\n                <span class=\"p\">{</span>\n                    <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"nf\">HttpRequestException</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nf\">FhirJsonSerializer</span><span class=\"p\">().</span><span class=\"nf\">SerializeToString</span><span class=\"p\">(</span><span class=\"n\">fhirResponse</span><span class=\"p\">.</span><span class=\"n\">GetResource</span><span class=\"p\">&lt;</span><span class=\"n\">OperationOutcome</span><span class=\"p\">&gt;()));</span>\n                <span class=\"p\">}</span>\n            <span class=\"p\">}</span>\n            <span class=\"k\">catch</span> <span class=\"p\">(</span><span class=\"n\">Exception</span> <span class=\"n\">ex</span><span class=\"p\">)</span>\n            <span class=\"p\">{</span>\n                <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"nf\">HttpRequestException</span><span class=\"p\">(</span><span class=\"n\">ex</span><span class=\"p\">.</span><span class=\"n\">Message</span><span class=\"p\">,</span> <span class=\"n\">ex</span><span class=\"p\">.</span><span class=\"n\">InnerException</span><span class=\"p\">);</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The code in these examples is standard C# v7.2 taken directly from the <a href=\"https://nrls.digital.nhs.uk\">NRL Demonstrator</a> code.<br /><br />The official <b><a href=\"https://ewoutkramer.github.io/fhir-net-api/\">.NET FHIR Library</a></b> is utilised to construct, test, parse, and serialize FHIR models with ease.</div>\n\n"
		
	}
	,

	{
		
		"title": "Security guidance",
		"tags": "developmentsecurityspine_secure_proxy",
		"keywords": "development",
		"url": "development_api_security_guidance.html",
		"summary": "Details of the API security model and supported protocols",
		"content": "<h2 id=\"overview\">Overview</h2>\n\n<p>Providers and Consumers are required to maintain a secure connection to the NRL and SSP.</p>\n\n<p>The technical requirements that support this are detailed below.</p>\n\n<h2 id=\"secure-socket-layer-ssl-and-transport-layer-security-tls-protocols\">Secure Socket Layer (SSL) and Transport Layer Security (TLS) Protocols</h2>\n\n<p>Following consultation with the Infrastructure Security, Operational Security, and Spine DDC teams, the following SSL protocols MUST be supported.</p>\n\n<ul>\n  <li>\n    <p>TLSv1.2</p>\n\n    <div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Protocol versions SSLv2, SSLv3, TLSv1.0, and TLSv1.1 are not supported and MUST NOT be used. All consumer and provider systems MUST be configured to implement the protocol version TLSv1.2.</div>\n  </li>\n</ul>\n\n<h2 id=\"supported-ciphers\">Supported Ciphers</h2>\n\n<p>Following consultation with the Infrastructure Security, Operational Security, and Spine DDC teams, the following ciphers MUST be supported.</p>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> The supported ciphers are listed in order of preference, from most to least preferred.</div>\n\n<ul>\n  <li><code class=\"highlighter-rouge\">ECDHE-RSA-AES256-GCM-SHA384</code></li>\n  <li><code class=\"highlighter-rouge\">ECDHE-RSA-AES128-GCM-SHA256</code></li>\n  <li><code class=\"highlighter-rouge\">DHE-RSA-AES256-GCM-SHA384</code></li>\n  <li><code class=\"highlighter-rouge\">DHE-RSA-AES128-GCM-SHA256</code></li>\n  <li><code class=\"highlighter-rouge\">ECDHE-RSA-AES256-SHA384</code></li>\n  <li><code class=\"highlighter-rouge\">DHE-RSA-AES256-SHA256</code></li>\n  <li><code class=\"highlighter-rouge\">DHE-RSA-AES256-SHA</code></li>\n  <li><code class=\"highlighter-rouge\">ECDHE-RSA-AES256-SHA</code></li>\n</ul>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> GCM (Galois Counter Mode) suites are prefered, as these <a href=\"https://www.digicert.com/ssl-support/ssl-enabling-perfect-forward-secrecy.htm\" target=\"_blank\">are resistant to timing attacks</a>.</div>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> A Java 8 (or above) Runtime Environment and/or an up-to-date version of OpenSSL is required to support the GCM cipher suites.</div>\n\n<h2 id=\"client-certificates-tlsma\">Client Certificates (TLSMA)</h2>\n\n<p>Provider and consumer systems MUST only accept client certificates issued by the NHS Digital Deployment Issue and Resolution (DIR) team.</p>\n\n<p>Provider and consumer systems MUST only accept client certificates with a valid Spine ‘chain of trust’ (that is, linked to the Spine SubCA and RootCA).</p>\n\n<p>Provider and consumer systems MUST only accept client certificates that have not expired or been revoked.</p>\n\n<p>Provider and consumer systems MUST verify that the <code class=\"highlighter-rouge\">FQDN</code> presented in the client certificate is that of the <a href=\"https://developer.nhs.uk/apis/spine-core-1-0/ssp_implementation_guide.html\">Spine Secure Proxy</a> (SSP).</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> For Providers and Consumers that have been issued with an FQDN and an X.509 certificate for NRL Pointer Search and/or Maintenance, these same assets may be re-used for the purpose of record retrieval.<br /><br />The NHS Digital Deployment Issue and Resolution (DIR) team will be able to confirm this at the point at which EndPoint registration is required.</div>\n\n<h2 id=\"external-documentspolicy-documents\">External Documents/Policy Documents</h2>\n\n<table>\n  <tbody>\n    <tr>\n      <td>Name</td>\n      <td>Author</td>\n      <td>Version</td>\n      <td>Updated</td>\n    </tr>\n    <tr>\n      <td><a href=\"http://webarchive.nationalarchives.gov.uk/20161021125701/http:/systems.digital.nhs.uk/infogov/security/infrasec/gpg/acs.pdf\">Approved Cryptographic Algorithms Good Practice Guidelines</a></td>\n      <td>NHS Digital</td>\n      <td>v4.0</td>\n      <td><time datetime=\"2016-07-13\">13 July 2016</time></td>\n    </tr>\n    <tr>\n      <td><a href=\"https://digital.nhs.uk/services/spine/spine-technical-information-warranted-environment-specification-wes\">Warranted Environment Specification (WES)</a></td>\n      <td>NHS Digital</td>\n      <td>v1.0</td>\n      <td><time datetime=\"2015-06\">June 2015</time></td>\n    </tr>\n  </tbody>\n</table>\n"
		
	}
	,

	{
		
		"title": "General API guidance",
		"tags": "fhirdevelopmentfor_providersfor_consumers",
		"keywords": "fhir development",
		"url": "development_general_api_guidance.html",
		"summary": "Implementation guidance for developers - focusing on general API implementation guidance",
		"content": "<h2 id=\"purpose\">Purpose</h2>\n\n<p>This implementation guide is intended for use by software developers looking to build a conformant NRL API interface using the FHIR® standard, with a focus on general API implementation guidance.</p>\n\n<h3 id=\"notational-conventions\">Notational Conventions</h3>\n\n<p>The keywords ‘<strong>MUST</strong>’, ‘<strong>MUST NOT</strong>’, ‘<strong>REQUIRED</strong>’, ‘<strong>SHALL</strong>’, ‘<strong>SHALL NOT</strong>’, ‘<strong>SHOULD</strong>’, ‘<strong>SHOULD NOT</strong>’, ‘<strong>RECOMMENDED</strong>’, ‘<strong>MAY</strong>’, and ‘<strong>OPTIONAL</strong>’ in this implementation guide are to be interpreted as described in <a href=\"https://www.ietf.org/rfc/rfc2119.txt\">RFC 2119</a>.</p>\n\n<h2 id=\"restful-api\">RESTful API</h2>\n\n<h3 id=\"content-types\">Content Types</h3>\n\n<ul>\n  <li>The NRL Server MUST support both formal <a href=\"https://www.hl7.org/fhir/STU3/http.html#mime-type\">MIME-types</a> for FHIR resources:\n    <ul>\n      <li>XML: <code class=\"highlighter-rouge\">application/fhir+xml</code></li>\n      <li>JSON: <code class=\"highlighter-rouge\">application/fhir+json</code></li>\n    </ul>\n  </li>\n  <li>The NRL Server MUST also support DSTU2 <a href=\"https://www.hl7.org/fhir/DSTU2/http.html#mime-type\">MIME-types</a> for backwards compatibility:\n    <ul>\n      <li>XML: <code class=\"highlighter-rouge\">application/xml+fhir</code></li>\n      <li>JSON: <code class=\"highlighter-rouge\">application/json+fhir</code></li>\n    </ul>\n  </li>\n  <li>The NRL Server MUST also gracefully handle generic XML and JSON MIME types:\n    <ul>\n      <li>XML: <code class=\"highlighter-rouge\">application/xml</code></li>\n      <li>JSON: <code class=\"highlighter-rouge\">application/json</code></li>\n      <li>JSON: <code class=\"highlighter-rouge\">text/json</code></li>\n    </ul>\n  </li>\n  <li>\n    <p>The NRL Server MUST support the optional <code class=\"highlighter-rouge\">_format</code> parameter in order to allow the client to specify the response format by its MIME type. If both are present, the <code class=\"highlighter-rouge\">_format</code> parameter overrides the <code class=\"highlighter-rouge\">Accept</code> header value in the request.</p>\n  </li>\n  <li>If neither the <code class=\"highlighter-rouge\">Accept</code> header nor the <code class=\"highlighter-rouge\">_format</code> parameter are supplied by the client system, the NRL Server MUST return data in the default format of <code class=\"highlighter-rouge\">application/fhir+xml</code>.</li>\n</ul>\n\n<h2 id=\"error-handling\">Error Handling</h2>\n\n<p>The NRL API defines many categories of errors, each of which encapsulates a specific part of the request sent to the NRL. Each type of error is discussed in its own section below with the relevant Spine response code:</p>\n<ul>\n  <li><a href=\"development_general_api_guidance.html#resource-not-found\">Resource not found</a> — Spine supports this behaviour when:\n    <ul>\n      <li>A request references a resource, such as a DocumentReference or Patient, that cannot be resolved.</li>\n      <li>A request supports an NHS Number where no Spine Clinicals record exists for that NHS Number.</li>\n    </ul>\n  </li>\n  <li><a href=\"development_general_api_guidance.html#headers\">Headers</a> — There are a number of HTTP headers that must be supplied with any request. In addition, values associated with those headers have their own validation rules.</li>\n  <li><a href=\"development_general_api_guidance.html#parameters\">Parameters</a> – Certain actions against the NRL allow a client to specify HTTP parameters. This class of error covers problems with the way those parameters are presented.</li>\n  <li><a href=\"development_general_api_guidance.html#payload-business-rules\">Payload business rules</a> — Errors of this nature will arise when the request payload (DocumentReference) does not conform to the business rules associated with its use as an NRL Pointer.</li>\n  <li><a href=\"development_general_api_guidance.html#payload-syntax\">Payload syntax</a> — Used to inform the client that the syntax of the request payload (DocumentReference) is invalid. For example, if using JSON to carry the DocumentReference, the structure of the payload may not conform to JSON notation.</li>\n  <li><a href=\"development_general_api_guidance.html#organisation-not-found\">Organisation not found</a> — Used to inform the client that the URL being used to reference a given Organisation is invalid.</li>\n  <li><a href=\"development_general_api_guidance.html#invalid-nhs-number\">Invalid NHS Number</a> — Used to inform a client that  NHS Number used in a Provider pointer create or Consumer search interaction is invalid.</li>\n  <li><a href=\"development_general_api_guidance.html#unsupported-media-type\">Unsupported Media Type</a> — Used to inform the client that requested content types are not supported by the NRL service.</li>\n  <li><a href=\"development_general_api_guidance.html#access-denied\">Access denied</a> — Used to inform the client that access to perform the interaction has been denied.</li>\n  <li><a href=\"development_general_api_guidance.html#internal-error\">Internal error</a> — Used to inform the client if there is a failure during the change of the DocumentReference status.</li>\n</ul>\n\n<p>The error codes (including other Spine error codes that are outside the scope of this API) are defined in the <a href=\"https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1\">Spine Error or Warning Code ValueSet</a>.</p>\n\n<h3 id=\"resource-not-found\">Resource Not Found</h3>\n\n<p>There are two situations when Spine supports this behaviour:</p>\n\n<ul>\n  <li>When a request references a resource that cannot be resolved. For example, this error should be expected when a request references the <a href=\"explore_reference.html#2-nrl-data-model-to-fhir-profile-mapping\">unique ID</a> of a DocumentReference, but the ID is not known to the NRL. There are three scenarios in which the NRL Service supports this exception:\n    <ul>\n      <li>Provider client retrieval of a DocumentReference by logical identifier</li>\n      <li>Provider client request to delete a DocumentReference by logical identifier or master identifier</li>\n      <li>Provider client request to update a DocumentReference by logical identifier or master identifier</li>\n    </ul>\n  </li>\n  <li>When a request specifies an NHS Number for which no corresponding Clinicals record exists in the Spine Clinicals data store. The NRL Service supports this exception scenario in the consumer and Provider Search API interface.</li>\n</ul>\n\n<p>The following table summarises the HTTP response codes, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for these exception scenarios.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>404</td>\n      <td>error</td>\n      <td>not-found</td>\n      <td>NO_RECORD_FOUND</td>\n      <td>No record found</td>\n      <td>No record found for supplied DocumentReference identifier - [id]</td>\n    </tr>\n    <tr>\n      <td>404</td>\n      <td>error</td>\n      <td>not-found</td>\n      <td>NO_RECORD_FOUND</td>\n      <td>No record found</td>\n      <td>The given NHS number could not be found [nhsNumber]</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"headers\">Headers</h3>\n\n<p>This error will be thrown in relation to the mandatory HTTP request headers. Scenarios where this error might be thrown:</p>\n<ul>\n  <li>\n    <p>The  mandatory <code class=\"highlighter-rouge\">fromASID</code> HTTP Header is missing in the request.</p>\n\n    <p>The table details the HTTP response code, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this scenario. Note that the header name is case-sensitive.</p>\n\n    <table>\n      <thead>\n        <tr>\n          <th>HTTP Code</th>\n          <th>issue-severity</th>\n          <th>issue-type</th>\n          <th>Details.Code</th>\n          <th>Details.Display</th>\n          <th>Diagnostics</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>400</td>\n          <td>error</td>\n          <td>invalid</td>\n          <td>MISSING_OR_INVALID_HEADER</td>\n          <td>There is a required header missing or invalid</td>\n          <td>fromASID HTTP Header is missing</td>\n        </tr>\n      </tbody>\n    </table>\n  </li>\n  <li>\n    <p>The mandatory <code class=\"highlighter-rouge\">toASID</code> HTTP Header is missing in the request</p>\n\n    <p>The table details the HTTP response code, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this scenario.</p>\n\n    <table>\n      <thead>\n        <tr>\n          <th>HTTP Code</th>\n          <th>issue-severity</th>\n          <th>issue-type</th>\n          <th>Details.Code</th>\n          <th>Details.Display</th>\n          <th>Diagnostics</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>400</td>\n          <td>error</td>\n          <td>invalid</td>\n          <td>MISSING_OR_INVALID_HEADER</td>\n          <td>There is a required header missing or invalid</td>\n          <td>toASID HTTP Header is missing</td>\n        </tr>\n      </tbody>\n    </table>\n  </li>\n  <li>\n    <p>The mandatory <code class=\"highlighter-rouge\">Authorization</code> HTTP Header is missing in the request</p>\n\n    <p>The table details the HTTP response code, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this scenario.</p>\n\n    <table>\n      <thead>\n        <tr>\n          <th>HTTP Code</th>\n          <th>issue-severity</th>\n          <th>issue-type</th>\n          <th>Details.Code</th>\n          <th>Details.Display</th>\n          <th>Diagnostics</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>400</td>\n          <td>error</td>\n          <td>invalid</td>\n          <td>MISSING_OR_INVALID_HEADER</td>\n          <td>There is a required header missing or invalid</td>\n          <td>Authorization HTTP Header is missing</td>\n        </tr>\n      </tbody>\n    </table>\n  </li>\n</ul>\n\n<h3 id=\"parameters\">Parameters</h3>\n\n<p>This error will be raised in relation to request parameters that the client may have specified. This error can be raised in a variety of circumstances.</p>\n\n<p>The following table summarises the HTTP response codes, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this exception scenario.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>invlid</td>\n      <td>INVALID_PARAMETER</td>\n      <td>Invalid parameter</td>\n    </tr>\n  </tbody>\n</table>\n\n<h4 id=\"subject-parameter\">Subject Parameter</h4>\n\n<p>When using the REQUIRED <code class=\"highlighter-rouge\">subject</code> parameter, the client is referring to a Patient FHIR resource by reference. Two pieces of information are needed:</p>\n<ul>\n  <li>\n    <p>The URL of the FHIR server that hosts the Patient resource.  If the URL of the server is not <code class=\"highlighter-rouge\">https://demographics.spineservices.nhs.uk/STU3/Patient/</code>, this error will be thrown.</p>\n  </li>\n  <li>\n    <p>An identifier for the Patient resource being referenced. The identifier must be known to the server. In addition, where NHS Digital owns the business identifier scheme for a given type of FHIR resource, the logical and business identifiers will be the same. In this case, the NHS number of a Patient resource is both a logical and business identifier, meaning that it can be specified without the need to supply the identifier scheme. If the NHS number is missing from the patient parameter, this error will be thrown.</p>\n  </li>\n</ul>\n\n<h4 id=\"custodian-parameter\">Custodian Parameter</h4>\n\n<p>When using the OPTIONAL <code class=\"highlighter-rouge\">custodian</code> parameter, the client is referring to an Organisation by a business identifier, specifically its ODS code. Two pieces of information are needed:</p>\n<ul>\n  <li>The business identifier scheme. In this case, it must be <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/ods-organization-code</code>.</li>\n  <li>The business identifier. The identifier must meet the following requirements:\n    <ul>\n      <li>It must be a valid ODS code.</li>\n      <li>The ODS code must be an organisation that is known to the NRL.</li>\n      <li>The ODS code must be in the Provider role.</li>\n    </ul>\n  </li>\n</ul>\n\n<h4 id=\"_format-request-parameter\"><code class=\"highlighter-rouge\">_format</code> Request Parameter</h4>\n\n<p>This parameter must specify one of the <a href=\"development_general_api_guidance.html#restful-api\">mime types</a> recognised by the NRL.</p>\n\n<h4 id=\"invalid-reference-url-in-pointer-create-request\">Invalid Reference URL in Pointer Create Request</h4>\n\n<p>This error is raised during a provider create interaction. There are two exception scenarios:</p>\n<ul>\n  <li>The DocumentReference in the request body specifies an incorrect URL for the FHIR server that hosts the Patient resource.</li>\n  <li>The DocumentReference in the request body specifies an incorrect URL for the author and custodian Organization resource.</li>\n</ul>\n\n<h4 id=\"type-parameter\"><code class=\"highlighter-rouge\">type</code> Parameter</h4>\n\n<p>When using the REQUIRED <code class=\"highlighter-rouge\">type</code> parameter, the client is referring to a pointer by record type. Two pieces of information are needed:</p>\n<ul>\n  <li>The identity of the <a href=\"http://snomed.info/sct\">SNOMED URI</a> terminology system</li>\n  <li>The pointer record type SNOMED concept, such as 736253002</li>\n</ul>\n\n<p>If the search request specifies unsupported parameter values in the request, this error will be thrown.</p>\n\n<h4 id=\"masteridentifier-parameter\"><code class=\"highlighter-rouge\">masterIdentifier</code> Parameter</h4>\n\n<p>Where masterIdentifier is a search term, both the system and value parameters must be supplied.</p>\n\n<h4 id=\"_summary-parameter\"><code class=\"highlighter-rouge\">_summary</code> Parameter</h4>\n\n<p>The _summary parameter must have a value of “count”. If it is anything else, an error should be returned to the client.</p>\n\n<p>If the _summary parameter is provided then the only other parameter that it can be used with is the optional _format param. If any other parameters are provided, an error should be returned to the client.</p>\n\n<h3 id=\"payload-business-rules\">Payload Business Rules</h3>\n\n<h4 id=\"invalid-resource\">Invalid Resource</h4>\n\n<p>This error code may surface when creating or deleting a DocumentReference. There are a number of properties that make up the DocumentReference which have business rules associated with them. If there are problems with one or more of these properties, this error may be thrown.</p>\n\n<p>This error code may also surface when updating a DocumentReference using the Parameters resource and Update interaction. This error may be thrown if the resource does not include the specified parameters or does not conform to the associated business rules.</p>\n\n<p>The following table summarises the HTTP response code, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this exception scenario.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>invalid</td>\n      <td>INVALID_RESOURCE</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Although not stated in the table above, the OperationOutcome that the NRL returns in these scenarios will include <code class=\"highlighter-rouge\">Details.display</code> and <code class=\"highlighter-rouge\">Diagnostics</code> detail, which will aid in identifying which property this issue relates to.</div>\n\n<h4 id=\"create-and-supersede-invalid-resource-errors\">Create and Supersede Invalid Resource Errors</h4>\n\n<p>The following scenarios relate to the <a href=\"api_interaction_create.html\">create</a> and <a href=\"api_interaction_supersede.html\">supersede</a> interactions (HTTP POST):</p>\n\n<ul>\n  <li>\n    <p><strong>Mandatory fields</strong></p>\n\n    <p>If one or more mandatory fields are missing, this error will be thrown. See <a href=\"explore_reference.html#2-nrl-data-model-to-fhir-profile-mapping\">DocumentReference</a> profile.</p>\n  </li>\n  <li>\n    <p><strong>Mandatory field values</strong></p>\n\n    <p>If one or more mandatory fields are missing values, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Custodian</strong></p>\n\n    <p>If the DocumentReference in the request body contains an ODS code on the custodian element that is not tied to the ASID supplied in the HTTP request header fromASID, this error will result.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Content.Attachment.Creation</strong></p>\n\n    <p>If this optional field is supplied, it must be a valid <a href=\"https://www.hl7.org/fhir/STU3/datatypes.html#dateTime\">FHIR dateTime</a></p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Status</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a status code that is not supported by the required HL7 FHIR <a href=\"http://hl7.org/fhir/ValueSet/document-reference-status\">document-reference-status</a> valueset, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Type</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a type that is not part of the valueset defined in the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1</a> FHIR profile, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Indexed</strong></p>\n\n    <p>If the DocumentReference in the request body specifies an indexed element that is not a valid <a href=\"http://hl7.org/fhir/STU3/datatypes.html#instant\">FHIR instant</a>, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Class</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a class that is not part of the valueset defined in the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1 FHIR profile</a>, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Content.Format</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a format that is not part of the valueset defined in the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1 FHIR profile</a>, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Content.Extension:RetrievalMode</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a retrievalMode that is not part of the valueset defined in the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1 FHIR profile</a>, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Context.PracticeSetting</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a practiceSetting that is not part of the valueset defined in the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1 FHIR profile</a>, this error will be thrown.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.Context.Period</strong></p>\n\n    <p>If the DocumentReference in the request body specifies a period:</p>\n    <ul>\n      <li>At least the start date must be populated and must be a valid <a href=\"https://www.hl7.org/fhir/STU3/datatypes.html#dateTime\">FHIR dateTime</a>.</li>\n      <li>If the end date is populated it must be a valid <a href=\"https://www.hl7.org/fhir/STU3/datatypes.html#dateTime\">FHIR dateTime</a>.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>DocumentReference.RelatesTo</strong></p>\n\n    <p>If multiple relatesTo elements are included in a create request, an error will be returned.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference.RelatesTo.Code</strong></p>\n\n    <p>If the code is not set to the value “replaces”, an error will be returned.</p>\n  </li>\n  <li>\n    <p><strong>Incorrect permissions to modify</strong></p>\n\n    <p>When the NRL resolves a DocumentReference through the relatesTo property before modifying its status, the NRL should check that the ODS code associated with the fromASID HTTP header is associated with the ODS code specified on the custodian property of the DocumentReference. If not, the NRL should roll back all changes and return an error.</p>\n  </li>\n  <li>\n    <p><strong>Patient mismatch</strong></p>\n\n    <p>When the NRL resolves a DocumentReference through the relatesTo property, the subject property reference value must match the subject property reference on the new DocumentReference being created. If not, the NRL should roll back all changes and return an error.</p>\n  </li>\n  <li>\n    <p><strong>MasterIdentifier mismatch</strong></p>\n\n    <p>When the NRL resolves a DocumentReference through the relatesTo property and both the <code class=\"highlighter-rouge\">relatesTo.target.identifier</code> and <code class=\"highlighter-rouge\">relatesTo.target.reference</code> properties are populated, the <code class=\"highlighter-rouge\">relatesTo.target.identifier</code> value must match the masterIdentifier property on the resolved DocumentReference. If not, the NRL should roll back all changes and return an error.</p>\n  </li>\n  <li>\n    <p><strong>DocumentReference does not exist</strong></p>\n\n    <p>If the NRL fails to resolve a DocumentReference through the relatesTo property, the NRL should roll back all changes and return an error.</p>\n  </li>\n</ul>\n\n<h4 id=\"update-invalid-resource-errors\">Update Invalid Resource Errors</h4>\n\n<p>The following scenarios relate to the <a href=\"api_interaction_update.html\">Update</a> interaction (HTTP PATCH):</p>\n\n<ul>\n  <li>\n    <p><strong>Parameters: Type</strong></p>\n\n    <p>When updating a DocumentReference, if the type parameter in the Parameters resource in the request body does not have the value “replace”, an error will be returned.</p>\n  </li>\n  <li>\n    <p><strong>Parameters: Path</strong></p>\n\n    <p>When updating a DocumentReference, if the path parameter in the Parameters resource in the request body does not have the value “DocumentReference.status”, an error will be returned.</p>\n  </li>\n  <li>\n    <p><strong>Parameters: Value</strong></p>\n\n    <p>When updating a DocumentReference, if the value parameter in the Parameters resource in the request body does not have the value “entered-in-error”, an error will be returned.</p>\n  </li>\n  <li>\n    <p><strong>Provider ODS Code does not match Custodian ODS Code</strong></p>\n\n    <p>If a provider update pointer request contains a URL that resolves to a single DocumentReference, but the custodian property does not match the ODS code associated to the ASID value in the fromASID header, an error will be returned.</p>\n  </li>\n</ul>\n\n<h4 id=\"delete-invalid-resource-errors\">Delete Invalid Resource Errors</h4>\n\n<p>The following scenarios relate to the <a href=\"api_interaction_delete.html\">Delete</a> interaction (HTTP DELETE):</p>\n\n<ul>\n  <li>\n    <p><strong>Provider ODS Code does not match Custodian ODS Code</strong></p>\n\n    <p>If a provider delete pointer request contains a URL that resolves to a single DocumentReference, but the custodian property does not match the ODS code associated to the ASID value in the fromASID header, an error will be returned.</p>\n  </li>\n</ul>\n\n<h4 id=\"duplicate-resource\">Duplicate Resource</h4>\n\n<p>When the NRL persists a DocumentReference with a masterIdentifier, it should ensure that no other DocumentReference exists \nfor that patient with the same masterIdentifier.</p>\n\n<p>The following table summarises the HTTP response code, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this exception scenario.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>duplicate</td>\n      <td>DUPLICATE_REJECTED</td>\n      <td>Duplicate DocumentReference</td>\n      <td>Duplicate masterIdentifier value: [masterIdentifier.value]<br />system: [masterIdentifier.system]</td>\n    </tr>\n  </tbody>\n</table>\n\n<h4 id=\"inactive-documentreference\">Inactive DocumentReference</h4>\n\n<p>This error is raised when the status of the DocumentReference to be retrieved or modified is not “current”.</p>\n\n<p>The following table summarises the HTTP response code, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this exception scenario.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>warning</td>\n      <td>invalid</td>\n      <td>BAD_REQUEST</td>\n      <td>Bad Request</td>\n      <td>DocumentReference status is not “current”</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"payload-syntax\">Payload Syntax</h3>\n\n<h4 id=\"invalid-request-message\">Invalid Request Message</h4>\n\n<p>The INVALID_REQUEST_MESSAGE error is triggered when there is an XML or JSON syntax error in the DocumentReference resource in the request payload.</p>\n\n<p>It is distinct from the INVALID_RESOURCE error, which conveys problems relating to the business rules associated with an NRL DocumentReference.</p>\n\n<p>The following table summarises the HTTP response codes, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this exception scenario.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>value</td>\n      <td>INVALID_REQUEST_MESSAGE</td>\n      <td>Invalid Request Message</td>\n      <td>Invalid Request Message</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"organisation-not-found\">Organisation Not Found</h3>\n\n<p>Organisations referenced in a DocumentReference must point to a resolvable FHIR Organisation resource. If the URL being used to reference a given Organisation is invalid, this error will result.</p>\n\n<p>The URL must have the format <code class=\"highlighter-rouge\">https://directory.spineservices.nhs.uk/STU3/Organization/[odsCode]</code>, where <code class=\"highlighter-rouge\">[odsCode]</code>:</p>\n<ul>\n  <li>Is a valid ODS code.</li>\n  <li>Refers to an organisation known to the NRL.</li>\n  <li>The ODS code associated with the custodian property must be in the Provider role.</li>\n</ul>\n\n<p>If an exception occurs, it should be displayed following the rules, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> shown in the following table.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>not-found</td>\n      <td>ORGANISATION_NOT_FOUND</td>\n      <td>Organisation record not found</td>\n      <td>The ODS code in the custodian and/or author element is not resolvable - [ods code].</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"invalid-nhs-number\">Invalid NHS Number</h3>\n<p>Used to inform a client that  NHS Number used in a provider pointer create or consumer search interaction is invalid.</p>\n\n<p>The following table summarises the HTTP response codes, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for this exception scenario.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>invalid</td>\n      <td>INVALID_NHS_NUMBER</td>\n      <td>Invalid NHS number</td>\n      <td>The NHS number does not conform to the NHS Number format: [nhs number].</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"unsupported-media-type\">Unsupported Media Type</h3>\n\n<p>There are three scenarios when an Unsupported Media Type business response code MUST be returned to a client:</p>\n<ul>\n  <li>Request contains an unsupported <code class=\"highlighter-rouge\">Accept</code> header and an unsupported <code class=\"highlighter-rouge\">_format</code> parameter.</li>\n  <li>Request contains a supported <code class=\"highlighter-rouge\">Accept</code> header and an unsupported <code class=\"highlighter-rouge\">_format</code> parameter.</li>\n  <li>Retrieval search query request parameters are valid, but the URL contains an unsupported <code class=\"highlighter-rouge\">_format</code> parameter value.</li>\n</ul>\n\n<p>These exceptions are raised by the Spine Core common requesthandler and not the NRL Service. They are supported by the default Spine OperationOutcome <a href=\"https://fhir.nhs.uk/StructureDefinition/spine-operationoutcome-1-0\">spine-operationoutcome-1-0</a> profile, which binds to the default Spine ValueSet <a href=\"https://fhir.nhs.uk/ValueSet/spine-response-code-1-0\">spine-response-code-1-0</a>. The following table summarises the HTTP response codes, along with the values to expect in the <code class=\"highlighter-rouge\">OperationOutcome</code> in the response body for these exception scenarios.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.System</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>415</td>\n      <td>error</td>\n      <td>invalid</td>\n      <td>http://fhir.nhs.net/ValueSet/spine-response-code-1-0</td>\n      <td>UNSUPPORTED_MEDIA_TYPE</td>\n      <td>Unsupported Media Type</td>\n      <td>Unsupported Media Type</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"internal-error\">Internal Error</h3>\n\n<p>Where the request cannot be processed, but the fault is with the NRL service and not the client, the NRL service will return a 500 HTTP response code, along with a descriptive message in the response body, such as:</p>\n\n<p><code class=\"highlighter-rouge\"><span class=\"nt\">&lt;html&gt;&lt;title&gt;</span>500: Internal Server Error<span class=\"nt\">&lt;/title&gt;&lt;body&gt;</span>500: Internal Server Error<span class=\"nt\">&lt;/body&gt;&lt;/html&gt;</span></code></p>\n"
		
	}
	,

	{
		
		"title": "Engage with NRL",
		"tags": "",
		"keywords": "engage careconnect process process introduction",
		"url": "engage.html",
		"summary": "These pages assist with requirements gathering and mapping stages of a FHIR&amp;reg; API development process.",
		"content": "<h2 id=\"approach-to-engagement\">Approach to Engagement</h2>\n\n<p>This process lays down steps of engagement with the client to analyse their business requirements for interoperability in a way that it supports mapping your requirements to FHIR® Profiles (that use HL7 FHIR® standards) and enable the development of a live API (Application Programming Interface) to read or exchange information/data.</p>\n\n<p>It has been cited that it is very difficult to exchange information between various business units in health care sector as most of them follow their own data structures to exchange information. This causes lot of interoperability issues and rework. Implementing this process gives us the opportunity to demonstrate and guide the business units as to how these issues can be resolved using standards- FHIR® (Fast Health Information Resources) and Profiles which are built to FHIR standards and agreed within the health and social care community. A standardised approach provides a common language for engagement and will more easily support a framework for sharing knowledge that can continue to assist future projects and possibly become self sustaining within the community.</p>\n\n<h2 id=\"business-benefit\">Business Benefit</h2>\n\n<p>This process will add business value by enabling businesses to easily exchange information in a common format as defined by FHIR® and Profiles which is easily understood by the rest of the organisation.</p>\n\n<h2 id=\"the-process\">The Process</h2>\n\n<p>The process is broken down into 15 discrete steps that are broadly organised onto three stages: Agree Business Requirements, Define the Solution, and Deliver the Solution.</p>\n\n<object style=\"width:100%;max-width: 100%;\" type=\"image/svg+xml\" data=\"images/engage/EngagementApproach.svg\">\n  <p style=\"text-align:center;\"><img src=\"images/engage/EngagementApproach.svg\" alt=\"Diagram showing the process stages for agreeing business requirements, then defining and delivering the solution\" title=\"Diagram showing the process stages for agreeing business requirements, then defining and delivering the solution\" style=\"width:100%;max-width: 100%;\" /></p>\n</object>\n\n<h3 id=\"agree-business-requirements\">Agree Business Requirements</h3>\n\n<table style=\"min-width:100%;width:100%\">\n<thead><tr id=\"step1\"><th style=\"width:3em;\"></th><th style=\"width:11em;\">Step</th><th>Description</th><th style=\"width:11em;\">Formal Output</th></tr></thead>\n<tr id=\"step2\"><td>1</td><td>Document Client's Context</td><td>Give a brief description of the client we are engaging with and what led them to the business need for interoperability.</td><td><ul style=\"padding-left:1em;padding-top:0\"><li style=\"margin:0;\">Short Textual Statement</li></ul></td></tr>\n<tr id=\"step3\"><td>2</td><td>Document Case Overview</td><td>Description of the client's business needs and expectations.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Short Textual Statement</li></ul></td></tr>\n<tr id=\"step4\"><td>3</td><td>Document Problem Statement</td><td>Describe the current interoperability issues.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Problem Statement Diagram</li></ul></td></tr>\n<tr id=\"step5\"><td>4</td><td>Identify Business Requirements</td><td>Visually represent the business case to confirm understanding of the problem with the client.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Business Process Model</li><li>Use Case Diagrams</li><li><a href=\"./engage_userstories.html\">User Stories</a></li></ul></td></tr>\n<tr><td>5</td><td>Identify Dataset</td><td>Given that the solution is likely to be implemented against existing systems it should be straightforward to identify which data items the client wants to send or receive between those systems. Get XML representation of the data structure if possible.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Data Set</li><li>Data Structure</li></ul></td></tr>\n</table>\n\n<h3 id=\"define-the-solution\">Define the Solution</h3>\n\n<table style=\"min-width:100%;width:100%\">\n<thead><tr id=\"step6\"><th style=\"width:3em;\"></th><th style=\"width:11em;\">Step</th><th>Description</th><th style=\"width:11em;\">Formal Output</th></tr></thead>\n<tr id=\"step7\"><td>6</td><td>Identify FHIR&reg; Resources</td><td>Identify which FHIR&reg; resources can be used to meet the requirement. Depending on project, exisiting Profiles may be used. An entity relationship diagram can help to describe the profiles.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Entity Relationship Diagram</li></ul></td></tr>\n<tr id=\"step8\"><td>7</td><td>Map Dataset</td><td>Map the dataset to the profile.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Dataset Mapping</li></ul></td></tr>\n<tr id=\"step9\"><td>8</td><td>Obtain Approval</td><td>Get Profile to Dataset Mapping reviewed and approved by the client.</td><td></td></tr>\n<tr id=\"step10\"><td>9</td><td>Design API</td><td>Define API Signatures and use of Search Parameters</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">API Signature</li><li>Search Parameters</li><li>Search Results</li></ul></td></tr>\n<tr id=\"step11\"><td>10</td><td>Document Interaction Flow</td><td>Define the sequence of interactions expected including the function, input parameters, output parameters etc.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">API Sequence Diagram</li></ul></td></tr>\n<tr id=\"step12\"><td>11</td><td>Document Additional Technical Context</td><td>Identify any further techincal considerations to aid understanding.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">System Diagrams</li><li>Acceptance Criteria</li></ul></td></tr>\n<tr><td>12</td><td>Resolve Requirements</td><td>Feedback any necessary changes to Profile definitions.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Update Standards</li></ul></td></tr>\n</table>\n\n<h3 id=\"deliver-the-solution\">Deliver the Solution</h3>\n\n<table style=\"min-width:100%;width:100%\">\n<thead><tr id=\"step13\"><th style=\"width:3em;\"></th><th style=\"width:11em;\">Step</th><th>Description</th><th style=\"width:11em;\">Formal Output</th></tr></thead>\n<tr id=\"step14\"><td>13</td><td>Present <a href=\"./engage_case_studies.html\">Case Study</a></td><td>Present final case study to stakeholders and include it into the implementation guide.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Presentation</li><li>Updated Implementation Guide</li></ul></td></tr>\n<tr id=\"step15\"><td>14</td><td>Implement Solution</td><td>Client implements solution, tests, and provides feedback.</td><td></td></tr>\n<tr><td>15</td><td>Learning</td><td>Identify failures and successes of the project.</td><td><ul style=\"padding-left:1em;\"><li style=\"margin:0;\">Plan to improve processes, preventing a repeat of failure and improving success rate.</li></ul></td></tr>\n</table>\n\n<!--<div markdown=\"span\" class=\"alert contribute contribute-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Contribute:</b> Get in touch with careconnect@interopen.org to help with Case Studies of NRL Profiles</div>-->\n"
		
	}
	,

	{
		
	}
	,

	{
		
		"title": "Introduction to NRL FHIR&amp;reg; API",
		"tags": "overview",
		"keywords": "homepage",
		"url": "index.html",
		"summary": "A brief introduction to getting started with the NRL FHIR&amp;reg; API.",
		"content": "<div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-exclamation-circle\"></i> <b>Warning:</b> This site is provided for information only and is intended for those engaged with NHS Digital on the development of the NRL API. It is advised not to develop against these specifications until a formal announcement has been made.</div>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The National Record Locator Service (NRLS) has been renamed to National Record Locator (NRL) following an issue raised with multiple national capabilities using the acronym NRLS. There may be instances of the acronym NRLS found within this specification associated to externally hosted examples and tools. These will be updated in due course.</div>\n\n<h1 id=\"introduction\">Introduction</h1>\n\n<p>Welcome to the National Record Locator Technical Specification landing page. This site will continue to be updated as we receive feedback, which we welcome from all within the clinical and non-clinical community.  To discuss any questions or queries you may have with the NRL team, feel free to email us at <a href=\"mailto:nrls@nhs.net\">nrls@nhs.net</a>. Thank you for your time!</p>\n\n<h1 id=\"background\">Background</h1>\n\n<p>There is currently no national solution for locating and sharing patient records across health and care systems. The National Record Locator (NRL) will enable an authorised clinician, care worker and/or administrator, in any health or care setting, to access a patient’s information to support that patient’s direct care. In turn, NRL will empower professionals, patients, and communities, strengthen primary, secondary, and acute care and introduce system efficiencies. This new national capability will aim to complement local digital initiatives (including Shared Care Records) and enhance the level of digital maturity across Health and Care. Phase 1 aims to demonstrate this capability, testing the concept of cross border interoperability and crucially enabling the power of local Shared Care Records (where they exist) to become woven into the NRL fabric from the outset.</p>\n\n<p>NHS Digital intends for the NRL to be accessible to all localities in 2019, opening up the possibility of achieving the ‘holy grail of interoperability’ in the months and years that follow. The NHS England Target Architecture also states that platforms moving forward will be expected to use common national services, standards, and governance processes to ensure national cohesion, including the NRL. More information can be found at <a href=\"https://www.england.nhs.uk/digitaltechnology/info-revolution/interoperability/\">the NHS England page on Interoperability</a>.</p>\n\n<p>In 2016, NHS Digital concluded a proof of concept project to test the implementation challenges of the NRL and to measure its potential service impact and benefits. A decision was made to continue with the development of the NRL in four key regions across the NHS identified for their digital maturity as outlined below. Working initially with urgent and emergency care, the NRL will enable cross border, cross organisation and cross sector interoperability. Our plan therefore is to integrate with:</p>\n\n<ul>\n  <li>North West, North East, Yorkshire, and London Ambulance Services and Mental Health Trusts</li>\n  <li>The Lancashire Patient Record Exchange Service</li>\n  <li>Cheshire Care Record</li>\n</ul>\n\n<p>Proving the success of such integrations in Phase 1 will allow all records held within local shared records to be accessible via NRL in Phase 2 and beyond.</p>\n\n<h1 id=\"phases\">Phases</h1>\n<h2 id=\"phase-one--alpha--beta-live-november-2018\">Phase One – Alpha / Beta (Live November 2018)</h2>\n<ul>\n  <li>4 Ambulance Trusts</li>\n  <li>5 Mental Health Trusts</li>\n  <li>Connection to Shared Care Record initiatives in Lancashire and Cheshire</li>\n  <li>Summary Care Record application (SCRa) as a national portal for accessing NRL</li>\n  <li>Access to pointers to Mental Health Crisis Plans</li>\n  <li>Sharing contact details for Mental Health Crisis Teams</li>\n  <li>Providing cross-border interoperability</li>\n</ul>\n\n<h2 id=\"phase-two--nhs-implementation\">Phase Two – NHS Implementation</h2>\n<ul>\n  <li>Secured retrieval of records and documents</li>\n  <li>Existing Mental Health Trusts to publish more pointers</li>\n  <li>Existing Ambulance Services to increase use of NRL</li>\n  <li>Onboarding new Ambulance Trusts</li>\n  <li>Onboarding new Mental Health Trusts</li>\n  <li>Working in partnership with Local Health Care Record Exemplars (LHCRE)</li>\n  <li>Integration with NHS Identity, enabling biometric authentication</li>\n  <li>Direct integration with Ambulance systems</li>\n  <li>An IG model to support national sharing</li>\n  <li>Pointers published for Healthy Child records</li>\n  <li>Pointers published for Maternity records</li>\n</ul>\n"
		
	}
	,

	{
		
		"title": "Access Tokens (JWT)",
		"tags": "integrationsecurityauthorisationspine_secure_proxy",
		"keywords": "spine ssp integration provenance",
		"url": "integration_access_tokens_JWT.html",
		"summary": "Access token required for interacting with the NRL and SSP.",
		"content": "<h2 id=\"access-tokens-jwt\">Access Tokens (JWT)</h2>\n\n<p>Clients MUST send an access token (<a href=\"overview_glossary.html#jwt\" data-toggle=\"tooltip\" title=\"JSON web token, a standard for access tokens containing information about authorisation claims.\">JWT</a>) with each request to the NRL or the SSP using the standard HTTP Authorization request header. The JWT MUST conform to the <a href=\"https://developer.nhs.uk/apis/spine-core/security_jwt.html\">Spine JWT</a> definition.</p>\n\n<p>The claims of the JWT are the same as those defined in the Spine Core JWT. However, the rules that govern the validation of those claims are different. From an NRL perspective, the rules defined here override rules defined for the Spine Core.</p>\n\n<p>Where a Spine Core rule is not explicitly replaced here, the Spine Core rule stands.</p>\n\n<h3 id=\"claims\">Claims</h3>\n\n<p>In the Spine JWT definition, the <code class=\"highlighter-rouge\">requesting_organisation</code> claim is marked as optional. However, this claim MUST be supplied for all NRL and SSP requests.</p>\n\n<h3 id=\"validation\">Validation</h3>\n\n<p>Depending upon the client’s role (Provider or Consumer) the validation that is applied to the JWT varies. The following section is broken down into three parts:</p>\n\n<ol>\n  <li>Common – validation that is common across Providers and Consumers</li>\n  <li>Provider – validation rules that only apply where the client is a Provider</li>\n  <li>Consumer – validation rules that only apply where the client is a Consumer</li>\n</ol>\n\n<h4 id=\"common-validation\">Common Validation</h4>\n\n<p>Where there has been a validation failure, the following response will be returned to the client. In all instances, the response will be the same. However, the diagnostics text will vary depending upon the nature of the error.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>HTTP Code</th>\n      <th>issue-severity</th>\n      <th>issue-type</th>\n      <th>Details.Code</th>\n      <th>Details.Display</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>400</td>\n      <td>error</td>\n      <td>structure</td>\n      <td>MISSING_OR_INVALID_HEADER</td>\n      <td>There is a required header that is missing or invalid</td>\n      <td><strong>Note:</strong> See <a href=\"integration_access_tokens_JWT.html#missing_or_invalid_header-exception-scenarios\">MISSING_OR_INVALID_HEADER Exception Scenarios</a></td>\n    </tr>\n  </tbody>\n</table>\n\n<h4 id=\"missing_or_invalid_header-exception-scenarios\">MISSING_OR_INVALID_HEADER Exception Scenarios:</h4>\n\n<p>Example 1: JWT missing – the Authorization header has not been supplied. The following response MUST be returned to the client.</p>\n\n<p><em>Diagnostics - The Authorisation header must be supplied</em></p>\n\n<!--\n| HTTP Code | issue-severity | issue-type | Details.Code | Details.Display | Diagnostics |\n|-----------|----------------|------------|--------------|-----------------|-------------------|\n|400|error|<font color=\"red\">structure</font> |MISSING_OR_INVALID_HEADER|There is a required header missing or invalid|The Authorisation header must be supplied|\n\nDiagnostics - The Authorisation header must be supplied-->\n\n<p>Example 2: JWT structure invalid – the Authorization header is present. However, the value is not a structurally valid JWT. In other words, one or more of the required elements of header, payload, and signature is missing.</p>\n\n<p><em>Diagnostics - The JWT associated with the Authorisation header must have all 3 sections</em></p>\n\n<!--\n| HTTP Code | issue-severity | issue-type | Details.Code | Details.Display | Diagnostics |\n|-----------|----------------|------------|--------------|-----------------|-------------------|\n|400|error|<font color=\"red\">structure</font> |MISSING_OR_INVALID_HEADER|There is a required header missing or invalid|The JWT associated with the Authorisation header must have the 3 sections|\n\nDiagnostics - The JWT associated with the Authorisation header must have the 3 sections -->\n\n<p>Example 3: Mandatory claim missing – the Authorization header is present and the JWT is structurally valid. However, one or more of the mandatory claims is missing from the JWT.</p>\n\n<p><em>Diagnostics - The mandatory claim [claim] from the JWT associated with the Authorisation header is missing</em></p>\n\n<!--\n| HTTP Code | issue-severity | issue-type | Details.Code | Details.Display | Diagnostics |\n|-----------|----------------|------------|--------------|-----------------|-------------------|\n|400|error|<font color=\"red\">structure</font> |MISSING_OR_INVALID_HEADER|There is a required header missing or invalid|The mandatory claim [claim] from the JWT associated with the Authorisation header is missing|\n\nDiagnostics - The mandatory claim [claim] from the JWT associated with the Authorisation header is missing -->\n\n<p>Example 4: Claim’s value is invalid — the Authorization header is present, the JWT is structurally valid, and a mandatory claim is present in the JWT, but its value is not valid. The following table shows the various checking that is applied to each claim in the JWT and the associated diagnostics message:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Claim being validated</th>\n      <th>Error scenario</th>\n      <th>Diagnostics</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">sub</code></td>\n      <td>No <code class=\"highlighter-rouge\">requesting_user</code> has been supplied and the sub claims’ value does not match the value of the <code class=\"highlighter-rouge\">requesting_system</code> claim.</td>\n      <td><code class=\"highlighter-rouge\">requesting_system</code> and <code class=\"highlighter-rouge\">sub</code> claim’s values must match.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">sub</code></td>\n      <td><code class=\"highlighter-rouge\">requesting_user</code> has been supplied and the sub claims’ value does not match the value of the <code class=\"highlighter-rouge\">requesting_user</code> claim.</td>\n      <td><code class=\"highlighter-rouge\">requesting_user</code> and <code class=\"highlighter-rouge\">sub</code> claim’s values must match.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">reason_for_request</code></td>\n      <td>Reason for request does not have the value “directcare”.</td>\n      <td><code class=\"highlighter-rouge\">reason_for_request</code> must be “directcare”.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">scope</code></td>\n      <td>For requests to the NRL: scope is not one of <code class=\"highlighter-rouge\">patient/DocumentReference.read</code> or <code class=\"highlighter-rouge\">patient/DocumentReference.write</code>.</td>\n      <td><code class=\"highlighter-rouge\">scope</code> must match either <code class=\"highlighter-rouge\">patient/DocumentReference.read</code> or <code class=\"highlighter-rouge\">patient/DocumentReference.write</code>.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">scope</code></td>\n      <td>For requests to the SSP: scope is not <code class=\"highlighter-rouge\">patient/*.read</code>.</td>\n      <td><code class=\"highlighter-rouge\">scope</code> must match <code class=\"highlighter-rouge\">patient/*.read</code>.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">requesting_system</code></td>\n      <td>Requesting system is not of the form <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/accredited-system/[ASID]</code>.</td>\n      <td><code class=\"highlighter-rouge\">requesting_system</code> must be of the form <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/accredited-system/[ASID]</code>.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">requesting_system</code></td>\n      <td><code class=\"highlighter-rouge\">requesting_system</code> is not an ASID that is known to Spine.</td>\n      <td>The ASID must be known to Spine.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">requesting_organisation</code></td>\n      <td><code class=\"highlighter-rouge\">requesting_organisation</code> is not of the form <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/ods-organization-code/[ODSCode]</code>.</td>\n      <td><code class=\"highlighter-rouge\">requesting_organisation</code> must be of the form <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/ods-organization-code/[ODSCode]</code>.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">requesting_organisation</code></td>\n      <td>The ODS code of the <code class=\"highlighter-rouge\">requesting_organisation</code> is not known to Spine.</td>\n      <td>The ODS code of the <code class=\"highlighter-rouge\">requesting_organisation</code> must be known to Spine.</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">requesting_organisation</code></td>\n      <td><code class=\"highlighter-rouge\">requesting_organisation</code> is not associated with the ASID from the <code class=\"highlighter-rouge\">requesting_system</code> claim.</td>\n      <td>The <code class=\"highlighter-rouge\">requesting_system</code> ASID must be associated with the <code class=\"highlighter-rouge\">requesting_organisation</code> ODS code.</td>\n    </tr>\n  </tbody>\n</table>\n\n<p><strong>Precedence of <code class=\"highlighter-rouge\">requesting_user</code> over <code class=\"highlighter-rouge\">requesting_system</code></strong></p>\n\n<p>If both the <code class=\"highlighter-rouge\">requesting_system</code> and <code class=\"highlighter-rouge\">requesting_user</code> claims have been provided, then the <code class=\"highlighter-rouge\">sub</code> claim MUST match the <code class=\"highlighter-rouge\">requesting_user</code> claim.</p>\n\n<h4 id=\"provider-validation\">Provider Validation</h4>\n\n<p>No specific validation rules apply.</p>\n\n<h4 id=\"consumer-validation\">Consumer Validation</h4>\n\n<p>In the context of a Consumer request, the <code class=\"highlighter-rouge\">requesting_user</code> claim is mandatory for all NRL and SSP requests.</p>\n\n<!--\nConsumer systems MUST provided audit and provenance details in the HTTP authorization header as an oAuth bearer token (as outlined in [RFC 6749](https://tools.ietf.org/html/rfc6749){:target=\"_blank\"}) in the form of a JSON Web Token (JWT) as defined in [RFC 7519](https://tools.ietf.org/html/rfc7519){:target=\"_blank\"}.\n\nAn example such an HTTP header is given below:\n\n```\n     Authorization: Bearer jwt_token_string\n```\n\nIn future, national authentication and authorisation services will be made available which will issue a bearer token which can be used directly for accessing this API. In the interrim however, the client will need to construct the JWT themselves.\n\nIt is highly recommended that standard libraries are used for creating the JWT as constructing and encoding the token manually may lead to issues with parsing the token in Spine. A good source of information about JWT and libraries to use can be found on the [JWT.io site](https://jwt.io/)\n\n### JSON Web Tokens (JWT)\n\nConsumer system MUST generate a new JWT for each API request. The Payload section of the JWT (see \"JWT Generation\" below for futher details) MUST be populated as follows:\n\n| Claim | Priority | Description | Fixed Value | Dynamic Value | Specification / Example |\n|-------|----------|-------------|-------------|---------------|-------------------------|\n| iss | R | Client systems issuer URI | No | Yes | |\n| sub | O | Identifier of individual making the request.| No | Yes | This field is conditionally mandatory. It must be supplied if the client is just a Consumer. However if the client is a Provider this field is optional. Note that if available the Provider should populate this field however in cases where no user is in scope then the sub can be left unpopulated. Where the sub is supplied it could be local system identifier for that user or if national Smartcard capability has been used then this will be the user’s UUID. |\n| device | R | Identifier (ASID) of system where request originates | No | Yes | |\n| aud | R | Requested resource URI | No | Yes | |\n| exp | R | Expiration time integer after which this authorization MUST be considered invalid. | No | (now + 5 minutes) UTC time in seconds | |\n| iat | R | The UTC time the JWT was created by the requesting system | `No| now UTC time in seconds | |\n-->\n<!--\n<div markdown=\"span\" class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> In topologies where consumer applications are provisioned via a portal or middleware hosted by another organisation (e.g. a 'mini service' provider) it is important for audit purposes that the practitioner and organisation populated in the JWT reflect the originating organisation rather than the hosting organisation.</div>\n-->\n<!--\n#### JWT Generation\nConsumer systems MUST generate the JSON Web Token (JWT) consisting of three parts seperated by dots (.), which are:\n\n- Header\n- Payload\n- Signature\n\nThe Spine does not currently validate the signature in the JWT that is sent, so the Consumer systems MAY generate an Unsecured JSON Web Token (JWT) using the \"none\" algorithm parameter in the header to indicate that no digital signature or MAC has been performed (please refer to section 6 of [RFC 7519](https://tools.ietf.org/html/rfc7519){:target=\"_blank\"} for details).\n\n```json\n{\n  \"alg\": \"none\",\n  \"typ\": \"JWT\"\n}\n```\n\nIf using unsigned tokens, the consumer systems MUST generate an empty signature.\n\nThe final output is three base64url encoded strings separated by dots (note - there is some canonicalisation done to the JSON before it is base64url encoded, which the JWT code libraries will do for you).\n\nFor example:\n\n```shell\neyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwOi8vZWMyLTU0LTE5NC0xMDktMTg0LmV1LXdlc3QtMS5jb21wdXRlLmFtYXpvbmF3cy5jb20vIy9zZWFyY2giLCJzdWIiOiIxIiwiYXVkIjoiaHR0cHM6Ly9hdXRob3JpemUuZmhpci5uaHMubmV0L3Rva2VuIiwiZXhwIjoxNDgxMjUyMjc1LCJpYXQiOjE0ODA5NTIyNzUsInJlYXNvbl9mb3JfcmVxdWVzdCI6ImRpcmVjdGNhcmUiLCJyZXF1ZXN0ZWRfcmVjb3JkIjp7InJlc291cmNlVHlwZSI6IlBhdGllbnQiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L0lkL25ocy1udW1iZXIiLCJ2YWx1ZSI6IjkwMDAwMDAwMzMifV19LCJyZXF1ZXN0ZWRfc2NvcGUiOiJwYXRpZW50LyoucmVhZCIsInJlcXVlc3RpbmdfZGV2aWNlIjp7InJlc291cmNlVHlwZSI6IkRldmljZSIsImlkIjoiMSIsImlkZW50aWZpZXIiOlt7InN5c3RlbSI6IldlYiBJbnRlcmZhY2UiLCJ2YWx1ZSI6IkdQIENvbm5lY3QgRGVtb25zdHJhdG9yIn1dLCJtb2RlbCI6IkRlbW9uc3RyYXRvciIsInZlcnNpb24iOiIxLjAifSwicmVxdWVzdGluZ19vcmdhbml6YXRpb24iOnsicmVzb3VyY2VUeXBlIjoiT3JnYW5pemF0aW9uIiwiaWQiOiIxIiwiaWRlbnRpZmllciI6W3sic3lzdGVtIjoiaHR0cDovL2ZoaXIubmhzLm5ldC9JZC9vZHMtb3JnYW5pemF0aW9uLWNvZGUiLCJ2YWx1ZSI6IltPRFNDb2RlXSJ9XSwibmFtZSI6IkdQIENvbm5lY3QgRGVtb25zdHJhdG9yIn0sInJlcXVlc3RpbmdfcHJhY3RpdGlvbmVyIjp7InJlc291cmNlVHlwZSI6IlByYWN0aXRpb25lciIsImlkIjoiMSIsImlkZW50aWZpZXIiOlt7InN5c3RlbSI6Imh0dHA6Ly9maGlyLm5ocy5uZXQvc2RzLXVzZXItaWQiLCJ2YWx1ZSI6IkcxMzU3OTEzNSJ9LHsic3lzdGVtIjoibG9jYWxTeXN0ZW0iLCJ2YWx1ZSI6IjEifV0sIm5hbWUiOnsiZmFtaWx5IjpbIkRlbW9uc3RyYXRvciJdLCJnaXZlbiI6WyJHUENvbm5lY3QiXSwicHJlZml4IjpbIk1yIl19fX0.\n```\n\nNOTE: As this is an unsigned token, the final section (the signature) is empty, so the JWT will end with a trailing . - this must not be omitted as it will then not be a valid token.\n\n<div markdown=\"span\" class=\"alert alert-success\" role=\"alert\"><i class=\"fa fa-check-square-o\"></i> <b>Tip:</b> The [JWT.io](https://jwt.io/) website includes a number of rich resources to aid in developing JWT enabled applications.</div>\n\n## Audit Trail\n\nThe various parts of an audit trail will be assembled from different parts of the request and in some cases will be calculated properties\n\n### Request Audit Trail\n_\"This [local user on this] (1) system (2) from this organisation (3) with this legitimate relationship (4) has sent this request (5) at this time (6)...\"_\n\n1.  local user - taken from the sub claim on the JWT which is sent under the mandatory Authorization HTTP header. Note that the sub claim may or may not be provided (see [JWT](integration_cross_organisation_audit_and_provenance.html#json-web-tokens-jwt) table above)\n2.  system - the ASID of the client system. Taken from the device claim on the [JWT](integration_cross_organisation_audit_and_provenance.html#json-web-tokens-jwt) which is sent under the mandatory Authorization HTTP header.\n3.  organisation - calculated by looking up the ODS code of the Organisation that is associated with the ASID (Ssp-From)\n4.  legitimate relationship - currently expected to be a fixed value of \"directcare\". No validation will be performed as to whether the given system and or organisation\nare valid in their use of direct care as the kind of relationship\n5.  request- the request URL, HTTP verb and the body of the request (in the case of a Provider's create and update actions)\n6.  time - the datetime that the request landed on the NRL web server\n\n### Response Audit Trail\n_\"...which resulted in this response (1) at this time (2)\"_\n\n1.  response - HTTP response code, response body (if present), Location header (for create and update)\n2.  time - the datetime that the NRL web server posted its response to the client\n\nFor more detail on the Audit capabilities of the NRL see [Auditing](overview_behaviours.html#auditing)\n-->\n"
		
	}
	,

	{
		
		"title": "Auditing",
		"tags": "integrationauditingfhirspine_secure_proxy",
		"keywords": "structured rest documentreference",
		"url": "integration_auditing.html",
		"summary": "Overview of audit and provenance requirements for data transported over NRL FHIR and SSP interfaces.",
		"content": "<h2 id=\"overview\">Overview</h2>\n\n<ul>\n  <li>Consumers and Providers are required to keep an audit trail of requests to and responses from the NRL API interfaces.</li>\n  <li>Consumers and Providers are required to keep an audit trail of requests and responses related to the retrieval of records and documents.</li>\n  <li>In addition, the NRL and SSP are required to keep an audit trail of requests and responses that flow through these services.</li>\n</ul>\n\n<h2 id=\"consumers\">Consumers</h2>\n\n<ul>\n  <li>Consumers MUST keep an audit trail of the requests to and responses from the NRL.</li>\n  <li>Consumers MUST keep an audit trail of the requests they make to retrieve a record or document from a Provider system.</li>\n  <li>Consumers MUST keep an audit trail of the responses they receive from a request to retrieve a record or document from a Provider system.</li>\n</ul>\n\n<p>Audit trails MUST include all details of the HTTP request, including all HTTP Header values.</p>\n\n<h2 id=\"providers\">Providers</h2>\n\n<ul>\n  <li>Providers MUST keep an audit trail of the requests to and responses from the NRL.</li>\n  <li>Providers MUST keep an audit trail of the requests they receive from Consumers to retrieve a record from their system.</li>\n  <li>Providers MUST keep an audit trail of the responses they send in response to requests they receive from Consumers to retrieve a record from their system.</li>\n</ul>\n\n<p>Audit trails MUST include all details of the HTTP request, including all HTTP Header values.</p>\n\n<p>It is not necessary for a Provider to keep an audit trail of the response payload returned to Consumers. However, Providers MUST be able to provide details of the record returned if required for medico-legal purposes.</p>\n\n<h2 id=\"ssp-trace-id\">SSP Trace ID</h2>\n\n<p>The SSP Trace ID is a unique identifier for a request that is generated by the Consumer and included in the SSP-TraceID HTTP Header for record retrieval requests. The SSP Trace ID is for the purpose of auditing and support.</p>\n\n<p>Consumers and Providers MUST audit this value to enable an end-to-end audit trail of a retrieval request and the associated response.</p>\n\n<h2 id=\"access-tokens-jwt\">Access Tokens (JWT)</h2>\n\n<p>Consumers and Providers MUST generate and supply a JWT access token with each request they initiate using the standard HTTP <code class=\"highlighter-rouge\">Authorization</code> header. Details of these requirements can be found on the <a href=\"integration_access_tokens_JWT.html\">Access Token</a> page.</p>\n\n<p>Any request to the NRL or SSP that does not supply an Authorization header conforming to these requirements will be rejected.</p>\n\n<h2 id=\"audit-logs\">Audit Logs</h2>\n\n<p>The following sections detail what information each actor (Consumer/Provider/NRL/SSP) MUST record in their audit logs. For details of each required attribute, see the <a href=\"#audit-log-attributes\">Audit Log Attribute table</a> below.</p>\n\n<h3 id=\"provider-pointer-maintenance\">Provider Pointer Maintenance</h3>\n\n<p>Providers MUST record the following in audit logs for each NRL maintenance interaction (POST, PATCH, DELETE).</p>\n\n<h4 id=\"for-requests-to-nrl\">For Requests to NRL</h4>\n\n<ul>\n  <li>ASID</li>\n  <li>HTTP Request Body (for POST and PATCH only)</li>\n  <li>HTTP Request URL</li>\n  <li>HTTP Verb</li>\n  <li>ODS Code</li>\n  <li>NHS Number</li>\n  <li>Request Datetime</li>\n  <li>User ID</li>\n</ul>\n\n<h4 id=\"for-responses-from-nrl\">For Responses from NRL</h4>\n\n<ul>\n  <li>HTTP Response Body</li>\n  <li>HTTP Status Code</li>\n  <li>Response Datetime</li>\n</ul>\n\n<h3 id=\"provider-documentrecord-retrieval\">Provider Document/Record Retrieval</h3>\n\n<p>Providers MUST record the following in audit logs for each record retrieval request from a Consumer via the SSP.</p>\n\n<h4 id=\"for-requests-from-consumers\">For Requests from Consumers</h4>\n\n<ul>\n  <li>ASID</li>\n  <li>HTTP Request URL</li>\n  <li>HTTP Status Code</li>\n  <li>ODS Code</li>\n  <li>Record version or equivalent</li>\n  <li>Request Datetime</li>\n  <li>Trace ID</li>\n  <li>User ID</li>\n</ul>\n\n<h3 id=\"consumer-pointer-searchread\">Consumer Pointer Search/Read</h3>\n\n<p>Consumers MUST record the following in audit logs for each NRL search interaction (GET).</p>\n\n<h4 id=\"for-requests-to-nrl-1\">For Requests to NRL</h4>\n\n<ul>\n  <li>ASID</li>\n  <li>HTTP Request URL</li>\n  <li>HTTP Verb</li>\n  <li>ODS Code</li>\n  <li>NHS Number</li>\n  <li>Request Datetime</li>\n  <li>User ID</li>\n</ul>\n\n<h4 id=\"for-responses-from-nrl-1\">For Responses from NRL</h4>\n\n<ul>\n  <li>HTTP Response Body</li>\n  <li>HTTP Status Code</li>\n  <li>Response Datetime</li>\n</ul>\n\n<h3 id=\"consumer-documentrecord-retrieval\">Consumer Document/Record Retrieval</h3>\n\n<p>Consumers MUST record the following in audit logs for each Document/Record retrieval request to a Provider via the SSP.</p>\n\n<h4 id=\"for-requests-to-providers\">For Requests to Providers</h4>\n\n<ul>\n  <li>ASID</li>\n  <li>HTTP Request URL</li>\n  <li>NHS Number</li>\n  <li>ODS Code</li>\n  <li>Pointer Logical ID</li>\n  <li>Request Datetime</li>\n  <li>Trace ID</li>\n  <li>User ID</li>\n</ul>\n\n<h4 id=\"for-responses-from-providers\">For Responses from Providers</h4>\n\n<ul>\n  <li>HTTP Response Body (if the request failed)</li>\n  <li>HTTP Status Code</li>\n  <li>Response Datetime</li>\n</ul>\n\n<h3 id=\"audit-log-attributes\">Audit Log Attributes</h3>\n\n<p>The following table details the audit log attributes and the source of the value for the attribute.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Attribute</th>\n      <th>Source</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>ASID</td>\n      <td><code class=\"highlighter-rouge\">requesting_system</code> from JWT. Only the ASID portion is required, for example, <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/accredited-system\\|[ASID]</code></td>\n    </tr>\n    <tr>\n      <td>HTTP Request Body</td>\n      <td>HTTP Request Body (where applicable, i.e. POST or PATCH)</td>\n    </tr>\n    <tr>\n      <td>HTTP Request URL</td>\n      <td>For example, URL of the NRL service that was called, or the URL used for the record retrieval request, which includes the value of the <code class=\"highlighter-rouge\">content.attachment.url</code> property defined on the associated NRL pointer.</td>\n    </tr>\n    <tr>\n      <td>HTTP Response Body</td>\n      <td>Response message</td>\n    </tr>\n    <tr>\n      <td>HTTP Status Code</td>\n      <td>Describes the response outcome (Success: 2xx | Fail: 4xx or 5xx)</td>\n    </tr>\n    <tr>\n      <td>HTTP Verb</td>\n      <td>POST, PATCH, GET or DELETE</td>\n    </tr>\n    <tr>\n      <td>NHS Number</td>\n      <td>This is the value used as part of the pointer subject reference (for example, <code class=\"highlighter-rouge\">https://demographics.spineservices.nhs.uk/STU3/Patient/[NHS_Number]</code>) which may be an attribute on the pointer or a search query parameter depending on the action being performed.</td>\n    </tr>\n    <tr>\n      <td>ODS Code</td>\n      <td><code class=\"highlighter-rouge\">requesting_organization</code> from JWT. Only the ODSCode portion is required, for example, <code class=\"highlighter-rouge\">https://fhir.nhs.uk/Id/ods-organization-code\\|[ODSCode]</code></td>\n    </tr>\n    <tr>\n      <td>Pointer Logical ID</td>\n      <td>The Logical ID of the pointer (generated by the NRL) from which the retrieval request has been made</td>\n    </tr>\n    <tr>\n      <td>Record version or equivalent</td>\n      <td>Reference to the version ID (or equivalent) from which the NRL Provider can identity what version of a record was provided</td>\n    </tr>\n    <tr>\n      <td>Request Datetime</td>\n      <td>Datetime that audit log was written</td>\n    </tr>\n    <tr>\n      <td>Response Datetime</td>\n      <td>Datetime that the response was received from NHS Digital service (NRL or SSP)</td>\n    </tr>\n    <tr>\n      <td>Trace ID</td>\n      <td>The Consumer-generated ID of the retrieval request. This is only used for requests via the SSP and is for use in the Ssp-TraceID HTTP Request Header.</td>\n    </tr>\n    <tr>\n      <td>User ID</td>\n      <td><code class=\"highlighter-rouge\">requesting_user</code> from JWT. This will be ‘NotProvided’ if <code class=\"highlighter-rouge\">requesting_user</code> isn’t available in the JWT.<br />This is not mandatory where the request is completed as a non-interactive process.</td>\n    </tr>\n  </tbody>\n</table>\n"
		
	}
	,

	{
		
		"title": "Authentication and Authorisation",
		"tags": "integrationsecurityauthenticationauthorisationspine_secure_proxy",
		"keywords": "spine security",
		"url": "integration_authentication_authorisation.html",
		"summary": "Authentication and Authorisation",
		"content": "<h2 id=\"introduction\">Introduction</h2>\n\n<p>The NRL and SSP NHS Digital Spine services are subject to various access restrictions. The <a href=\"development_api_security_guidance.html\">security</a> section outlines the need for any client to be able to take part in a mutual authentication session at the transport layer. This will protect traffic flowing between client and server and, to some extent, gives the NHS Digital SPINE services confidence in the identity of the client system. However, this transport-layer security does not address authorisation. Additionally, the level of granularity in terms of establishing identity stops at the system level.</p>\n\n<p>Consumers and Providers are required to ensure the correct level of authentication and authorisation is applied to their systems and user access when interacting with NHS Digital SPINE services.</p>\n\n<h2 id=\"authentication\">Authentication</h2>\n\n<p>Clients are required to authenticate and authorise users, using a mechanism that conforms to the level-3 authentication and RBAC control requirements.</p>\n\n<p>Clients are required to apply appropriate RBAC control to manage access to different types of Pointers and their referenced records.</p>\n\n<p>This level of control can be achieved and verified through integration with the <a href=\"https://digital.nhs.uk/services/registration-authorities-and-smartcards/care-identity-service\">Care Identity Service (CIS)</a>, which will become <a href=\"https://digital.nhs.uk/services/nhs-identity/guidance-for-developers/an-introduction-to-nhs-identity\">NHS Identity</a>. As well as providing support for existing smartcard-based mechanisms, NHS Identity will provide an array of other authentication types. Consumers will need to integrate with CIS or NHS Identity to access the NRL and the SSP.</p>\n\n<p>Please see the <a href=\"explore_rbac_mapping.html\">NRL RBAC mapping table</a> for details on the mappings between RBAC codes and Pointer types.</p>\n\n<h2 id=\"authorisation\">Authorisation</h2>\n\n<p>The NRL and SSP use the well-established ASID + interactionId approach to control access to these services. Each RESTful endpoint is associated with a unique interactionId. Each system accredited by NHS Digital as a Consumer or Provider will be issued with an ASID and assigned a set of interactions that it has been authorised to perform. These interactions are mapped to interactionIds. Each ASID is associated with a set of interactionIds. It is this combination of interactionIds that govern which RESTful endpoints a particular system can interact with.</p>\n"
		
	}
	,

	{
		
		"title": "Personal Demographics Service",
		"tags": "integration",
		"keywords": "spine pds integration patient, demographics",
		"url": "integration_personal_demographics_service.html",
		"summary": "Overview of the role of the Personal Demographics Services (PDS) and the Spine Mini Services PDS (SMSP) within NRL.",
		"content": "<h2 id=\"pds-tracing\">PDS Tracing</h2>\n\n<p>NRL systems MUST be capable of performing <a href=\"https://digital.nhs.uk/services/demographics\" target=\"_blank\">Personal Demographics Service</a> (PDS) tracing of patients to obtain their NHS Number.</p>\n\n<p>Systems MUST perform this tracing using one of the following three options:</p>\n\n<h3 id=\"1-full-pds-spine-compliant-system-pds\">1. Full PDS Spine Compliant System (PDS)</h3>\n\n<p>NRL systems MAY follow the guiding principles of <a href=\"http://webarchive.nationalarchives.gov.uk/20160921135209/http://systems.digital.nhs.uk/demographics/spineconnect\">how systems should integrate with PDS</a>. This describes in particular the principles governing how systems should synchronise with PDS as the master repository of demographics data to ensure local system data does not become stale.</p>\n\n<p>There is a very limited risk that the consumer-traced NHS number pre-dates a patient record status change to sensitive Flag (S-Flag) immediately prior to use.</p>\n\n<h3 id=\"2-spine-mini-service-pds-smsp\">2. Spine Mini Service PDS (SMSP)</h3>\n\n<p>NRL systems MAY utilise the <a href=\"https://developer.nhs.uk/library/systems/nhs-digital-smsp-pds/\" target=\"_blank\">Spine Mini Service Provider for PDS</a> (SMSP) as a lighter weight alternative to integrating with the full Spine Personal Demographics Service (PDS).</p>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> As the SMSP service does not return multiple possible matches for the patient it is typically only suitable to be used where there is enough information to achieve a single matched trace.</div>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> SMSP responses do not include trace sequence number information. The presence of a trace sequence number in a consumer request to NRL could enable providers to programmatically determine the need to perform a PDS trace themselves, for example if their local patient record’s trace was not current.</div>\n\n<h3 id=\"3-demographics-batch-service-dbs\">3. Demographics Batch Service (DBS)</h3>\n\n<p>NRL Provider systems MAY utilise the <a href=\"http://developer.nhs.uk/library/systems/demographic-batch-service-dbs/\" target=\"_blank\">Demographics Batch Service (DBS)</a> to perform batch PDS Tracing.</p>\n\n<p>The suitability of the use of DBS to perform batch PDS tracing would be assessed as part of the Consumer Accreditation process.</p>\n\n<p>This option is for Provider systems only. Consumers performing a search operation MUST use either option 1 or 2 as described above.</p>\n"
		
	}
	,

	{
		
		"title": "Scroll layout",
		"tags": "special_layouts",
		"keywords": "json scrolling scrollto jquery plugin",
		"url": "jsmydoc_scroll.html",
		"summary": "This page demonstrates how you the integration of a script called ScrollTo, which is used here to link definitions of a JSON code sample to a list of definitions for that particular term. The scenario here is that the JSON blocks are really long, with extensive nesting and subnesting, which makes it difficult for tables below the JSON to adequately explain the term in a usable way.",
		"content": "\n\n\n <script src=\"../js/jquery.scrollTo.min.js\"></script>\n    <!-- local scroll must come after scrollTo, because localScroll is based on scrollTo, which is based on jQuery -->\n<script src=\"../js/jquery.localScroll.min.js\"></script>\n\n<script>\n\n$( document ).ready(function() {\n$('#small-box-links').localScroll({\n           target:'#definition-box-container',\n           showSpeed: 1000,\n           hash: true,\n           easing: 'swing',\n           onAfter:function(){\n          $(\"#definition-box-container div a\").addClass(\"active\");\n          $(\"#definition-box-container div a\").removeClass(\"active\");\n          $(\"#definition-box-container div\").removeClass(\"active\");\n           $(window.location.hash).addClass(\"active\");\n  }\n});\n\n\n});\n</script>\n\n<!-- documentation for localScroll function: http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html -->\n    <style type=\"text/css\">\n \n   #definition-box-container {\n        border: 0px solid #dedede;\n        border-radius: 4px;\n        max-height: 500px;\n        overflow: scroll;\n        padding-left:5px;\n        border-radius:5px;\n    }\n\n    #json-box-container {\n\n      border: 1px solid #dedede;\n      border-radius: 4px;\n      max-height:500px;\n      overflow: scroll;\n    }\n\n    #small-box-links {\n      float: left;\n    }\n\n    #definition-box-container .active {\n     background-color: #FFFBCC;\n    }\n    \n    div#definition-box-container div {\n      padding: 10px;\n}\n\n    @media (min-height: 700px)  {\n       #json-box-container {\n           max-height:500px;\n         }\n           #definition-box-container  {\n          max-height: 500px;\n  }\n    }\n\n     @media (min-height: 800px)  {\n       #json-box-container {\n           max-height:600px;\n    }\n        #definition-box-container  {\n          max-height: 600px;\n  }\n  }\n\n    @media (min-height: 900px)  {\n       #json-box-container {\n           max-height:700px;\n    }\n        #definition-box-container  {\n          max-height: 700px;\n  }\n  }\n\n     @media (min-height: 1000px)  {\n       #json-box-container {\n           max-height:800px;\n    }\n        #definition-box-container  {\n          max-height: 800px;\n  }\n  }\n\n    @media (min-height: 1100px)  {\n       #json-box-container {\n           max-height:900px;\n    }\n        #definition-box-container  {\n          max-height: 900px;\n  }\n  }\n\n\n    </style>\n\n\n<div class=\"container\">\n<div class=\"row\">\n \n<div id=\"small-box-links\">\n\n<div class=\"col-md-6\">\n<div id=\"json-box-container\">\n<pre>\n{\n  <a href=\"#apples\">\"apples\"</a>: \"red fruit at the store\",\n  <a href=\"#bananas\">\"bananas\"</a>: \"yellow bananas in a bunch\",\n  <a href=\"#carrots\">\"carrots\"</a>: \"orange vegetables that grow in the ground\",\n  <a href=\"#dingbats\">\"dingbats\"</a>: \"a type of character symbol on a computer\",\n  <a href=\"#eggs\">\"eggs\"</a>: \"chickens lay them, and people eat them\",\n  <a href=\"#falafel\">\"falafel\"</a>: \"a Mediterranean sandwich consisting of lots of different stuff i don't know much about\",\n  <a href=\"#giraffe\">\"giraffe\"</a>: \"tall animal, has purple tongue\",\n  <a href=\"#hippo\">\"hippo\"</a>: \"surprisingly dangerous amphibian\",\n  <a href=\"#igloo\">\"igloo\"</a>: \"an ice shelter made by eskimos\",\n  <a href=\"#jeep\">\"jeep</a>: \"the only car that starts with a j\",\n  <a href=\"#kilt\">\"kilt\"</a>: \"something worn by scottish people, not a dress\",\n  <a href=\"#lamp\">\"lamp\"</a>: \"you use it to read by your bedside at night\"\n  <a href=\"#manifold\">\"manifold\"</a>: \"an intake mechanism on a car, like a valve, i think\",\n  <a href=\"#octopus\">\"octopus\"</a>: \"eight tentacles, shoots ink, lives in dark caves, very mysterious\",\n  <a href=\"#paranoia\">\"paranoia\"</a>: \"the constant feeling that others are out to get you, conspiring against your success\",\n  <a href=\"#qui\">\"qui\"</a>: \"a life force that runs through your body\",\n  <a href=\"#radical\">\"radical\"</a>: \"someone who opposes the status quo in major ways\",\n  <a href=\"#silly\">\"silly\"</a>: \"how I feel writing this dummy copy\",\n  <a href=\"#taffy\">\"taffy\"</a>: \"the sweets children like the most and dentists hate the worst\",\n  <a href=\"#umbrella\">\"umbrella\"</a>: \"an invention that has not had any advancements in 200 years\",\n  <a href=\"#vampire\">\"vampire\"</a>: \"a paranormal figure that is surprisingly in vogue despite its basic nature\",\n  <a href=\"#washington\">\"washington\"</a>: \"the place where tom was born\",\n  <a href=\"#xylophone\">\"xylophone\"</a>: \"some kind of pinging instrument used to sound chime-like notes\",\n  <a href=\"#yahoo\">\"yahoo\"</a>: \"an expression of exuberance, said under breath when something works right\",\n  <a href=\"#zeta\">\"zeta\"</a>: \"the way british people pronounce z\",\n  <a href=\"#alpha\">\"alpha\"</a>: \"the original letter of the alphabet, which has since come to mean the first. however, i think the original symbol of alpha is actually an ox. it is somewhat of a mystery to linquists as to the exact origin of the letter alpha, but it basically represents the dawn of the alphabet, which proved to be a huge step forward for human thought and expression.\",\n  <a href=\"#beta\">\"beta\"</a>: \"the period of time when something is finished but undergoing testing by a group of people.\",\n  <a href=\"#cappa\">\"cappa\"</a>: \"how italians refer to their baseball caps\",\n  <a href=\"#dunno\">\"dunno\"</a>: \"informal expression for 'don't know'\"\n  }\n      \n</pre>\n\n</div><!-- end json-box-container-->\n</div> <!-- end col-md-6-->\n\n<div class=\"col-md-3\">\n\n<div id=\"definition-box-container\">\n\n\n    <div id=\"apples\"><h5>apples</h5>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer magna massa, euismod sed rutrum at, ullamcorper quis tellus. Vestibulum erat purus, aliquet sit amet pellentesque eget, tempus at ante. Nulla justo nisi, elementum nec nisi eget, consectetur varius tortor. </div>\n\n    <div id=\"bananas\"><h5>bananas</h5>Curabitur quis nibh sed eros viverra tempus et quis lorem. Nulla convallis sit amet risus vitae rutrum. Nulla at faucibus lectus. Pellentesque tortor nisl, interdum ac quam non, egestas congue massa. Vestibulum non porttitor lacus. Nam tincidunt arcu lectus. Donec eget ornare neque, hendrerit ornare lectus. In ac pretium odio.</div>\n\n    <div id=\"carrots\"><h5>carrots</h5>Vivamus pulvinar vestibulum pharetra. Vivamus vitae diam iaculis, posuere mi sed, dignissim massa. Nunc vitae aliquet urna. Proin sed pulvinar ex. Maecenas nisl lorem, rutrum sit amet hendrerit sed, posuere at odio. Sed consectetur semper tristique. Vivamus finibus varius felis at convallis. Fusce in dictum nunc.</div>\n\n    <div id=\"dingbats\"><h5>dingbats</h5>Curabitur feugiat lorem eget elit ullamcorper tincidunt. In euismod diam aliquet tortor fermentum tempor. Fusce quam felis, commodo viverra orci vitae, scelerisque aliquet risus. </div>\n\n    <div id=\"eggs\"><h5>eggs</h5>Duis est nunc, fringilla eu ligula et, varius dignissim dui. Vivamus in tellus vitae ipsum vehicula fermentum at congue tellus. Suspendisse fermentum, magna vitae aliquet sodales, tellus nisi rutrum arcu, vitae auctor dolor quam ac tellus. Cras posuere augue erat, in sagittis quam lacinia id.</div>\n\n    <div id=\"falafel\"><h5>falafel</h5>Praesent auctor a enim non lacinia. Integer sodales aliquet mi vel dapibus. Donec consequat justo eget nisi lacinia, eu sodales ligula molestie. Sed sapien nulla, rhoncus at elementum a, </div>\n\n    <div id=\"giraffe\"><h5>giraffe</h5>Nullam venenatis at lectus sed pharetra. Sed hendrerit ligula lectus, non pellentesque diam faucibus sit amet. Aliquam dictum hendrerit pellentesque. Cras eu nisl sagittis, faucibus velit sit amet, sagittis odio. Donec vulputate ex vitae purus</div>\n\n    <div id=\"hippo\"><h5>hippo</h5>Cras nec pretium nulla. Suspendisse tempus tortor vel venenatis pulvinar. Integer varius tempor enim fringilla tincidunt. Phasellus magna turpis, auctor vitae elit eget, fringilla pellentesque est. Phasellus ut porta risus. Curabitur iaculis sapien sed venenatis auctor. Integer eu orci at lectus eleifend auctor id rutrum urna.</div>\n\n    <div id=\"igloo\"><h5>igloo</h5>Suspendisse tempus tortor vel venenatis pulvinar. Integer varius tempor enim fringilla tincidunt. Phasellus magna turpis, auctor vitae elit eget, fringilla pellentesque est. Phasellus ut porta risus.  </div>\n\n    <div id=\"jeep\"><h5>jeep</h5>Nulla vitae metus rutrum, condimentum orci nec, maximus est. Aenean sit amet ante nec elit dignissim faucibus eget quis quam. </div>\n\n    <div id=\"kilt\"><h5>kilt</h5>Morbi maximus, erat vel rhoncus sagittis, dolor purus dignissim ante, sit amet pharetra ex justo vitae ipsum. Nulla consequat interdum neque</div>\n\n    <div id=\"lamp\"><h5>lamp</h5>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Mauris aliquam dapibus blandit. Donec porta, enim hendrerit venenatis vulputate, orci diam lacinia nibh, faucibus rutrum dolor dui ut quam.</div>\n\n    <div id=\"manifold\"><h5>manifold</h5>Donec finibus massa vel nisi ullamcorper, vitae ornare enim euismod. Aliquam auctor quam erat. Duis interdum rutrum orci, ac interdum urna pharetra eget.</div>\n\n    <div id=\"octopus\"><h5>octopus</h5>Nulla id egestas enim. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti. Curabitur eu lobortis ligula.</div>\n\n    <div id=\"paranoia\"><h5>paranoia</h5>Aenean hendrerit mauris ipsum, non laoreet ipsum luctus vel. Curabitur tristique auctor elit ut pulvinar. Quisque arcu arcu, condimentum aliquam sodales nec, dignissim nec justo. Nunc tristique sem felis, pharetra euismod lorem volutpat sed. Ut porttitor metus sit amet elit rhoncus semper.</div>\n\n    <div id=\"qui\"><h5>qui</h5>Quisque rhoncus cursus felis vel elementum. Vestibulum dignissim molestie tortor nec facilisis. Praesent a nibh condimentum, porta nulla egestas, auctor eros</div>\n\n    <div id=\"radical\"><h5>radical</h5>Etiam hendrerit interdum tellus, at aliquet sapien egestas in. Aenean eu urna nisl. Cras vitae risus pharetra, elementum mauris nec, auctor lectus. Fusce pellentesque venenatis dictum. Proin at augue at mauris finibus semper ultricies sed eros.</div>\n\n    <div id=\"silly\"><h5>silly</h5>Praesent pulvinar consequat posuere. Morbi egestas rhoncus felis, id fermentum metus lobortis in. Vestibulum nibh orci, euismod eget vestibulum nec, vehicula vitae tortor. Aenean ullamcorper enim nunc, eu auctor ligula auctor eget.</div>\n\n    <div id=\"taffy\"><h5>taffy</h5>Etiam et arcu vel lacus aliquet lobortis in in massa. Nunc non mollis elit. Aenean accumsan orci quis risus aliquam, non gravida nulla molestie. Mauris pharetra libero et magna aliquam aliquam. Integer quis luctus dolor. </div>\n\n    <div id=\"umbrella\"><h5>umbrella</h5>Fusce molestie finibus malesuada. Nullam ac egestas quam, id venenatis ligula. Pellentesque pulvinar elit et vestibulum fringilla. Cras volutpat sed quam ornare scelerisque. Vivamus volutpat ante pretium scelerisque tempus. Etiam venenatis tempor nisl dignissim sollicitudin. Curabitur ac risus vitae dolor pretium posuere vel vitae diam. Donec in odio arcu.</div>\n\n    <div id=\"vampire\"><h5>vampire</h5>Vestibulum pretium condimentum commodo. Integer placerat leo non ipsum ultrices, ac convallis elit varius. Vestibulum ultricies, justo eu rutrum molestie, quam arcu euismod sapien, vel gravida ipsum nulla eget erat. </div>\n\n    <div id=\"washington\"><h5>washington</h5>Nunc ac quam eu risus dictum sodales. Nam ac risus iaculis, aliquet sem eu, mollis mauris. Curabitur pretium facilisis orci ut lacinia. Sed fermentum leo a odio blandit rutrum. Phasellus at nibh vel odio interdum vulputate ac eget urna. Nam eu arcu dapibus, sodales ligula nec, volutpat ipsum. Suspendisse auctor tellus vitae libero euismod venenatis. </div>\n\n    <div id=\"xylophone\"><h5>xylophone</h5>Sed molestie lobortis ante sit amet hendrerit. Sed pharetra nisi sed interdum pulvinar. Nunc efficitur erat non aliquam mattis. Sed id nisl mattis lacus vehicula volutpat vitae vel massa. Curabitur interdum velit odio, vitae sollicitudin nunc rutrum non. </div>\n\n    <div id=\"yahoo\"><h5>yahoo</h5>Nunc commodo consectetur scelerisque. Proin fermentum ligula ac quam finibus tincidunt. Aenean venenatis nisi et semper semper. Nunc sodales velit ipsum, ac pellentesque augue placerat eu.</div>\n\n    <div id=\"zeta\"><h5>zeta</h5>Nullam ac suscipit odio. Curabitur viverra arcu ut egestas sollicitudin. Fusce sodales varius lectus ut tristique. Etiam eget nunc ornare, aliquet tortor eget, consequat mauris. Integer sit amet fermentum augue. </div>\n\n    <div id=\"alpha\"><h5>alpha</h5>Praesent nec neque ac tellus sodales eleifend nec vel ipsum. Cras et semper risus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Integer mattis leo nisl, a tincidunt lectus tristique eget. Donec finibus lobortis viverra. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Vivamus egestas pulvinar odio non vehicula. Morbi malesuada leo eget nisl sagittis aliquet.</div>\n\n\n    <div id=\"beta\"><h5>beta</h5>Mauris a libero vel enim pharetra interdum non a quam. Sed tincidunt ut elit sed dignissim. Suspendisse vitae tellus dapibus, fermentum lacus ac, fermentum lacus. Nam ante odio, fringilla ac elementum a, mollis sed tellus.</div>\n\n    <div id=\"cappa\"><h5>cappa</h5>Nam molestie semper nulla et molestie. Ut facilisis, ipsum sed convallis posuere, mi mauris bibendum erat, nec egestas ipsum est nec dolor. </div>\n\n    <div id=\"dunno\"><h5>dunno</h5>Etiam et metus congue, commodo libero et, accumsan sem. Aliquam erat volutpat. Quisque tincidunt, tortor non blandit ullamcorper, orci mauris dignissim augue, eget vehicula nulla justo sed dolor. Nunc ac urna quis nisi maximus pharetra in a mauris. Proin metus mi, venenatis vitae tristique sed, fermentum at purus. Aliquam erat volutpat. Maecenas efficitur sodales nibh, ac hendrerit felis facilisis et. Interdum et malesuada fames ac ante ipsum primis in faucibus.</div>\n\n\n</div> <!-- end definition-box-container -->\n</div> <!-- end col-md-3-->\n</div> <!-- end small-box-links -->\n</div> <!-- end row -->\n</div> <!-- end container -->\n\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note: </b> This was mostly an experiment to see if there was a better way to document a long JSON code example. I haven't actually used this approach in my own documentation.</div>\n\n\n\n"
		
	}
	,

	{
		
		"title": "Solution Behaviour",
		"tags": "overview",
		"keywords": "engage about",
		"url": "overview_behaviours.html",
		"summary": "Solution Behaviour",
		"content": "<h2 id=\"behaviour\">Behaviour</h2>\n\n<p>The NRL has been designed around the Pointer as the fundamental unit. Both Providers and Consumers deal exclusively with Pointers. However, Provider and Consumer roles have different capabilities when it comes to Pointer manipulation.</p>\n\n<p>A Provider can be thought of as a system that has <strong>write access</strong> to the NRL, to support Pointer maintenance.</p>\n\n<p>A Consumer can be thought of as a system that has <strong>read access</strong> to the NRL, to facilitate the retrieval of Pointers that are of interest to the Consuming system.</p>\n\n<p><img alt=\"Consumer API includes functionality such as basic read and search; Provider API includes functionality such as create, supersede, update, and delete\" src=\"images/solution/Solution_Behaviour_diagram.png\" style=\"width:100%;max-width: 100%;\" /></p>\n\n<p>A system can be assured as both a Consumer and a Provider, provided that all relevant prerequisites and requirements are met.</p>\n\n<h3 id=\"identity-on-the-nrl\">Identity on the NRL</h3>\n\n<p>Each client system will be given an Accredited System ID (ASID) by NHS Digital. Each ASID will be associated with one or more interaction IDs. An interaction ID defines an action that can be performed against NRL (for example, creating a new DocumentReference). As part of a request, a client will supply its ASID and the interaction ID that relates to the action that it is trying to perform. If the interaction ID is not associated with the client’s ASID, the request will be blocked.</p>\n\n<h3 id=\"pointer-maintenance-by-providers\">Pointer Maintenance by Providers</h3>\n\n<p>If a client system is in the Provider role, it can create, supersede, update, and delete Pointers. When it comes to the modification of existing Pointers, the Provider is only permitted to change Pointers that it owns. The concept of ownership is carried on the Pointer itself and is again centered around the ODS code. The client can modify a Pointer as long as it satisfies the following two conditions:</p>\n<ul>\n  <li>The ASID of the client system verifies that the client has the Provider role.</li>\n  <li>The ODS code associated with that ASID matches the owner’s ODS code found on the Pointer.</li>\n</ul>\n\n<p>To manipulate a Pointer, a Provider must know the logical identifier <em>or</em> the master identifier of that Pointer. The logical identifier is an NRL-generated value that uniquely identifies a Pointer within an instance of the NRL. The master identifier is a unique identifier for the pointer which is under the control of the Provider. See the <a href=\"pointer_identity.html\">Pointer Identity page</a> for more details on identifiers.</p>\n\n<h3 id=\"pointer-retrieval-by-consumers\">Pointer Retrieval by Consumers</h3>\n\n<p>Consumer NRL interactions are read only. A system can search for a collection of pointers or retrieve a single pointer by logical identifier.</p>\n\n<p>The NRL search interaction is predicated on the Consumer having a verified NHS number prior to retrieving Pointers. See the <a href=\"integration_personal_demographics_service.html\">Personal Demographics Service page</a> for more details on NHS number verification.</p>\n\n<p>Once the Consumer has a verified NHS number, the NRL can be asked to retrieve a collection of all “current” Pointers that relate to that NHS number. The NRL looks for Pointers for which the Subject (Patient) property matches the NHS number query parameter. On this basis, the NRL will return a collection of zero or more matching Pointers. See the <a href=\"api_interaction_search.html\">search interaction page</a> for more details.</p>\n\n<p>In order to retrieve a single pointer using the read interaction, the Consumer must know the logical identifier of the pointer. See the <a href=\"api_interaction_read.html\">read interaction page</a> for more details.</p>\n\n<h3 id=\"record-retrieval-by-consumers\">Record Retrieval by Consumers</h3>\n\n<p>The NRL does not take part in Record retrieval. The Pointers it holds can be seen as signposts that show the way. Retrieval of referenced documents and records can be facilitated by the Spine Secure Proxy (SSP).</p>\n\n<p>The SSP is a forward HTTP proxy which is used as a front-end to control and protect access to Provider IT systems that will be exposing Records in a standards-compliant way. It provides a single security point for both authentication and authorisation for systems. More details on how document/record retrieval can be facilitated by the SSP can be found on the <a href=\"retrieval_overview.html\">retrieval overview page</a>.</p>\n\n<h2 id=\"auditing\">Auditing</h2>\n<p>The NRL and the SSP will capture an audit trail for each request-response interaction that a client (Consumer or Provider) has with the system. Once captured, the audit trail can be retrieved.</p>\n\n<h3 id=\"capturing-an-audit-trail\">Capturing an Audit Trail</h3>\n<p>The audit trail begins with capturing key data from a client request, and it ends with capturing the NRL’s response to that request. The request audit trail and response audit\ntrail will be combined to form a full end-to-end audit of a given request and response interaction with the NRL.</p>\n\n<p>An audit trail will capture different information about who or what is making the request, depending on whether the client is a person or a system. An example of the latter case is a Provider periodically running a batch job to synchronise its Pointers to the NRL. When capturing the audit trail, the system needs to be aware of this difference. The audit capability treats the user ID as an optional field in some circumstances: namely, in the context of a Provider reading, searching, creating, updating, or deleting its Pointers. It is never optional in a Consumer context. If the user ID is available, the guidance is that it should always be provided, regardless of whether the client is a Provider or a Consumer.</p>\n\n<p>Details on the audit requirements for Consumers and Providers can be found on the <a href=\"integration_auditing.html\">auditing page</a>.</p>\n\n<h3 id=\"retrieving-an-audit-trail\">Retrieving an Audit Trail</h3>\n\n<p>Providers can request the following two types of audit trail data from NHS Digital:</p>\n<ul>\n  <li>All audit trails for a given patient (identified by their NHS number)</li>\n  <li>All audit trails for the Pointers the Provider owns</li>\n</ul>\n\n<p>In either case, the Provider is permitted to view audit trail information only for Pointers that it owns and maintains.</p>\n"
		
	}
	,

	{
		
		"title": "Solution Concepts",
		"tags": "overview",
		"keywords": "engage about",
		"url": "overview_concepts.html",
		"summary": "Solution Concepts",
		"content": "<h2 id=\"concepts\">Concepts</h2>\n\n<p>The NRL is based on the <a href=\"https://developer.nhs.uk/library/architecture/integration-patterns/registry-repository/\">Registry-Repository pattern</a>, which separates the storage and retrieval of a record from data that describes its location.</p>\n\n<p><img alt=\"Consumer queries NRL to get Pointer, then uses pointer to retrieve Record from Provider\" src=\"images/solution/Solution_Concepts_diagram.png\" style=\"width:100%;max-width: 100%;\" /></p>\n\n<h3 id=\"actors\">Actors</h3>\n\n<p>The <strong>NRL</strong> is acting as a registry with the repository function carried out by so-called <strong>Providers</strong>. Providers are systems external to the NRL that expose records for retrieval. Pointers are created by Providers to signpost a record that is intended to be exposed for retrieval.</p>\n\n<p><strong>Pointers</strong> are really at the core of the NRL. The NRL can be thought of as a collection of Pointers. Each Pointer describes how to retrieve a particular record from the Provider’s system or repository. It is key to the success of the NRL that Pointers are accurate. It is the responsibility of Providers to create and manage Pointers on the NRL in order to maintain this accuracy.</p>\n\n<p>Accuracy is important from the perspective of those systems who wish to understand what records are available and from there may wish to retrieve records from the Provider. This category of actor is known as a <strong>Consumer</strong>. Without accurate Pointer data the Consumer’s life is made harder as they cannot be assured that a given Pointer describes what it purports to.</p>\n\n<p>The NRL does not take part in Record retrieval. The actual retrieval of the Record referenced by a given Pointer can be facilitated by the <strong>Spine Security Proxy (SSP)</strong>.</p>\n\n<p>The NRL actors are summarised <a href=\"overview_interactions.html#interactions\">here</a>.</p>\n\n<h3 id=\"record\">Record</h3>\n\n<p>A Record exists on a remote system and collects together related data into a logical grouping.</p>\n\n<p>Records come in a variety of formats but the NRL broadly makes a distinction based on the notion of <strong>structured</strong> and <strong>unstructured</strong> Records. Structured Records are made up of clearly defined data types whose composition makes them relatively easy to manipulate. Contrast this with unstructured Records which crudely could be said to be “everything else” and are comprised of data that is usually not as easy to manipulate.</p>\n\n<p>The NRL also acknowledges that there is a difference to be drawn between how the contents of a Record can change over time (see the <a href=\"overview_data_model.html#data-model\">Record creation datetime</a> field on Pointer). To the NRL a <strong>static</strong> Record is one whose contents will never change whereas a <strong>dynamic</strong> Record’s contents are not guaranteed to be the same from one point in time to another in the future.</p>\n\n<h3 id=\"pointer\">Pointer</h3>\n\n<p>Pointers are associated with a Record. As noted, a Record exists in a remote system. One of the roles of the Pointer is to provide enough context to allow a Consumer to retrieve that Record from the remote system and display it.</p>\n\n<p>The format and method of retrieval for a Record are under the control of the Provider system. It might be that the Provider has exposed the Record for direct retrieval, such that using the context available in the Pointer, a Consumer is able to retrieve the Record.</p>\n\n<p>Alternatively, rather than point to an electronic copy of the Record, the Provider can expose a set of contact details that a Consumer can use to retrieve the Record. In this scenario, the Consumer is not retrieving the Record electronically. Instead, they are using the contact details as an intermediate step to get to the Record, perhaps by phoning a healthcare service found in the contact details who will then relay the Record to the Consumer via another mechanism.</p>\n\n<p><img alt=\"Pointers link to Records by providing either an API endpoint or contact details of the Provider\" src=\"images/solution/Solution_Concepts_Pointer2_diagram.png\" style=\"width:100%;max-width: 100%;\" /></p>\n\n<p>The preceding diagram shows two Pointers that reference the same Record (Record A). The ways that they describe how to get the contents of Record A are different. In red is a Pointer that directly references the Provider’s API. In this example, following the Pointer will return the Record in electronic form direct from the Provider’s record store (green).</p>\n\n<p>In contrast, the blue Pointer contains a set of contact details. A Consumer following this Pointer would begin their retrieval by dialling the telephone number detailed in the Pointer. This would begin a human-controlled process that would ultimately lead to Record A being retrieved for them. In this example, the person referenced by the contact details accesses Record A using the same API endpoint that the red Pointer references.</p>\n\n<!--\nPointers are associated with a Record. As noted a Record exists in a remote system, one of the roles of the Pointer is to provide enough context to allow a Consumer to retrieve that Record from the remote system and display it.  \n\nThe NRL has two kinds of Pointer which are differentiated by the way they facilitate Record retrieval. A <b>direct</b> Pointer can be followed, and the expectation of the Consumer should be that the Record will be returned to them. An <b>indirect</b> Pointer is different. Following this kind of Pointer will not return the Record, instead it will present the Consumer with a further set of instructions that must be followed in order to retrieve the Record. Typically, this will be a set of contact details that must be used to request the Record, for example it might be the phone number of a healthcare service which can relay a Record’s contents over the phone.\n\n<img src=\"images/solution/Solution_Concepts_Pointer_diagram.png\" style=\"width:100%;max-width: 100%;\">\n-->\n"
		
	}
	,

	{
		
		"title": "Solution Data Model",
		"tags": "overview",
		"keywords": "engage about",
		"url": "overview_data_model.html",
		"summary": "Solution Data Model",
		"content": "<h2 id=\"data-model\">Data Model</h2>\n\n<p>In order to support the Consumer and Provider interactions with the NRL, a data model is provided for the Pointer. The data model is purposefully lean, each property has a clear reason to exist, and it directly supports the activities of Consumers and Providers.</p>\n\n<p>You can explore an in-depth view of the lean data model and the full NRL DocumentReference profile in the <a href=\"explore_reference.html\">FHIR Resources and References section</a>.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Property</th>\n      <th>Cardinality</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"pointer_identity.html\">Identifier</a></td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation time. Uniquely identifies this record within the NRL. Used by Providers to update or delete.</td>\n    </tr>\n    <tr>\n      <td>Profile</td>\n      <td>0..1</td>\n      <td>The URI of the FHIR profile that the resource conforms to. Indicates the version of the pointer model.</td>\n    </tr>\n    <tr>\n      <td>Pointer version</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation or update time. Used to track the current version of a Pointer.</td>\n    </tr>\n    <tr>\n      <td>Pointer last updated datetime</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation and update time. The date and time that the pointer was last updated.</td>\n    </tr>\n    <tr>\n      <td>Pointer indexed datetime</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation time. The date and time that the pointer was created.</td>\n    </tr>\n    <tr>\n      <td><a href=\"pointer_identity.html\">Master Identifier</a></td>\n      <td>0..1</td>\n      <td>An optional identifier of the document as assigned by the Provider. It is version specific — a new master identifier is required if the document is updated.</td>\n    </tr>\n    <tr>\n      <td><a href=\"pointer_lifecycle.html\">Pointer Status</a></td>\n      <td>1..1</td>\n      <td>The status of the pointer</td>\n    </tr>\n    <tr>\n      <td>Patient</td>\n      <td>1..1</td>\n      <td>The NHS number of the patient that the record referenced by this Pointer relates to. Supports Pointer retrieval scenarios.</td>\n    </tr>\n    <tr>\n      <td>Pointer owner</td>\n      <td>1..1</td>\n      <td>The entity that maintains the Pointer. Used to control which systems can modify the Pointer.</td>\n    </tr>\n    <tr>\n      <td>Record owner</td>\n      <td>1..1</td>\n      <td>The entity that maintains the Record. Used to provide the Consumer with context around who they will be interacting with if retrieving the Record.</td>\n    </tr>\n    <tr>\n      <td>Record category</td>\n      <td>1..1</td>\n      <td>A high-level category of the record. The category will be one of a controlled set. It will not be possible to create a pointer with a category that does not exist within this controlled set.</td>\n    </tr>\n    <tr>\n      <td>Record type</td>\n      <td>1..1</td>\n      <td>The clinical type of the record. Used to support searching to allow Consumers to make sense of large result sets of Pointers. The clinical type will be one of a controlled set. It will not be possible to create a pointer with a type that does not exist within this controlled set.</td>\n    </tr>\n    <tr>\n      <td>Record creation clinical setting</td>\n      <td>1..1</td>\n      <td>Describes the clinical setting in which the content was created.</td>\n    </tr>\n    <tr>\n      <td>Period of care</td>\n      <td>0..1</td>\n      <td>Details the period in which the documented care is relevant.</td>\n    </tr>\n    <tr>\n      <td>Pointer reference</td>\n      <td>1..*</td>\n      <td>Information about the record referenced</td>\n    </tr>\n    <tr>\n      <td>Record creation datetime</td>\n      <td>0..1</td>\n      <td>The date and time (on the Provider’s system) that the record was created, for static records.</td>\n    </tr>\n    <tr>\n      <td>Record URL</td>\n      <td>1..1</td>\n      <td>Absolute URL for the location of the record on the Provider’s system</td>\n    </tr>\n    <tr>\n      <td>Record format</td>\n      <td>1..1</td>\n      <td>Describes the technical structure and rules of the record such that the Consumer can pick an appropriate mechanism to handle the record.</td>\n    </tr>\n    <tr>\n      <td>Record MIME type</td>\n      <td>1..1</td>\n      <td>Describes the type of data such that the Consumer can pick an appropriate mechanism to handle the record.</td>\n    </tr>\n    <tr>\n      <td>Record stability</td>\n      <td>1..1</td>\n      <td>Describes whether the record content at the time of the request is dynamically generated or is static.</td>\n    </tr>\n    <tr>\n      <td><a href=\"pointer_maintenance.html\">Related Documents</a></td>\n      <td>0..1</td>\n      <td>Relationship to another pointer</td>\n    </tr>\n  </tbody>\n</table>\n"
		
	}
	,

	{
		
		"title": "Glossary",
		"tags": "overview",
		"keywords": "abbreviations definitions glossaries terms",
		"url": "overview_glossary.html",
		"summary": "Glossary of terms used this implementation guide",
		"content": "<p>Glossary of common terms and abbreviations used throughout this documentation site.</p>\n\n<dl>\n\n<dt id=\"net\">.NET</dt>\n<dd>\n    <p>.NET is both a business strategy from Microsoft and its collection of programming support for Web services. Microsoft’s goal is to provide individual and business users with a seamlessly interoperable and Web-enabled interface for applications and computing devices and to make computing activities increasingly Web browser-oriented. The .NET platform includes servers; building-block services, such as Web-based data storage; and device software. It also includes Passport, Microsoft’s fill-in-the-form-only-once identity verification service.</p>\n  </dd>\n\n<dt id=\"api\">API</dt>\n<dd>\n    <p>The term <em>Application Programming Interface</em> is quite a confused term in the context of FHIR. Strictly speaking, an API is a set or services offered by a programming library that can be made use of by another application. Historically these would have been made available from a single machine although now they are available across networks.<br /><br />In the service/message/document categorisation, an API is a service interface, though this categorisation is contentious. As technology became increasingly capable of supporting distributed operations, the differences between SOA (Service Oriented Architecture) and APIs became blurred. In the context of FHIR, we define APIs as RESTful interfaces.</p>\n  </dd>\n\n<dt id=\"asid\">ASID</dt>\n<dd>\n    <p><em>Accredited System ID</em> (obtained by completing <a href=\"#scal\">SCAL</a>)</p>\n  </dd>\n\n<dt id=\"ddc\">DDC</dt>\n<dd>\n    <p><em>Digital Delivery Centre</em></p>\n  </dd>\n\n<dt id=\"dm-d\">dm+d</dt>\n<dd>\n    <p>The NHS <em>Dictionary of Medicines and Devices</em> is a dictionary of descriptions and codes which represent medicines and devices in use across the NHS. It is delivered through a partnership between NHS Digital and the NHS Business Services Authority and provides the recognised NHS Standard for uniquely identifying medicines and medical devices used in patient care.</p>\n  </dd>\n\n<dt id=\"dms\">DMS</dt>\n<dd>\n    <p><em>Domain Message Specification</em> Description of messages definitions and interactions relating to a specific business area (such as Ambulance, Child Health or Discharge etc.)</p>\n  </dd>\n\n<dt id=\"dstu\">DSTU</dt>\n<dd>\n    <p><em>Draft Standard for Trial Use</em></p>\n  </dd>\n\n<dt id=\"euod\">EUOD</dt>\n<dd>\n    <p><em>End User Organisation Declaration</em></p>\n  </dd>\n\n<dt id=\"fhir\">FHIR</dt>\n<dd>\n    <p>FHIR is the latest standard to be developed under the HL7 organisation. Pronounced ‘Fire’ and stands for Fast Healthcare Interoperability Resources.</p>\n  </dd>\n\n<dt id=\"fhirpath\">FHIRPath</dt>\n<dd>\n    <p><a href=\"https://hl7.org/fhirpath/\">FHIRPath</a> is a path-based navigation and extraction language, somewhat like XPath. Operations are expressed in terms of the logical content of hierarchical data models, supporting traversal, selection, and filtering of data.</p>\n  </dd>\n\n<dt id=\"fqdn\">FQDN</dt>\n<dd>\n    <p>A <a href=\"http://www.linfo.org/fqdn.html\"><em>Fully Qualified Domain Name</em></a> consists of a host name (including all subnames) and a domain name, including the top-level domain (TLD).</p>\n  </dd>\n\n<dt id=\"itk\">ITK</dt>\n<dd>\n    <p>The <em>Interoperability Toolkit</em>, in the context of the NHS this is a set of common specifications, frameworks, and implementation guides to support interoperability within local organisations and across local health and social care communities.</p>\n  </dd>\n\n<dt id=\"json\">JSON</dt>\n<dd>\n    <p><em>Javascript Object Notation</em> is a lightweight data-interchange format. It is easy for humans to read and write and easy for machines to parse and generate. It is based on a subset of the JavaScript Programming Language.</p>\n  </dd>\n\n<dt id=\"jwt\">JWT</dt>\n<dd>\n    <p><a href=\"https://jwt.io/\" target=\"_blank\"><em>JSON web token</em></a>, a standard for access tokens containing information about authorisation claims.</p>\n  </dd>\n\n<dt id=\"lhcre\">LHCRE</dt>\n<dd>\n    <p><a href=\"https://understandingpatientdata.org.uk/news/local-health-and-care-record-exemplars-announced\" target=\"_blank\"><em>Local Health and Care Record Exemplar</em></a></p>\n  </dd>\n\n<dt id=\"mpv\">MPV</dt>\n<dd>\n    <p><em>Manufacturer Product Version</em></p>\n  </dd>\n\n<dt id=\"n3\">N3</dt>\n<dd>\n    <p>N3 is a Wide Area IP Network (WAN), connecting many different sites across the NHS within England &amp; Scotland. It also connects to other networks via Gateways, notably to the Internet via the Internet Gateway.</p>\n  </dd>\n\n<dt id=\"nems\">NEMS</dt>\n<dd>\n    <p><a href=\"https://digital.nhs.uk/services/digital-child-health/national-events-management-service\" target=\"_blank\"><em>National Events Management Service</em></a>, a sister project to the NRL that tracks events.</p>\n  </dd>\n\n<dt id=\"nrl\">NRL</dt>\n<dd>\n    <p>The <em>National Record Locator</em> is a national index to identify available records for patients and locate them across local and national care record solutions (such as SCR).</p>\n  </dd>\n\n<dt id=\"ods\">ODS</dt>\n<dd>\n    <p>The <em>Organisational Data Service</em> is responsible for publishing organisation and practitioner codes, along with related national policies and standards. They’re also responsible for the ongoing maintenance of the organisation and person nodes of the Spine Directory Service, the central data repository used within various NHS systems and services.</p>\n  </dd>\n\n<dt id=\"pas\">PAS</dt>\n<dd>\n    <p>The <em>Patient Administration System</em> records the patient’s demographics (e.g. name, home address, date of birth) and details all patient contact with the hospital, both outpatient and inpatient.<br /><br />Some PAS systems do support additional clinical behaviours.</p>\n  </dd>\n\n<dt id=\"pds\">PDS</dt>\n<dd>\n    <p>The <em><a href=\"https://digital.nhs.uk/services/demographics\" target=\"_blank\">Personal Demographics Service</a></em> is a national electronic database of NHS patients containing details such as name, address, date of birth and NHS Number (known as demographic information). (Implemented with HL7 v3)</p>\n  </dd>\n\n<dt id=\"rbac\">RBAC</dt>\n<dd>\n    <p><em>Role Based Access Control</em> defines roles and allowed business activities associated with a user (via their smartcard). (Implemented using SAML)</p>\n  </dd>\n\n<dt id=\"record-group\">Record Group</dt>\n<dd>\n    <p>A grouping that contains one or more Record Types.</p>\n  </dd>\n\n<dt id=\"record-type\">Record Type</dt>\n<dd>\n    <p>The clinical type of a record as defined by SNOMED-CT code. The clinical types permitted on the NRL are defined by a controlled list.</p>\n  </dd>\n\n<dt id=\"rest\">REST</dt>\n<dd>\n    <p><em>Representational State Transfer</em> is a protocol based upon a network of Web resources (a virtual state-machine) where the user progresses through the application by selecting links, such as /user/tom, and operations such as GET or DELETE (state transitions), resulting in the next resource (representing the next state of the application) being transferred to the user for their use. Typically preferred due to it being “stateless” so no information about the client session needs to be maintained on the server.</p>\n  </dd>\n\n<dt id=\"restful\">RESTful</dt>\n<dd>\n    <p>Interfaces are often referred to as being “RESTful” when they follow principles of <a href=\"#rest\">REST</a> to avoid debate about whether they fully conform to REST.</p>\n  </dd>\n\n<dt id=\"scal\">SCAL</dt>\n<dd>\n    <p><a href=\"https://developer.nhs.uk/apis/uec-appointments/assurance_scal.html\" target=\"_blank\"><em>Supplier Conformance Assessment List</em></a></p>\n  </dd>\n\n<dt id=\"scr\">SCR</dt>\n<dd>\n    <p><a href=\"https://digital.nhs.uk/services/summary-care-records-scr\" target=\"_blank\"><em>Summary Care Record</em></a></p>\n  </dd>\n\n<dt id=\"scra\">SCRa</dt>\n<dd>\n    <p><em>Summary Care Record Application</em></p>\n  </dd>\n\n<dt id=\"sds\">SDS</dt>\n<dd>\n    <p>The NHS <em>Spine Directory Service</em> is a component of the NHS Spine service comprising of the Spine User Directory and Spine Accredited Systems and Services. The SDS ensures that transactions/messages are only processed from authorised users and systems. (Implemented with LDAP)</p>\n  </dd>\n\n<dt id=\"snomed\">SNOMED</dt>\n<dd>\n    <p><a href=\"https://www.snomed.org\" target=\"_blank\"><em>Systematized Nomenclature of Medicine</em></a></p>\n  </dd>\n\n<dt id=\"snomed-ct\">SNOMED-CT</dt>\n<dd>\n    <p>The most comprehensive and precise clinical health terminology product in the world, owned and distributed by SNOMED International.</p>\n  </dd>\n\n<dt id=\"soa\">SOA</dt>\n<dd>\n    <p>Method for systems integration and development that allows different applications to exchange data  in a loosely coupled way.</p>\n  </dd>\n\n<dt id=\"spine\">Spine</dt>\n<dd>\n    <p>A collection of national applications, services, and directories which support the health and social care sector in the exchange of information in national and local IT systems</p>\n  </dd>\n\n<dt id=\"ssp\">SSP</dt>\n<dd>\n    <p><em>Spine Secure Proxy</em></p>\n  </dd>\n\n<dt id=\"stu\">STU</dt>\n<dd>\n    <p><em>Standard for Trial Use</em> The original DSTU2 FHIR standard has been superseded by the new standard STU3. To reflect that important parts of the spec are well past the draft stage</p>\n  </dd>\n\n<dt id=\"tkw\">TKW</dt>\n<dd>\n    <p><a href=\"https://digital.nhs.uk/services/interoperability-toolkit/developer-resources/itk-test-centre/itk-testbench\" target=\"_blank\"><em>Toolkit Workbench</em></a></p>\n  </dd>\n\n<dt id=\"tls\">TLS</dt>\n<dd>\n    <p><em>Transport Layer Security</em></p>\n  </dd>\n\n<dt id=\"tlsma\">TLSMA</dt>\n<dd>\n    <p><em><a href=\"#tls\">TLS</a> Mutual Authentication</em></p>\n  </dd>\n\n<dt id=\"uml\">UML</dt>\n<dd>\n    <p>The <em>Unified Modelling Language</em> is a family of graphical notations baked by a single meta-model, that help in designing and describing software systems. Especially useful when working with OOP paradigms..</p>\n  </dd>\n\n<dt id=\"use-case\">Use Case</dt>\n<dd>\n    <p>A list of actions or event steps, typically defining the interactions between a role (known in the Unified Modeling Language as an actor) and a system, to achieve a goal. The actor can be a human or other external system.</p>\n  </dd>\n\n<dt id=\"use-case-diagram\">Use Case Diagram</dt>\n<dd>\n    <p>A visual presentation of a Use Case, standardised within UML.</p>\n  </dd>\n\n<dt id=\"x509-certificate\">X509 certificate</dt>\n<dd>\n    <p>A format of public key certificate originally defined in <a href=\"https://tools.ietf.org/html/rfc5280\" target=\"_blank\">RFC 5280</a>. Often colloquially referred to as an “SSL certificate”.</p>\n  </dd>\n\n<dt id=\"xml\">XML</dt>\n<dd>\n    <p><em>eXtensible Markup Language</em> is a protocol designed to store and transport data. XML was designed to be both human and machine readable.</p>\n  </dd>\n\n<dt id=\"xpath\">xPath</dt>\n<dd>\n    <p>XPath is a major element in the XSLT standard. XPath can be used to navigate through elements and attributes in an XML document. XPath is a syntax for defining parts of an XML document. XPath uses path expressions to navigate in XML documents. XPath contains a library of standard functions.</p>\n  </dd>\n\n</dl>\n\n<script>\n\t$(function() {\n        anchors.add('dt');\n\t});\n</script>\n\n"
		
	}
	,

	{
		
		"title": "Product Versioning",
		"tags": "development",
		"keywords": "development versioning",
		"url": "overview_guide_versioning.html",
		"summary": "An overview of how implementation Guides (and other technical assets) are versioned.",
		"content": "<h2 id=\"product-versioning\">Product Versioning</h2>\n\n<p>Versioning of each technical “Product” or asset (i.e. API Implementation Guide, Design Principle(s), Data Library, FHIR profiles) is managed using <a href=\"https://semver.org/spec/v2.0.0.html\">Semantic Versioning 2.0.0</a>.</p>\n\n<h3 id=\"semantic-versioning\">Semantic Versioning</h3>\n\n<p>Given a version number MAJOR.MINOR.PATCH, increment the:</p>\n\n<ul>\n  <li>MAJOR version when you make incompatible API changes,</li>\n  <li>MINOR version when you add functionality in a backwards-compatible manner, and</li>\n  <li>PATCH version when you make backwards-compatible bug fixes.</li>\n</ul>\n\n<p>Additional labels for pre-release and build metadata are available as extensions to the MAJOR.MINOR.PATCH format.</p>\n\n<p>A pre-release version MAY be denoted by appending a hyphen (see <a href=\"https://semver.org/spec/v2.0.0.html#spec-item-9\">Semantic Versioning - Item 9</a>).</p>\n\n<p>For examples: 1.0.0-alpha.1 is a valid pre-release version.</p>\n\n<h3 id=\"pre-release-labels\">Pre-Release Labels</h3>\n\n<p>When FHIR API implementation guides are published, they MUST have an associated maturity label. These labels are based on the GDS development process stages and MUST conform to one of the labels defined in the <a href=\"https://nhsconnect.github.io/fhir-policy/publication.html\">FHIR-PUB-04: FHIR API Maturity</a> ‘Publication Requirements’ section of the <a href=\"https://nhsconnect.github.io/fhir-policy/index.html\">NHS FHIR Policy</a>.</p>\n\n<!-- TODO add more info -->\n"
		
	}
	,

	{
		
		"title": "Solution Interactions",
		"tags": "overview",
		"keywords": "engage about",
		"url": "overview_interactions.html",
		"summary": "Getting involved with NRL",
		"content": "<h2 id=\"interactions\">Interactions</h2>\n\n<p>There are three main types of systems that need to integrate in order to share data with the NRL.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>System</th>\n      <th>Role in NRL</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Consumer</td>\n      <td>A system that wishes to retrieve Pointers related to a given patient by NHS number and optionally follow one or more of those Pointers to retrieve the record to which it points.</td>\n    </tr>\n    <tr>\n      <td>Provider</td>\n      <td>A system that wishes to expose its Records for sharing.</td>\n    </tr>\n    <tr>\n      <td>NRL</td>\n      <td>A system that stores and provides access to Pointers for retrieval and maintenance.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h3 id=\"provider-interactions\">Provider Interactions</h3>\n\n<p>A Provider is responsible for maintaining a set of Pointers. This involves creating, replacing, updating, and deleting Pointers.</p>\n\n<h4 id=\"pointer-creation\">Pointer Creation</h4>\n\n<p>When a relevant event occurs within a Provider organisation, the Provider generates a Pointer referencing a record that the Provider wishes to expose to NRL Consumers.</p>\n\n<p>Once generated, the Provider sends the Pointer to the <a href=\"api_interaction_create.html\">create interaction</a> exposed by the NRL maintenance interface.</p>\n\n<p>After successfully persisting the Pointer, the NRL informs the Provider client of this in the returned response, which includes the address of the new Pointer.</p>\n\n<p>If any problems prevent the Pointer from being created, the NRL will inform the client of this in the returned response.</p>\n\n<h4 id=\"pointer-replacement\">Pointer Replacement</h4>\n\n<p>When an event occurs within a Provider organisation that requires a Pointer’s metadata, such as the record URL, to be updated on the NRL, the Provider should create a new pointer with the updated metadata which supersedes (replaces) the existing pointer. This can be done using the <a href=\"api_interaction_supersede.html\">create (supersede) interaction</a>, creating a new pointer that references the superseded pointer using the ‘Related document’ metadata item.</p>\n\n<p>The creation of the new pointer with the ‘Related document’ metadata item will consequently update the existing Pointer to change the status to “superseded” and increment the pointer version. The superseded pointer will no longer be available to Consumers.</p>\n\n<p>After successfully persisting the Pointer, the NRL will inform the Provider client of this in the returned response which will include the address of the new Pointer.</p>\n\n<p>If there were any problems that meant the Pointer could not be created, the NRL will inform the client of this in the returned response. In the case of an error occuring, all updates to the superseded pointer will be rolled back.</p>\n\n<h4 id=\"pointer-update\">Pointer Update</h4>\n\n<p>When an error is identified with a Pointer that means it should not exist on NRL, whether the error concerns the pointer metadata or the referenced record itself, the Provider should update the pointer status to “entered-in-error”.</p>\n\n<p>The Provider does this using the <a href=\"api_interaction_update.html\">update interaction</a> that is exposed on the NRL maintenance interface.</p>\n\n<p>After successfully updating the Pointer, the NRL will inform the Provider client of this in the returned response, and the updated pointer will no longer be available to Consumers.</p>\n\n<p>If there were any problems that meant the Pointer could not be updated, the NRL will inform the client of this in the returned response.</p>\n\n<h4 id=\"pointer-removal\">Pointer Removal</h4>\n\n<p>When an event occurs within a Provider organisation that requires the removal of an existing Pointer from the NRL the Provider uses the <a href=\"api_interaction_delete.html\">delete interaction</a> exposed in the NRL maintenance interface, passing it the address of the Pointer to be removed.</p>\n\n<p>After successfully deleting the Pointer, the NRL will inform the Provider client of this in the returned response, and the deleted pointer will no longer be available to Consumers.</p>\n\n<p>If there were any problems that meant the Pointer could not be removed, the NRL will inform the client.</p>\n\n<h3 id=\"consumer-interactions\">Consumer Interactions</h3>\n\n<p>Consumers can retrieve pointers using the search or read interactions. Only pointers with the status of “current” can be retrieved by Consumers.</p>\n\n<h4 id=\"read-pointer\">Read Pointer</h4>\n\n<p>A Consumer can perform a <a href=\"api_interaction_read.html\">read interaction</a> to retrieve a single pointer by its logical identifier.</p>\n\n<h4 id=\"pointer-search\">Pointer Search</h4>\n\n<p>A Consumer can perform parameterised searches of the Pointers held within the NRL using a <a href=\"api_interaction_search.html\">search interaction</a>:</p>\n\n<ul>\n  <li>A Consumer can ask the NRL to return all Pointers that relate to a given patient by supplying the NHS number of that patient.</li>\n  <li>A Consumer can combine the Patient search parameter with the ODS code of the organisation that owns a Pointer to further narrow the search space.</li>\n  <li>The NRL also allows searching by logical ID. This uniquely identifies a Pointer and is similar to the <code class=\"highlighter-rouge\">read</code> interaction, but returns the relevant Pointer wrapped in a <a href=\"https://www.hl7.org/fhir/bundle.html\">FHIR bundle</a>.</li>\n</ul>\n"
		
	}
	,

	{
		
		"title": "Solution Principles",
		"tags": "overview",
		"keywords": "engage about",
		"url": "overview_principles.html",
		"summary": "Solution Principles",
		"content": "<h2 id=\"principles\">Principles</h2>\n\n<!--\n### The NRL defines a controlled scope around record retrieval\n\nOne of the key capabilities of the NRL is to provide enough context in a Pointer to allow a Consumer to retrieve the Record that it relates to. Clearly there are a myriad of different ways that data can be exposed for consumption and providing a context model that is capable of describing all of these options is a non-trivial task.  \nWith this complexity in mind the NRL has taken the decision to place some control around how Providers are expected to expose their Records if they are to be described by a Pointer.  \nIn the first instance the NRL mandates a single access mechanism; a HTTPS GET to retrieve a Record. Over time the ambition is that NRL will support other access mechanisms but in the short term the above restriction should be seen as a tactical solution designed to allow the NRL to concentrate on delivering value based on what is known today.\nClearly issuing a GET to retrieve a record is only one part of the task. Accessing records in a secure fashion is also an important consideration. Again, just as there are many ways to expose a Record, there are many ways to securely expose a Record. Taking a similar tack, the NRL is predicated around the principle of placing a degree of control over how Providers securely expose their Records for consumption via a Pointer. The mechanism that has been selected in the first instance is mutual authentication over HTTPS. More detail can be found in the security section. Again as with the control around the mechanism of Record retrieval, the NRL sees the use of mutual authentication as the initial offering, the ambition is to increase the supported security models as more information is gathered.\n-->\n\n<h3 id=\"the-nrl-supports-varying-levels-of-digital-maturity\">The NRL supports varying levels of digital maturity</h3>\n\n<p>The NRL recognises that there exist varying levels of digital maturity across Providers and Consumers. The format and method of retrieval for a Record are under the control of the Provider system. Currently, two record retrieval scenarios are envisaged:</p>\n\n<ul>\n  <li>A Provider exposes a Record for direct retrieval, such that using the context available in the Pointer, a Consumer can retrieve the Record electronically.</li>\n  <li>A Provider exposes a set of contact details that a Consumer can use to retrieve the Record. The Consumer does not retrieve the Record electronically. Instead, they use the contact details as an intermediate step to get to the Record, such as by phoning a healthcare service found in the contact details, who can then relay the Record to the Consumer by other means.</li>\n</ul>\n\n<h3 id=\"records-should-be-exposed-using-national-standards\">Records should be exposed using national standards</h3>\n\n<p>To enable Consumers to retrieve records with minimal custom integration between Consumer and Provider systems, records should be exposed using national standards.</p>\n\n<p>The NRL defines a <a href=\"retrieval_interaction_read.html\">Read interaction</a> for retrieval of a record via the SSP, which enables a retrieval of records using a standard HTTP GET interaction for a set of specified formats and data structures. There may be exceptions where record retrieval takes place using an alternative retrieval mechanism.</p>\n\n<p>The pointer model includes a ‘Record format’ metadata attribute, which describes the technical structure of the record and the mechanism for retrieval. The set of supported formats for retrieval is described on the <a href=\"retrieval_formats.html\">retrieval formats page</a>.</p>\n\n<h3 id=\"the-nrl-does-not-guarantee-that-records-can-be-retrieved-by-following-a-pointer\">The NRL does not guarantee that Records can be retrieved by following a Pointer</h3>\n\n<p>There are complexities associated with retrieving data over a network that are outside of the scope of the metadata captured by a Pointer. As an example, consider the need to define firewall rules to allow traffic to flow between a Consumer and a Provider. The NRL aims to facilitate record retrieval through the <a href=\"retrieval_interaction_read.html\">SSP Read Interaction</a>, reducing the need for point-to-point integration between Consumer and Provider systems. However, Providers have a responsibility to ensure that Pointer metadata accurately reflects the retrieval mechanism and format of the referenced document/record.</p>\n\n<h3 id=\"the-consumer-controls-pointer-access\">The Consumer controls Pointer access</h3>\n\n<p>When a Consumer requests that the NRL return the Pointers that it has for a given patient (NHS number) it will return all Pointers. The NRL will not perform any filtering before sending that collection of Pointers back to the Consumer.</p>\n\n<p>Once consequence of this is that the end user on the Consumer side may be exposed to Pointers that reveal sensitive information about the Patient, for example it will be possible to infer through a Pointer that a Patient has a certain kind of record. Even though the user may not be able to retrieve the Record, knowing that it exists is in itself revealing a degree of personal information about that patient that may not be appropriate.</p>\n\n<p>With this in mind, there will most likely be a need to filter Pointers before they are displayed to the end user. This responsibility belongs to the Consumer and should be implemented using local access rules to judge whether a given user should be permitted to know that a given Pointer exists. This is in addition to the RBAC requirements for NRL (see the <a href=\"integration_authentication_authorisation.html\">Authentication &amp; Authorisation page</a>).</p>\n\n<p>The mechanism for making this decision is predicated on the <a href=\"overview_data_model.html#data-model\">Record type</a> that the Pointer references.</p>\n\n<h3 id=\"pointers-should-not-be-removed\">Pointers should not be removed</h3>\n\n<p>In part, the NRL is there to track the evolution of a Pointer’s content. This is important so that the NRL can support the retrieval \nof historical Pointers for medico-legal use cases. To that end, the deletion of a Pointer should be avoided, \nthough the NRL does provide a delete function to cover circumstances in which deletion of a Pointer may be unavoidable. \nMore information is provided on the <a href=\"pointer_maintenance.html\">Pointer maintenance page</a>.</p>\n\n<h3 id=\"caching-and-storing\">Caching and Storing</h3>\n\n<p>It is important that consumers of NRL Pointers can view and make clinical decisions based on the most up-to-date information available. For this reason, NRL recommends that Pointers and referenced content returned from search and read requests not be cached or stored.</p>\n"
		
	}
	,

	{
		
		"title": "Release Notes",
		"tags": "overview",
		"keywords": "development versioning",
		"url": "overview_release_notes.html",
		"summary": "Summary release notes of the versions released in NRL API Implementation Guide",
		"content": "<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Starting from release 2.0.0-beta, all items are considered “general changes” unless otherwise stated.</div>\n\n<h2 id=\"230-beta\">2.3.0-beta</h2>\n\n<ul>\n  <li>Add clarification about use of <code class=\"highlighter-rouge\">versionId</code> to <a href=\"api_interaction_supersede.html\">Supersede interaction page</a></li>\n  <li>Update ODS code and endpoint requirements guidance</li>\n  <li>Remove SSP prefix from example <code class=\"highlighter-rouge\">DocumentReference</code>s</li>\n  <li>Update guidance on constructing SSP URLs and percent-encoding for document retrieval</li>\n  <li>Add clarification about cardinality in JSON</li>\n  <li>Add notes about <code class=\"highlighter-rouge\">CodeableConcept</code> data type</li>\n  <li>Updated glossary of terms</li>\n  <li>Update tags and enable filtering by tag name</li>\n  <li>Remove obsolete pages</li>\n  <li>Miscellaneous copy-edits and minor restructuring</li>\n</ul>\n\n<h2 id=\"220-beta\">2.2.0-beta</h2>\n<ul>\n  <li>Renamed metadata ‘Record class’ to ‘Record category’</li>\n  <li>Updated guidance on request headers for the retrieval read interaction</li>\n  <li>Updated guidance on use of CareConnect GET Binary API for unstructured retrieval</li>\n  <li>Added guidance on pointer model versioning</li>\n  <li>Updated guidance on Consumer and Provider interactions on:\n    <ul>\n      <li>Solution behaviour page</li>\n      <li>Solution interactions page</li>\n      <li>Development guidance overview page</li>\n    </ul>\n  </li>\n  <li>Updated solution principles</li>\n  <li>Added detail on access control and RBAC codes</li>\n  <li>Changed the interaction ID that must be used:\n    <ul>\n      <li>for registering Provider document/record retrieval endpoints on SDS</li>\n      <li>for when Consumers perform a look-up of a Provider ASID on SDS</li>\n    </ul>\n  </li>\n  <li>Added clarification on using absolute URLs in the Record URL metadata attribute</li>\n</ul>\n\n<h2 id=\"211-beta\">2.1.1-beta</h2>\n<ul>\n  <li>Updated guidance on usage of SNOMED CT concepts in FHIR value sets</li>\n  <li>API interaction examples updated</li>\n</ul>\n\n<h2 id=\"210-beta\">2.1.0-beta</h2>\n<p><em>Changes to record/document retrieval requirements and updated guidance</em></p>\n<ul>\n  <li><em class=\"label label-danger\">API Breaking Change</em> The custodian search parameter format has been updated</li>\n  <li><em class=\"label label-danger\">API Breaking Change</em> The supported formats for retrieval have been updated</li>\n  <li><em class=\"label label-danger\">API Breaking Change</em> The inclusion of the <code class=\"highlighter-rouge\">meta.profile</code> element on the create and supersede interactions are now enforced</li>\n  <li>Consumer guidance on assembling SSP request updated</li>\n  <li>Updated JWT requirements for document/record retrieval via the SSP</li>\n  <li>Change to interaction ID for record retrieval via the SSP</li>\n  <li>Restructuring of record retrieval read interaction guidance</li>\n  <li>Added definition of FHIR <code class=\"highlighter-rouge\">meta</code> attributes to the data model</li>\n  <li>Added clarity to the rules on the use of PATCH</li>\n  <li>Added clarity to the use of reference type metadata attributes</li>\n  <li>Added clarity on the use of NHS Number with subject/patient</li>\n  <li>API interaction examples updated</li>\n  <li>Guidance on prerequisites added to API interactions</li>\n  <li>Audit requirements elaborated</li>\n  <li>Phase 1 and Phase 2 overview updated</li>\n</ul>\n\n<h2 id=\"200-beta\">2.0.0-beta</h2>\n<p><em>Changes to record/document retrieval requirements, new API interactions, NRL DocumentReference model changes, and updated guidance.</em></p>\n<ul>\n  <li>The service name has changed from NRLS (National Record Locator Service) to NRL (National Record Locator)</li>\n  <li><em class=\"label label-danger\">API Breaking Change</em> The FHIR Resource NRLS-DocumentReference-1 uplifted to NRL-DocumentReference-1\n    <ul>\n      <li>Data model changes are detailed below</li>\n    </ul>\n  </li>\n  <li><em class=\"label label-danger\">API Breaking Change</em> Data model changes\n    <ul>\n      <li><code class=\"highlighter-rouge\">Class</code>: now mandatory and persisted by NRL</li>\n      <li><code class=\"highlighter-rouge\">Type</code>: ValueSet URL changed from NRLS-RecordType-1 to NRL-RecordType-1</li>\n      <li><code class=\"highlighter-rouge\">Context</code>: now mandatory</li>\n      <li><code class=\"highlighter-rouge\">Context.PracticeSetting</code>: now mandatory and persisted by NRL</li>\n      <li><code class=\"highlighter-rouge\">Context.Period</code>: now persisted by NRL</li>\n      <li><code class=\"highlighter-rouge\">Content.Format</code>: now mandatory and persisted by NRL</li>\n      <li><code class=\"highlighter-rouge\">Content</code>: has new mandatory extension of ContentStability (NRL-ContentStability-1)</li>\n      <li><code class=\"highlighter-rouge\">RelatesTo</code>: now limited to max of 1</li>\n      <li><code class=\"highlighter-rouge\">RelatesTo.Code</code>: now limited to single code of ‘replaces’</li>\n    </ul>\n  </li>\n  <li>FHIR Resource examples (JSON/XML)\n    <ul>\n      <li>Source of FHIR Resource examples has been changed</li>\n      <li>FHIR Resource examples are now contained in a shorter scrollable code block</li>\n    </ul>\n  </li>\n  <li>Assurance page\n    <ul>\n      <li>References to TOM have been changed to SCAL</li>\n      <li>Links to the on-boarding guide have been added</li>\n    </ul>\n  </li>\n  <li>Developer Guidance\n    <ul>\n      <li>Overview page\n        <ul>\n          <li>NHS number verification guidance updated</li>\n          <li>Actor to interaction mapping table updated</li>\n        </ul>\n      </li>\n      <li>FHIR Resource page\n        <ul>\n          <li>Renamed</li>\n          <li>Additional data model properties detailed</li>\n          <li>Additional valuesets, extensions, and codesystems added</li>\n          <li>Master Identifier added to identifiers section</li>\n          <li>The term ‘Record Status’ has changed to ‘Pointer Status’</li>\n        </ul>\n      </li>\n      <li>General API Guidance\n        <ul>\n          <li>Error handling updates:\n            <ul>\n              <li>Invalid resource section re-structured</li>\n              <li>Added detail for the ‘update interaction’ errors</li>\n              <li>Added Patient mismatch errors</li>\n              <li>Added masterIdentifier errors</li>\n              <li>Inactive DocumentReference guidance added</li>\n              <li>New data model error handling details added</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li><em class=\"label label-info\">New API Feature</em> Retrieval of Records/Documents Guidance now documented in a new section under Developer Guidance, which includes:\n        <ul>\n          <li>An overview of retrieval</li>\n          <li>Read interaction requirements</li>\n          <li>Provider guidance</li>\n          <li>Consumer guidance</li>\n          <li>Pointer format code guidance</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>API Interactions\n    <ul>\n      <li>Update interaction page has been renamed to ‘Create (Supersede)’\n        <ul>\n          <li><em class=\"label label-info\">New API Feature</em> ‘Supersede’ now supports supersede by logical id</li>\n          <li>Now details additional error responses</li>\n          <li><em class=\"label label-danger\">API Breaking Change</em> A ‘supersede’ with multiple <code class=\"highlighter-rouge\">relatesTo</code> properties will now be rejected</li>\n          <li><em class=\"label label-danger\">API Breaking Change</em> A ‘supersede’ with a <code class=\"highlighter-rouge\">relatesTo</code> property containing a code other than ‘replaces’ will be rejected</li>\n          <li>New ‘Update interaction’ page created, see below</li>\n        </ul>\n      </li>\n      <li><em class=\"label label-info\">New API Feature</em> RESTful ‘read’ by logical id now supported which returns a single DocumentReference resource</li>\n      <li><em class=\"label label-info\">New API Feature</em> RESTful ‘update’ now supported - using the HTTP PATCH verb\n        <ul>\n          <li>HTTP PATCH supports update by logical id and master identifier</li>\n        </ul>\n      </li>\n      <li>Create interaction\n        <ul>\n          <li>Page details additional error responses</li>\n          <li><em class=\"label label-danger\">API Breaking Change</em> Format of Location response header has been changed to [baseUrl]/DocumentReference/[id]</li>\n        </ul>\n      </li>\n      <li>Delete interaction\n        <ul>\n          <li><em class=\"label label-info\">New API Feature</em> Now supports RESTful delete by logical id i.e. DELETE [baseUrl]/DocumentReference/[id]</li>\n          <li>Requirements have been moved into a single section</li>\n        </ul>\n      </li>\n      <li>Search interaction\n        <ul>\n          <li>Now only returns DocumentReference’s that have a ‘status’ of current</li>\n          <li>DocumentReference’s with a format code that indicates the referenced content is to be retrieved via the SSP will have its url property modified to reflect this.</li>\n          <li>These changes also apply to Read Interaction</li>\n          <li>Bundle response now includes additional attributes:\n            <ul>\n              <li><code class=\"highlighter-rouge\">Self link</code> added</li>\n              <li><code class=\"highlighter-rouge\">Search.mode</code> added</li>\n              <li><code class=\"highlighter-rouge\">Resource.fullUrl</code> added</li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>Integrate with spine\n    <ul>\n      <li>Security page\n        <ul>\n          <li>This page has been moved from Developer guidance to the Integrate with spine section</li>\n          <li>Overview section added</li>\n          <li>Further clarity on which protocols can be used</li>\n          <li>Updated the allowed cipher suite list</li>\n          <li>Guidance added for those that already have a NHS Digital supplied X.509 certificate</li>\n          <li>Guidance document links have been fixed</li>\n        </ul>\n      </li>\n      <li>Access Token and Audit page renamed to Access Token (Audit has moved to its own page)</li>\n      <li>New audit page added</li>\n      <li>PDS Guidance updated</li>\n      <li>Authentication guidance and requirements updated to reflect content retrieval and related service name changes</li>\n    </ul>\n  </li>\n  <li>Pointer Guidance\n    <ul>\n      <li>More clarity on handling errors</li>\n      <li>More clarity on use of the master identifier property</li>\n    </ul>\n  </li>\n  <li>Pointer Lifecycle\n    <ul>\n      <li>Removed reference to transition from “entered-in-error” to current</li>\n      <li>More clarity on meaning of each status</li>\n      <li>More guidance on deleting pointers</li>\n    </ul>\n  </li>\n  <li>Pointer Maintenance\n    <ul>\n      <li>More clarity on what deleting pointers does</li>\n      <li>More clarity on handling lineages</li>\n      <li>Detailed the new ‘update’ and ‘supersede’ interactions</li>\n    </ul>\n  </li>\n  <li>Solution\n    <ul>\n      <li>Data model updated to reflect DocumentReference changes detailed above</li>\n      <li>Clarity around caching data added</li>\n    </ul>\n  </li>\n</ul>\n\n<h2 id=\"123-beta\">1.2.3-beta</h2>\n<p><em>Changes to restructure the Implementation Guide</em>.</p>\n<ul>\n  <li><code class=\"highlighter-rouge\">versionId</code> will be incremented during a supersede transaction - Create API interaction updated to align with implementation.</li>\n  <li>500 Internal server error HTTP response guidance modified to match Spine Core output - Spine does not return an operation outcome.</li>\n  <li>NRLS-DocumentReference-1 FHIR profile element guidance explicitly supports <code class=\"highlighter-rouge\">relatesTo.target</code> element.</li>\n</ul>\n\n<h2 id=\"122-beta\">1.2.2-beta</h2>\n<p><em>Changes to restructure the Implementation Guide</em>.</p>\n<ul>\n  <li>Introduction of C# example code.</li>\n  <li>Warnings about encoding query parameters.</li>\n  <li>Additional guidance regarding JWT added.</li>\n</ul>\n\n<h2 id=\"121-beta\">1.2.1-beta</h2>\n<p><em>Changes to restructure the Implementation Guide</em>.</p>\n<ul>\n  <li>Wording change for Internal errors.</li>\n  <li>Clearer guidance for pointer transitions (<em>Current to Superseded</em>).</li>\n  <li>Explanation added for the Superseded status.</li>\n  <li>Addition of example for deleting a pointer using masterIdentifier.</li>\n  <li>Pointer error handling and pointer lineage guidance added.</li>\n</ul>\n\n<h2 id=\"120-beta\">1.2.0-beta</h2>\n<p><em>Changes to restructure the Implementation Guide</em>.</p>\n<ul>\n  <li>Additional guidance added to the Data model page.</li>\n  <li>Cardinality corrected for <em>Related Documents</em></li>\n  <li>Added <em>Status</em> to the model.</li>\n  <li>Description updated for the elements.</li>\n  <li>Addition of new <em>API Interaction</em> section to describe the RESTful functionalities (Create, Delete, Search, and Update).</li>\n  <li>API Guidance &gt; Search page</li>\n  <li>Format guidance added for Custodian.</li>\n  <li>Inclusion of the <code class=\"highlighter-rouge\">_summary=count</code> functionality.</li>\n  <li>New Pointer-related pages added a new <em>Development Guidance</em> menu.</li>\n  <li>General API Guidance</li>\n  <li>Error guidance has been restructured to be more informative to the reader.</li>\n  <li>Addition of INTERNAL_SERVER_ERROR and the response format.</li>\n  <li>Exception tables moved from the API Interaction page to the General API Guidance page.</li>\n  <li>Deploy menu option removed</li>\n  <li>Assure menu option removed</li>\n</ul>\n\n<h2 id=\"110-beta\">1.1.0-beta</h2>\n\n<p><em>Changes to re-align the NRL API 1.1.0-beta Specification with the DDC March and May 2018 NRL Service Development Iterations:</em></p>\n\n<ul>\n  <li>Provider and Consumer API Read interaction removed.</li>\n  <li>Provider and Consumer API Search interaction changes:\n    <ul>\n      <li><code class=\"highlighter-rouge\">_count</code> Search parameter removed</li>\n      <li><code class=\"highlighter-rouge\">_id</code> Search parameter added</li>\n      <li><code class=\"highlighter-rouge\">type</code> Search parameter added</li>\n      <li><code class=\"highlighter-rouge\">patient</code> search parameter reverted to <code class=\"highlighter-rouge\">subject</code></li>\n      <li>Bundle type <code class=\"highlighter-rouge\">searchset</code> does not support:\n        <ul>\n          <li>Encoded client search parameters in returned bundle using the <code class=\"highlighter-rouge\">self link</code>.</li>\n          <li>The identity of resources in the entry using the <code class=\"highlighter-rouge\">fullUrl</code> element.</li>\n          <li>Resources matched in a successful search using the <code class=\"highlighter-rouge\">search.mode</code> element</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>Provider API Update interaction removed.</li>\n  <li>Provider API Delete interaction changes:\n    <ul>\n      <li>Now supports conditional delete interaction. Allows a provider to delete an existing pointer based on the search parameter <code class=\"highlighter-rouge\">_id</code> which refers to the logical id of the pointer.</li>\n    </ul>\n  </li>\n  <li>Spine response codes changes:\n    <ul>\n      <li>Amended for all Provider and Consumer API interactions</li>\n      <li>Successful Provider Create and Delete interactions now support positive response code values conveyed in the response body <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\">Spine-OperationOutcome-1</a> payload:\n        <ul>\n          <li>RESOURCE_CREATED</li>\n          <li>RESOURCE_ DELETED</li>\n        </ul>\n      </li>\n      <li>Error Handling section updated to reflect API re-alignment with DDC NRL Service implementation.</li>\n      <li>Exceptions raised by the Spine Core common requesthandler and not the NRL Service will be supported by the default Spine OperationOutcome <a href=\"https://fhir.nhs.uk/StructureDefinition/spine-operationoutcome-1-0\">spine-operationoutcome-1-0</a> profile which binds to the default Spine ValueSet <a href=\"https://fhir.nhs.uk/ValueSet/spine-response-code-1-0\">spine-response-code-1-0</a>. Codes include:\n        <ul>\n          <li>UNSUPPORTED_MEDIA_TYPE</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>Pagination removed from Provider and Consumer search API.</li>\n  <li>CapabilityStatement conformance functionality removed from this release.</li>\n  <li>For this release the NRL Service returns data as the default format of <code class=\"highlighter-rouge\">XML</code>.</li>\n  <li><a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRLS-DocumentReference-1\">NRLS-DocumentReference-1</a> FHIR profile upversioned to 1.1.0. Changes as follows:\n    <ul>\n      <li><a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRLS-RecordType-1\">ValueSet-NRLS-RecordType-1</a> replaces ValueSet/CarePlanType-1</li>\n      <li>ValueSet-NRLS-RecordType-1 supports a single SNOMED concept:  <code class=\"highlighter-rouge\">736253002 - Mental health crisis plan (record artifact)</code>.</li>\n      <li>All NRLS-DocumentReference-1 API examples updated to support record type: <code class=\"highlighter-rouge\">Mental health crisis plan (record artifact)</code>.</li>\n    </ul>\n  </li>\n  <li><a href=\"overview_interactions.html\">Solution Interactions</a> diagrams updated.</li>\n  <li>NRL access token (JWT) enhancements:\n    <ul>\n      <li>The NRL access token conforms to the Spine <a href=\"https://nhsconnect.github.io/FHIR-SpineCore/security_jwt.html\">JWT</a> definition.</li>\n      <li>New section <a href=\"integration_access_tokens_JWT.html\">Access Tokens and Audit (JWT)</a> added which replaces the Cross Organisation Audit &amp; Provenance section.</li>\n    </ul>\n  </li>\n  <li><a href=\"assure.html\">Assurance Process</a> overview added to specification.</li>\n</ul>\n\n<p><em>Sprint 6 Summary:</em></p>\n\n<ul>\n  <li>Concept of direct and indirect pointers removed from API. Changes to the <a href=\"overview_data_model.html#data-model\">Data Model</a> and the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRLS-DocumentReference-1\">NRLS-DocumentReference-1</a> FHIR profile as follows:\n    <ul>\n      <li>RecordRetrievalMode CodeableConcept functionality removed from the <a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRLS-DocumentReference-1\">NRLS-DocumentReference-1</a> FHIR profile.</li>\n      <li>The following dependent FHIR assets have been removed from NHS FHIR Server and implementation guide:\n        <ul>\n          <li>Extension-NRLS-RecordRetrievalMode-1</li>\n          <li>ValueSet-NRLS-RecordRetrievalMode-1</li>\n          <li>CodeSystem-NRLS-RecordRetrievalMode-1</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n\n<!--`custodian` search parameter dropped from Consumer API. In turn the combined `patient and custodian` search parameter has also been dropped from Consumer API. See the [Error Handling section](development_general_api_guidance.html#consumer-search-should-return-422-with-error-code-of-invalid_parameter-under-the-following-circumstances) for further guidance.\n- Additional Consumer and Provider API guidance added to [Parameters - INVALID_PARAMETER](development_general_api_guidance.html#parameters---invalid_parameter) Error Handling section.-->\n<ul>\n  <li>Consumer Provider API XML/ JSON examples added</li>\n  <li>HTTP request headers amendments:\n    <ul>\n      <li>Ssp-TraceID, Ssp-InteractionID, Ssp-Version - dropped from specification</li>\n      <li>Ssp-From and Ssp-To - Header name change to <code class=\"highlighter-rouge\">fromASID</code> and <code class=\"highlighter-rouge\">toASID</code></li>\n      <li>Error Handling section reflects these changes</li>\n    </ul>\n  </li>\n  <li>Consumer and Provider API <code class=\"highlighter-rouge\">INVALID_PARAMETER</code> error response code aligned to <code class=\"highlighter-rouge\">400</code> <em>BAD REQUEST</em> HTTP response code.</li>\n</ul>\n\n<h2 id=\"100-beta\">1.0.0-beta</h2>\n\n<p>Sprint 5 summary:</p>\n\n<ul>\n  <li><a href=\"development_general_api_guidance.html#error-handling\">Error Handling</a> section added to ‘General API Guidance’ page.</li>\n  <li>Consumer and Provider API error response examples refined.</li>\n  <li>Provider API Create and Update responses amended.</li>\n  <li>VersionId guidance added.</li>\n  <li>CapabilityStatement page updated.</li>\n  <li><a href=\"overview_behaviours.html#auditing\">Auditing</a> section added to ‘Solution Behaviour’ page.</li>\n  <li>Audit Trail section added to ‘Cross Organization Audit &amp; Provenance’ page.</li>\n  <li>JWT Claims updated:\n    <ul>\n      <li>‘device’ claim added - this is the Identifier (ASID) of the system where the request originates.</li>\n      <li>‘sub’ claim specification/ example has been updated.</li>\n    </ul>\n  </li>\n  <li><a href=\"integration_authentication_authorisation.html\">Authentication and Authorisation</a> page added - NRL strategic approach to align with ‘Care Access Service’ which will become NHS Digital’s national Authentication and Authorisation service.</li>\n  <li>JSON and XML examples added to <a href=\"explore_reference.html#7-examples\">Reference</a> section.</li>\n</ul>\n\n<h2 id=\"100-alpha\">1.0.0-alpha</h2>\n\n<p>Sprint 4 summary:</p>\n\n<ul>\n  <li>Consumer and Provider APIs ‘Success’ Search Response amended to support an empty bundle if search returns no matches.</li>\n  <li>Consumer API Search examples added.</li>\n  <li>Development Guidance section now supports ‘General API Guidance’ page. This includes implementation guide ‘notational conventions’ and RESTful API ‘content types’ sections.</li>\n  <li>The ‘Accept’ HTTP request header conformance amended to ‘MAY’.</li>\n</ul>\n\n<p>Sprint 3 summary:</p>\n\n<ul>\n  <li>Consumer and Provider APIs now support the ‘patient’ Search parameter. This replaces the ‘subject’ parameter.</li>\n  <li>Consumer and Provider APIs Search operations will not mandate the ‘_count’ parameter. It is expected that the NRL Server will support paging as a default to break up result-sets that exceed a pre-determined limit.</li>\n  <li>NRL API Conformance updated.</li>\n</ul>\n\n<p>Sprint 3 early release summary:</p>\n\n<ul>\n  <li>Record retrieval via the SSP will not be mandated.</li>\n</ul>\n\n<p>Sprint 2 summary:</p>\n\n<ul>\n  <li>Read Operation added to Consumer API.</li>\n  <li>Provider and Consumer API search capabilities aligned.</li>\n  <li>Pagination added to Provider and Consumer search API.</li>\n  <li>If-Match header (containing ETag) dropped from Provider API update and delete operations.</li>\n  <li>Security Guidance updated: TLSv1.2 must be supported for all new Spine interfaces and new cyphers added.</li>\n  <li>Implementation Guide semver use updated. No longer using pre-release numeric identifiers.</li>\n</ul>\n\n<p>Sprint 1 ‘internal’ review feedback amendments include:</p>\n\n<ul>\n  <li>References to SDS removed</li>\n  <li>Solution principles changed to reflect that the Provider controls the Record retrieval mechanism strategy</li>\n  <li>NRL will not be fronted by SSP i.e. requests to read/write Pointers will not go through the SSP in order to reach NRL</li>\n</ul>\n\n<p>First release of NRL FHIR API (STU3) via https://nhsconnect.github.io/.</p>\n\n<ul>\n  <li>Project follows the Gov.UK agile delivery phases.</li>\n</ul>\n\n<h2 id=\"100-experimental\">1.0.0-experimental</h2>\n\n<p>First draft of NRL DMS (Version 1.0 Draft A) created to support development of the Spine 2 POC National Record Locator interface.</p>\n\n<p>Published on <a href=\"https://data.developer.nhs.uk/fhir/nrls-v1-draft-a/Chapter.1.About/index.html\">NHS Developer Network</a>.</p>\n"
		
	}
	,

	{
		
		"title": "Pointer Errors",
		"tags": "pointersfor_providers",
		"keywords": "engage about",
		"url": "pointer_errors.html",
		"summary": "NRL Pointer Errors",
		"content": "<h2 id=\"pointer-errors\">Pointer Errors</h2>\n\n<p>The NRL API does not give Providers the ability to update the properties of an existing Pointer, other than the status property. The status property is modified in one of two ways.</p>\n\n<p>The first is where a Provider replaces one DocumentReference with another, known as superseding. See <a href=\"api_interaction_supersede.html\">API Interaction - Supersede</a> for details.</p>\n\n<p>The second is by performing a update to directly change the status of the pointer. See <a href=\"api_interaction_update.html\">API Interaction - Update</a> for details.</p>\n\n<h2 id=\"pointer-error-handling\">Pointer Error Handling</h2>\n\n<p>Errors happen. It is important to acknowledge this reality and to design a solution with this in mind. To that end, the NRL makes a distinction between the following kinds of error:</p>\n\n<ul>\n  <li>Errors with the Pointer metadata</li>\n  <li>Errors with the content (record/document) that the Pointer references</li>\n</ul>\n\n<h2 id=\"errors-with-the-pointer-metadata\">Errors with the Pointer Metadata</h2>\n\n<p>There are two scenarios in which a Pointer metadata error may occur:</p>\n<ul>\n  <li>Error with the data that the Provider system is using to create a Pointer</li>\n  <li>Defect in the Provider system that is creating and publishing Pointers</li>\n</ul>\n\n<p>These errors may lead to one the following two situations:</p>\n<ul>\n  <li>The Pointer itself should not have been added to the NRL</li>\n  <li>It is valid for the Pointer to exist, but there are problems with the data stored on a Pointer. For example, the record creation date might be incorrect.</li>\n</ul>\n\n<p>When the Provider realises there is a problem with the Pointer, action must be taken by the Provider. Depending on the nature of the problem, the Provider has different options when it comes to dealing with the issue.</p>\n\n<h3 id=\"pointer-should-not-have-been-added-to-nrl\">Pointer Should Not Have Been Added to NRL</h3>\n\n<p>In this case, as soon as the issue is recognised, the Provider should mark that Pointer’s status as entered-in-error.</p>\n\n<p>Note that it is important to do this before that Pointer has been superseded, as once that transition has been made it is not possible to mark a Pointer as entered-in-error — see <a href=\"pointer_lifecycle.html\">Pointer lifecycle</a>. Only those Pointers with a status of current can be moved to the entered-in-error state.</p>\n\n<p>If a Provider finds that one of its superseded Pointers should not have been registered with the NRL, the entire lineage of that Pointer is considered corrupted. The Provider must mark the Pointer at the head of the lineage (the “current” Pointer) as being entered-in-error.</p>\n\n<p>The Provider should then recreate a new “current” pointer with the correct information in place of the Pointer that was marked as entered-in-error.</p>\n\n<h3 id=\"pointer-data-is-invalid\">Pointer Data Is Invalid</h3>\n\n<p>Where the presence of the Pointer on NRL is valid but the data it holds is invalid, the Provider should update the pointer’s status to entered-in-error and create a new pointer that contains the correct data.</p>\n\n<h2 id=\"errors-with-the-content-recorddocument-that-the-pointer-references\">Errors with the Content (Record/Document) that the Pointer References</h2>\n\n<p>The Provider should correct the content using whatever local processes are in place. This may necessitate the creation of a new version of the content, in which case it may be appropriate to replace the current Pointer with a new one. Alternatively, the correction to the content may be such that the existing Pointer transparently references the corrected content. In either case, responsibility for ensuring that the referenced content is correct rests with the Provider.</p>\n"
		
	}
	,

	{
		
		"title": "Pointer Identity",
		"tags": "pointersfor_providersfor_consumers",
		"keywords": "engage about",
		"url": "pointer_identity.html",
		"summary": "NRL Pointer Identity",
		"content": "<h2 id=\"pointer-identity\">Pointer Identity</h2>\n\n<p>Once persisted within the NRL there are up to two ways to refer to a specific Pointer instance. Both are identifiers that are stored on the Pointer itself, but the master identifier is optional and is specified by the Provider.</p>\n\n<ul>\n  <li>\n    <p>Logical identifier – This identifier is assigned by the NRL service when it persists a Pointer. It uniquely identifies that Pointer within the NRL service. The NRL service instance is the namespace for a given Pointer’s Logical identifier.</p>\n  </li>\n  <li>\n    <p>Master identifier – This also uniquely identifies the Pointer within the boundary of the NRL service. However, unlike the logical identifier, the master identifier is optional and is under the control of the Provider. For more details, see the <a href=\"#master-identifier\">Master Identifier</a> and <a href=\"#uniqueness\">Uniqueness</a> sections below.</p>\n  </li>\n</ul>\n\n<h3 id=\"logical-identifier\">Logical Identifier</h3>\n\n<p>The logical identifier (ID) is generated by the NRL during the creation of a new Pointer. It is unique across all Pointers on the NRL service that created the Pointer. If the Pointer were ever to be migrated to a different NRL service instance then it is possible that its ID might need to change to avoid clashes with Pointers on the target NRL service.</p>\n\n<p>The format of the ID is under the control of the NRL service. Clients should treat the id as an opaque identifier. In other words, the client should not make assumptions about the structure of the ID.</p>\n\n<h3 id=\"master-identifier\">Master Identifier</h3>\n\n<p>The master identifier is an optional identifier on the Pointer. It is under the control of the Provider. Guidance on the use of a unique master identifier value:</p>\n\n<ul>\n  <li>Once a pointer with a master identifier value has been created, that same master identifier value must not be re-used with another pointer.</li>\n  <li>‘Superseding’ requires a new master identifier value. If a pointer is superseded, the new Pointer that replaces it must have a new, unique master identifier value.</li>\n  <li>Once a pointer with a master identifier is deleted, the master identifier value used in that pointer cannot be used again on the NRL.</li>\n</ul>\n\n<h3 id=\"uniqueness\">Uniqueness</h3>\n\n<p>It is important that the master identifier be unique. The scope of that uniqueness is recommended to extend beyond the NRL service that the Pointer was originally created on. This is to support the notion that master identifier is a business identifier — it is tied to a specific Pointer and should never change regardless of which NRL service the Pointer is on.\nIn terms of the uniqueness of a given master identifier, a Pointer can be seen be seen as existing in a collection of namespaces:</p>\n\n<ul>\n  <li>Patient — the smallest namespace in NRL. The set of master identifiers associated with a given Patient.</li>\n  <li>Provider — this namespace spans Patients but is constrained to those Pointers owned by a given Provider.</li>\n  <li>NRL — the largest namespace, which holds both the Patient and Provider namespaces.</li>\n</ul>\n\n<p>Each of the namespaces are discussed in more detail below in particular who is responsible for ensuring that a given Master identifier is unique in that space and the consequences of failing to ensure uniqueness. Overall though, the content can be summarised as one strong recommendation to Providers:</p>\n\n<p><strong><em>Providers should use a unique value for the Master identifier.</em></strong></p>\n\n<h3 id=\"patient-namespace\">Patient Namespace</h3>\n\n<p>The NRL guarantees that no two Pointers for the same Patient (identified by NHS number) will have the same master identifier. If the Provider attempts to create a Pointer using a master identifier that has already been assigned to one of that patient’s other Pointers, the Provider’s request will be blocked.</p>\n\n<h3 id=\"provider-namespace\">Provider Namespace</h3>\n\n<p>It is the Provider’s responsibly to ensure that the Master identifiers that it creates are unique across all of its own Pointers. It is perfectly possible for a Provider to create Pointers for different patients with the same master identifier. The NRL service will not prevent this scenario from arising.</p>\n\n<h3 id=\"nrl-namespace\">NRL Namespace</h3>\n\n<p>It is the Provider’s responsibly to ensure that the master identifiers that it creates are unique across all Pointers in the NRL. It is not unheard of for organisations to merge. In this case the Pointers previously owned by two organisations will come under the ownership of one of those organisations.</p>\n\n<p>To provide the NRL with a degree of flexibility in terms of deployment, a Provider should not assume that there is a single instance of the NRL service. With this constraint in mind, the uniqueness of a Master identifier extends across NRL instances.</p>\n\n<p>In the end, we arrive back at the recommendation made at the beginning of this section:</p>\n\n<p><strong><em>Providers should use a unique value for the Master identifier.</em></strong></p>\n\n<h3 id=\"unique-value-for-the-master-identifier\">Unique Value for the Master Identifier</h3>\n\n<p>The NRL recommends the use of a unique value when assigning a value for a Master identifier. To avoid the negative scenarios outlined above the value should be unique within the NRL namespace.</p>\n\n<p>The problem of uniquely identifying an entity such as a Pointer is not a new one and there are several standard ways of generating a unique value. Two approaches of note are:</p>\n\n<ul>\n  <li>\n    <p>The Universally Unique Identifier (UUID) – the uniqueness of a UUID is based on the extremely low chance that the same 128-bit random number will be generated twice. There exist a wealth of libraries that will generate a UUID that result in the practical likelihood that a UUID is unique being very high.</p>\n  </li>\n  <li>\n    <p>Object Identifier (OID) – An OID is a set of decimal numbers called arcs that are separated by periods. The OID system relies on the concept of authorities who can hand out an OID that is guaranteed to be unique. From there, the owner of that OID can itself act as an authority handing out an arc to another organisation that is unique below the owner’s arc. This process can repeat and repeat creating a chain of arcs that are all unique within the scope of their parent arc.</p>\n  </li>\n</ul>\n\n<p>As long as all organisations execute their responsibility to ensure uniqueness, the OID system provides a stronger guarantee of uniqueness than the UUID. However, it does rely on all members of an OID chain making sure that they do not reuse an value when assigning an arc to a child.</p>\n"
		
	}
	,

	{
		
		"title": "Pointer Lifecycle",
		"tags": "pointersfor_providersfor_consumers",
		"keywords": "engage about",
		"url": "pointer_lifecycle.html",
		"summary": "NRL Pointer Lifecycle",
		"content": "<h2 id=\"pointer-lifecycle\">Pointer Lifecycle</h2>\n\n<p>A Pointer is a reference to some content, which is stored on a system external to NRL. It has its own lifecycle that is managed by a third party (the Record owner). The Pointer lifecycle as described by NRL defines the statuses and permitted transitions between those statuses for the pointer. The statuses and transitions ensure that only the appropriate pointers are shown to Consumers.</p>\n\n<h2 id=\"pointer-status\">Pointer Status</h2>\n\n<p>A Pointer can be in one of three possible statuses:</p>\n<ul>\n  <li>“current” - Indicates that the Pointer metadata and record URL are valid and can be used to inform clinical decision making. The definition of “current” is under the control of the Provider, but a Consumer should be confident that by selecting the Pointer they will be presented with a document or record that the Provider considers to be appropriate for Consumers to use.</li>\n  <li>“superseded” – Indicates that this Pointer has been replaced by an updated version. This could be a Pointer with updated metadata or an updated reference to a document. Note that this represents the status of the pointer and does not necessarily indicate a previous version of a document.</li>\n  <li>“entered-in-error” – Indicates that the Pointer should not have been entered into the NRL, as it is not valid. This could be for a number of reasons, including errors in either the pointer metadata or the record/document itself. This status allows a Provider to mark a Pointer as erroneous without needing to delete it.</li>\n</ul>\n\n<p>Only pointers with the status of “current” are made available to Consumers. The statuses “superseded” and “entered-in-error” are in use in the Pointer Lifecycle for pointer management and auditing purposes.</p>\n\n<h2 id=\"pointer-status-legal-transitions\">Pointer Status: Legal Transitions</h2>\n\n<p>Not only is the value of a Pointer’s status constrained, but the transition from one status to another is also tightly controlled.</p>\n\n<p><img src=\"images/pointers/pointer_transitions.png\" alt=\"Pointer transitions\" /></p>\n\n<p><strong><em>Figure 1: Status transitions: The NRL controls the transition from one status to another. It is not possible to transition from any given status to any other.</em></strong></p>\n\n<p>All Pointers begin life with a status of current. From there, it is possible to move to either the superseded or entered-in-error statuses.</p>\n\n<p>Once in the superseded or entered-in-error statuses, the Pointer cannot transition anywhere else. One cannot build a chain of Pointers on top of a Pointer with a status other than current. Only the current Pointer can be used in this way by superseding it and replacing it with a new version that becomes the current Pointer. See the <a href=\"#pointer-status-transition-worked-examples\">Pointer status transition: worked examples</a> section for details on how the NRL allows a Provider to transition the status of its Pointers.</p>\n\n<h2 id=\"pointer-status-making-transitions\">Pointer Status: Making Transitions</h2>\n\n<p>When a Pointer is first created it will always have a status of current. \nFrom there it is possible to supersede that Pointer or to mark it as entered-in-error. Figure 2 below illustrates the NRL functions that must be invoked in order to trigger the transition from one state to another (legal) state.</p>\n\n<p><img src=\"images/pointers/pointer_transitions2.png\" alt=\"Allowed pointer interactions\" /></p>\n\n<p><strong><em>Figure 2: Interactions to transition between statuses: The NRL allows a Provider to transition its Pointers’ status using a combination \nof create and update actions.</em></strong></p>\n\n<p>One transition that is worth expanding on is the transition from current to superseded. In this case, an existing Pointer (P1) with a status of current is to be superseded (replaced) by a new Pointer (P2). P2 will become the current Pointer, and P1 will become superseded.</p>\n\n<p>In order to supersede a pointer, there must always be a newer version. Therefore, to ensure the transactional integrity of this activity, which spans two Pointers (P1 and P2 in our example), the action is wrapped up into the CREATE of P2. More details on the mechanics of this are provided in the <a href=\"pointer_maintenance.html#managing-pointers-to-content\">Managing Pointers to content</a> section.</p>\n\n<h2 id=\"pointer-status-transition-worked-examples\">Pointer Status Transition: Worked Examples</h2>\n\n<p>Note that in the diagrams below, three properties from the Pointer data model are referenced. One of them is the version. \nThis is the version of the Pointer, not the version of the content referenced. Each time a particular instance of a Pointer is modified, the NRL service will increment the version by one, as can be seen in several of the worked examples.</p>\n\n<p><strong><em>Null to current</em></strong></p>\n\n<p>As a Provider, I want to create a new Pointer on the NRL, so that Consumers are aware of a resource that I own.</p>\n\n<p><img src=\"images/pointers/pointer_transitions3.png\" alt=\"Null to current\" /></p>\n\n<p>The Provider CREATEs a brand new Pointer, transitioning from the null state (no Pointer exists) to a newly-minted Pointer, whose status can only be current.</p>\n\n<p><strong><em>Current to superseded (replaced)</em></strong></p>\n\n<p>As a Provider, I want to create a new Pointer on NRL that supersedes one of my existing Pointers, so that Consumers have access to the latest information regarding my resource.</p>\n\n<p><img src=\"images/pointers/pointer_transitions4.png\" alt=\"Current to superseded (replaced)\" /></p>\n\n<p>As part of the CREATE action for the new Pointer, the Provider describes a relationship between the new and existing (obsoleted) Pointer. The NRL uses this relationship to create a new Pointer, marking it as current. It also deprecates the existing Pointer by marking it as superseded and modifying its version to reflect the change.</p>\n\n<p><strong><em>Current to entered-in-error</em></strong></p>\n\n<p>As a Provider, I want to mark an existing Pointer as entered-in-error, so that Consumers know not to base any clinical decisions \non the Pointer or the resource that it references.</p>\n\n<p><img src=\"images/pointers/pointer_transitions5.png\" alt=\"Current to entered-in-error\" /></p>\n\n<p>The Provider must UPDATE the existing resource, changing its status from current to entered-in-error. In doing so, the NRL will modify its version to reflect the change.</p>\n\n<h2 id=\"deleting-pointers\">Deleting Pointers</h2>\n\n<p>If a pointer is no longer valid or appropriate for use and should not be superseded or marked as “entered-in-error”, then the pointer should be deleted.</p>\n"
		
	}
	,

	{
		
		"title": "Pointer Maintenance",
		"tags": "pointersfor_providersfor_consumers",
		"keywords": "engage about",
		"url": "pointer_maintenance.html",
		"summary": "NRL Pointer Maintenance",
		"content": "<h2 id=\"overview\">Overview</h2>\n\n<p>The NRL allows a Provider to perform four interactions in relation to Pointers:</p>\n<ul>\n  <li>Create — Results in the storage of a brand new Pointer in NRL</li>\n  <li>Update — Modify the status of an existing Pointer in NRL</li>\n  <li>Supersede — Replace a pointer. This interaction marks the pointer as superseded and creates a new Pointer in the NRL</li>\n  <li>Delete — Remove an existing Pointer from NRL. This Pointer will no longer appear in search results</li>\n</ul>\n\n<p>A Pointer’s main role is to refer to another entity, which is some kind of content. The content may be static or dynamic.</p>\n\n<p>Because of this, when considering Pointer maintenance, we must consider the maintenance of two entities:</p>\n<ul>\n  <li>Changes to the Pointer’s data — the referenced content has not changed, but one or more of the data items captured on the Pointer needs to be modified. In this case, Providers should supersede the existing resource, resulting in the creation of a new Pointer with updated data items.</li>\n  <li>Changes to the referenced content — in this case, Providers should supersede the existing resource, resulting in the creation of a new Pointer that references the modified content.</li>\n</ul>\n\n<h2 id=\"creation-of-a-new-pointer\">Creation of a New Pointer</h2>\n\n<p>The rules around when a Pointer is created will vary from Provider to Provider, because different business processes \nwill be at play within their organisations. Having said that, there is some general guidance that can be given around when creation \nof a new pointer is appropriate.</p>\n\n<p>As discussed in the <a href=\"overview_concepts.html\">concepts section</a>, the NRL has the concept of a static and dynamic content in relation to what the Pointer is referencing. Static content will never change, whereas dynamic content is not guaranteed to be the same from one point in time to another in the future.</p>\n\n<h4 id=\"static-content\">Static Content</h4>\n\n<p>Static content is typically content that undergoes version control. When a change is needed, rather than changing the content directly, \na new version is created. This new version builds on the original and contains the modified content. Once the changes are complete, this new version is then considered immutable and becomes the current version, replacing the previous one. Rather than NRL holding one Pointer that references the current version of the content, it is recommended that Providers add a new Pointer for each version of their content.</p>\n\n<p>What constitutes a new version is left up to Providers, as it is difficult to prescribe a global versioning policy. What is expected, however, is that there is only ever one current version of a Pointer for an item of content.</p>\n\n<p><img src=\"images/pointers/pointer_maintenance1.png\" alt=\"Versioning of static content\" /></p>\n\n<p><strong><em>Figure 1: How different versions of static content are reflected in NRL. For each new version of static content, a new Pointer is created with a status of current, and the previous version moves from current to superseded.</em></strong></p>\n\n<h4 id=\"dynamic-content\">Dynamic Content</h4>\n\n<p>Dynamic content makes none of the guarantees that static content makes. With static content, the consumer can be certain that the content will always be the same, regardless of the time it was retrieved. In contrast, dynamic content can vary depending upon when it was retrieved.</p>\n\n<p>Dynamic content will typically be served up via an API. It is the lifecycle of the API that can be used to decide when referenced content has changed sufficiently to warrant an existing Pointer being superseded.</p>\n\n<p>Examples of the kinds of things that Providers should consider as triggers to supersede a Pointer are:</p>\n<ul>\n  <li>API contract</li>\n  <li>API data sources</li>\n  <li>API URL change or deprecation</li>\n</ul>\n\n<h4 id=\"api-contract\">API Contract</h4>\n\n<p>This involves changes to the way that a Consumer would interact with the API. This can cover changes in a number of areas:</p>\n\n<ul>\n  <li>Data model — If the model that the content conforms to is changed, the Consumer may no longer be able to interpret the content.</li>\n  <li>MIME type — If the format of the content as it is delivered to the Consumer changes, then Consumer may no longer be able to render the content.</li>\n  <li>Security — If the mechanism for accessing secured content changes, the Consumer may not be able to access the content.</li>\n  <li>Protocol — If the way the content is exchanged between Provider and Consumer changes, the Consumer may no longer be able to negotiate content retrieval.</li>\n</ul>\n\n<h4 id=\"api-data-sources\">API Data Sources</h4>\n\n<p>It is possible that the API is drawing data from multiple sources before aggregating the content ready for the Consumer. If the aggregating system is modified to draw data from additional sources, or one source is replaced with another, the content could be considered to have changed to such a degree that it should be reflected by superseding the current Pointer.</p>\n\n<h4 id=\"api-url-change-or-deprecation\">API URL Change Or Deprecation</h4>\n\n<p>If the URL of the API changes, or the API becomes deprecated, a new Pointer should be created and the old one marked as superseded to prevent Consumers from attempting to retrieve content from a non-existent or non-current location.</p>\n\n<h2 id=\"deleting-an-existing-pointer\">Deleting an Existing Pointer</h2>\n\n<p>Deleting a Pointer should only be done in exceptional circumstances. Under most circumstances, a Pointer should be replaced (superseded). If the Provider realises that the Pointer is simply not valid, then it should be updated and marked as entered in error. If the Provider does want to delete the Pointer, it should be done as soon as possible after creation to limit exposure to Consumers. However, even in this circumstance, the Provider should consider marking the Pointer as entered in error instead.</p>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> When a Pointer is deleted from the NRL, it is marked as \"inactive\", as opposed to being removed completely. This is commonly known as a \"soft deletion\". Once a Pointer is deleted, the Pointer can no longer be viewed or edited by any Consumer or Provider.</div>\n\n<h2 id=\"updating-an-existing-pointer\">Updating an Existing Pointer</h2>\n\n<p>An update will be invoked on a Pointer when the Provider needs to change its status from current to entered-in-error. Providers can only change the status property on an existing Pointer. When any other attribute on the Pointer needs to be changed, the Pointer should be superseded, replacing it with an updated version.</p>\n\n<h2 id=\"managing-pointers-to-content\">Managing Pointers to Content</h2>\n\n<p>As noted above in the <a href=\"#overview\">overview</a> section, when a new version of content is created, a new Pointer should be created to reference the new content. Each time a new version of a Pointer is created, the existing one will be marked as superseded, and the new Pointer becomes current. For more detail, see Figure 2.</p>\n\n<p>This is achieved through the combined use of three properties on the Pointer:</p>\n<ul>\n  <li>Status</li>\n  <li>Master identifier or logical identifier</li>\n  <li>Related pointers</li>\n</ul>\n\n<p><img src=\"images/pointers/pointer_maintenance2.png\" alt=\"Pointer versioning\" /></p>\n\n<p><strong><em>Figure 2: How Pointer versions are maintained in NRL. Each time a new Pointer version is needed, the create message should reference the master identifier or logical identifier of the Pointer to be superseded.</em></strong></p>\n\n<p>When the first version of a Pointer is created, the Provider specifies its status as current and can optionally assign a master identifier value (<code class=\"highlighter-rouge\">1</code> in Figure 2). In this first version of the Pointer, the related pointers collection will be empty.</p>\n\n<p>The end result of asking the NRL to create that Pointer is illustrated on the left-hand side of Figure 2 above – a Pointer has been persisted with a Provider-issued master identifier and a status of current.</p>\n\n<p>At some point in the future, the Provider determines that a new version of the Pointer should be created, perhaps because the static content that the original Pointer references has changed. In this case, the Provider wants a new Pointer to be created to reference the new static content and the existing Pointer to be marked as superseded.</p>\n\n<p>The NRL supports this transition by leveraging the related pointers property in conjunction with the status property and the master identifier or logical identifier. The Provider creates a new Pointer where the status is marked as current, with a master identifier value (<code class=\"highlighter-rouge\">2</code> in Figure 2) that is different from the existing Pointer’s master identifier (see <a href=\"pointer_identity.html\">Pointer identity</a> for more detail), and the related pointers collection is populated with the master identifier of the existing Pointer (<code class=\"highlighter-rouge\">1</code> in Figure 2).</p>\n\n<p>Upon receipt of this Pointer, the NRL resolves the related Pointer and sets its status to superseded. Once this is successfully completed, the NRL persists the new pointer. The end result is that the NRL is now in the state described above: two Pointers exist where one has been superseded by the other. This pattern of superseding can be repeated indefinitely by a Provider, leading to multiple superseded versions of a Pointer, but there can only ever be one current version.</p>\n\n<h2 id=\"pointer-lineage\">Pointer Lineage</h2>\n\n<p>A consequence of creating a relationship between Pointers where one supersedes another is that a lineage of Pointers is created.</p>\n\n<p>In this context, “lineage” describes the line of descendants of an original Pointer. This line in effect describes each of the different versions of the content that each Pointer references. It is a view of the evolution of the content, with the oldest content being replaced by newer content.</p>\n\n<p><img src=\"images/pointers/pointer_lineage.png\" alt=\"Pointer lineage\" /></p>\n\n<p><strong><em>Figure 3: Pointer lineage. As soon as a Pointer is replaced (superseded) by another one, a lineage of related Pointers is created.</em></strong></p>\n\n<p>Figure 3 above illustrates the lineage concept. Three Pointers exists in NRL (1, 2, and 3). Pointer 1 was the original and references content in the Provider’s system. After Pointer 1 was published, a new version of the content referenced was created. This triggered the Provider to publish a new Pointer (2) that superseded Pointer 1. Finally, the process was repeated with Pointer 3, which references the newest version of the content.</p>\n"
		
	}
	,

	{
		
		"title": "FHIR Open-Source Resources",
		"tags": "development",
		"keywords": "fhir development open source",
		"url": "explore_fhir_open_source_guidance.html",
		"summary": "Details of open-source FHIR libraries.",
		"content": "<!--tags: [fhir,development]-->\n\n<h2 id=\"1-open-source-fhir-libraries\">1. Open-Source FHIR Libraries</h2>\n\n<p>The following open-source FHIR libraries are available on GitHub:</p>\n\n<ul>\n  <li>C#.NET <a href=\"https://github.com/ewoutkramer/fhir-net-api\" target=\"_blank\">FHIR NET API</a></li>\n  <li>Java <a href=\"https://github.com/jamesagnew/hapi-fhir\" target=\"_blank\">HAPI FHIR</a></li>\n  <li>JavaScript <a href=\"https://github.com/smart-on-fhir/client-js\" target=\"_blank\">Smart on FHIR</a></li>\n  <li>Python <a href=\"https://github.com/smart-on-fhir/client-py\" target=\"_blank\">Smart on FHIR</a></li>\n</ul>\n\n<h2 id=\"2-open-source-fhir-reference-servers\">2. Open-Source FHIR Reference Servers</h2>\n\n<p>The following open-source FHIR Reference servers:</p>\n\n<ul>\n  <li>C#.NET <a href=\"http://spark.furore.com/\" target=\"_blank\">Spark FHIR Server</a></li>\n  <li>Java <a href=\"http://hapifhir.io/\" target=\"_blank\">HAPI FHIR</a></li>\n  <li><a href=\"http://docs.smarthealthit.org/sandbox/\" target=\"_blank\">SMART on FHIR</a></li>\n</ul>\n"
		
	}
	,

	{
		
		"title": "Development Overview",
		"tags": "developmentfor_providersfor_consumers",
		"keywords": "getcarerecord structured rest resource",
		"url": "explore.html",
		"summary": "Overview of the Development section",
		"content": "<h2 id=\"1-nrl-api-overview\">1. NRL API Overview</h2>\n\n<p>The NRL API supports the following operations as detailed in the <a href=\"overview_interactions.html\">Solution Interactions</a> section of this implementation guide:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Interaction</th>\n      <th>HTTP Verb</th>\n      <th>Actor</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"api_interaction_read.html\">Read</a></td>\n      <td>GET</td>\n      <td>Consumer</td>\n      <td>Retrieve a single pointer by Logical ID</td>\n    </tr>\n    <tr>\n      <td><a href=\"api_interaction_search.html\">Search</a></td>\n      <td>GET</td>\n      <td>Consumer</td>\n      <td>Parameterised search for pointers on the NRL</td>\n    </tr>\n    <tr>\n      <td><a href=\"api_interaction_create.html\">Create</a></td>\n      <td>POST</td>\n      <td>Provider</td>\n      <td>Create a pointer on NRL</td>\n    </tr>\n    <tr>\n      <td><a href=\"api_interaction_supersede.html\">Create (Supersede)</a></td>\n      <td>POST</td>\n      <td>Provider</td>\n      <td>Replace an NRL pointer, changing the status of the replaced pointer to “superseded”</td>\n    </tr>\n    <tr>\n      <td><a href=\"api_interaction_update.html\">Update</a></td>\n      <td>PATCH</td>\n      <td>Provider</td>\n      <td>Update an NRL pointer to change the status to “entered-in-error”</td>\n    </tr>\n    <tr>\n      <td><a href=\"api_interaction_delete.html\">Delete</a></td>\n      <td>DELETE</td>\n      <td>Provider</td>\n      <td>Delete an NRL pointer</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>A system can be assured to perform both Consumer and Provider interactions, provided that all relevant prerequisites and requirements are met.</p>\n\n<h2 id=\"2-prerequisites-for-nrl-api\">2. Prerequisites for NRL API</h2>\n\n<h3 id=\"21-nrl-server-api-conformance\">2.1 NRL Server API Conformance</h3>\n\n<ul>\n  <li>\n    <p>MUST support HL7 FHIR STU3 version 3.0.1.</p>\n  </li>\n  <li>\n    <p>MUST implement REST behavior according to the <a href=\"http://www.hl7.org/fhir/STU3/http.html\">FHIR specification</a>.</p>\n  </li>\n  <li>\n    <p>MUST support XML <strong>or</strong> JSON formats for all API interactions.</p>\n  </li>\n</ul>\n\n<h3 id=\"22-nrl-client-api-conformance\">2.2 NRL Client API Conformance</h3>\n\n<ul>\n  <li>\n    <p>MUST support HL7 FHIR STU3 version 3.0.1.</p>\n  </li>\n  <li>\n    <p>MUST support XML <strong>or</strong> JSON formats for all API interactions.</p>\n  </li>\n  <li>\n    <p>SHOULD support the NRL Service RESTful interactions and search parameters.</p>\n  </li>\n</ul>\n\n<h3 id=\"23-spine-services\">2.3 Spine Services</h3>\n\n<p>The NRL API is accessed through the NHS Spine. Providers and consumers of the NRL API are required to integrate with the following Spine services as a pre-requisite to calling the NRL API:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>National Service</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Personal Demographics Service (PDS)</td>\n      <td>National database of NHS patients containing details such as name, address, date of birth, and NHS Number (known as demographic information).</td>\n    </tr>\n  </tbody>\n</table>\n\n<h4 id=\"detailed-spine-services-prerequisites\">Detailed Spine Services Prerequisites</h4>\n\n<p>To use this API, both Provider and Consumer systems:</p>\n\n<ul>\n  <li>MUST have been accredited and received an endpoint certificate and associated ASID (Accredited System ID) for the client system.</li>\n  <li>MUST pass the system/organisation’s information in a JSON web token - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</li>\n  <li>MUST have previously traced the patient’s NHS Number using PDS or an equivalent service.</li>\n</ul>\n\n<p>In addition, Consumer systems:</p>\n\n<ul>\n  <li>MUST have authenticated the user using NHS Identity or national smartcard authentication and obtained a the user’s UUID and associated RBAC role.</li>\n  <li>MUST pass the user’s information in the JSON web token.</li>\n</ul>\n\n<h3 id=\"24-nhs-number\">2.4 NHS Number</h3>\n\n<p>NHS Numbers used with FHIR API profiles MUST be verified. NHS Numbers can be verified using a full PDS Spine-compliant system (HL7v3), a <a href=\"https://nhsconnect.github.io/spine-smsp/\">Spine Mini Services Provider (HL7v3)</a>, or a <a href=\"https://developer.nhs.uk/library/systems/demographic-batch-service-dbs/\">Demographics Batch Service (DBS)</a> batch-traced record (CSV).</p>\n\n<p>The option of using a DBS service is for Provider systems only. Consumers performing a search operation MUST use either a full PDS Spine compliant system or a Spine Mini Services Provider.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> A verified NHS Number exists on PDS, is still in use, and the demographic data supplied results in the correct degree of demographic matching as per PDS matching rules.<br /><br />The NHS NUMBER is 10 numeric digits in length. The tenth digit is a check digit used to confirm its validity. The check digit MUST be validated using the Modulus 11 algorithm.</div>\n\n<h2 id=\"3-explore-the-nrl\">3. Explore the NRL</h2>\n\n<p>You can explore and test the NRL GET, POST, and DELETE commands and responses using Swagger in the <a href=\"https://data.developer.nhs.uk/nrls-ri/index.html\">NRL API Reference Implementation</a>.</p>\n"
		
	}
	,

	{
		
		"title": "Access Controls",
		"tags": "securityauthorisationspine_secure_proxy",
		"keywords": "RBAC authorisation documentreference",
		"url": "explore_rbac_mapping.html",
		"summary": "Overview of the access controls for NRL pointers",
		"content": "<h2 id=\"overview\">Overview</h2>\n\n<p>Access to NRL records is determined by Record Groups, where a Record Group contains one or more Record Types. Access to each Record Group is controlled by Role Based Access Control (RBAC) codes from the <a href=\"https://developer.nhs.uk/apis/spine-core/security_rbac.html\">National RBAC Database</a> and administered by an RA Managers within Trusts.</p>\n\n<p>For each Record Group there are two RBAC codes:</p>\n\n<ol>\n  <li>\n    <p>The first RBAC code will allow a user to view pointers only (for all the Record Types in that Record Group)</p>\n  </li>\n  <li>\n    <p>The second RBAC code will allow a user to view pointers and retrieve records (for all the Record Types in that Record Group)</p>\n  </li>\n</ol>\n\n<p>The two RBAC codes support the needs of different roles. For example, many clerical roles may only need to view pointers whereas most clinical roles will need to view pointers and retrieve records. This model of access is illustrated in the following diagram, with each box representing a separate RBAC code.</p>\n\n<p><img alt=\"Three Record Groups, each of which contains one RBAC code for pointer-only access and another for pointer-and-record access\" src=\"images/authorisation/record_group_diagram.png\" style=\"width:65%;max-width: 100%;margin: 0 auto;display: block;\" /></p>\n\n<p>A user may have access to one or more Record Groups depending on the information needs of their role. Please note that there is currently only one Record Group, but this is expected to change as more Record Types are added to the NRL. To work out which RBAC codes should be applied to a user, refer to the RBAC Mapping Table in the following section. A user should have only one RBAC code for each Record Group assigned to them by their Trust’s RA Manager.</p>\n\n<h2 id=\"rbac-mapping-table\">RBAC Mapping Table</h2>\n\n<p>This table outlines how records are allocated to different RBAC codes and whether an RBAC code provides <strong>pointer-only access</strong> or <strong>pointer and record access</strong>. The exact RBAC codes will be provided to an organisation once they complete the onboarding process.</p>\n\n<table>\n    <thead>\n        <tr>\n            <th>Record Group</th>\n            <th>Record Types Contained</th>\n            <th>Access Level</th>\n            <th>RBAC Code</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td rowspan=\"2\">Record Group 1</td>\n            <td rowspan=\"2\">Mental health crisis plan</td>\n            <td>Pointer-only access</td>\n            <td>Bxxxx</td>\n        </tr>\n        <tr>\n            <td>Pointer and record access</td>\n            <td>Bxxxy</td>\n        </tr>\n  </tbody>\n</table>\n\n<p>The RBAC codes listed in this mapping table are limited by the number of <a href=\"overview_glossary.html#record-type\" data-toggle=\"tooltip\" title=\"The clinical type of a record as defined by SNOMED-CT code. The clinical types permitted on the NRL are defined by a controlled list.\">Record Types</a> currently available on the NRL. As additional Record Types are added to the NRL, the associated RBAC codes will be added to this table.</p>\n\n<p>The <a href=\"overview_glossary.html#record-group\" data-toggle=\"tooltip\" title=\"A grouping that contains one or more Record Types.\">Record Group</a> that a Record Type fits into depends on its sensitivity. Record group 1 is a general grouping, to contain the majority of Record Types that are not deemed to be sensitive. Further Record Groups will be added if additional Record Types are deemed to need more restrictive controls. Using additional Record Groups for such Record Types ensures that they are protected by further access controls and will not routinely be available to the majority of NRL users.</p>\n"
		
	}
	,

	{
		
		"title": "FHIR Profile Reference",
		"tags": "developmentfhir",
		"keywords": "development reference",
		"url": "explore_reference.html",
		"summary": "Developer Cheat Sheet shortcuts for the technical build of NRL API.",
		"content": "<h2 id=\"1-profiles\">1. Profiles</h2>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> The NRL DocumentReference profile has been updated and has also been renamed from <b>NRLS-DocumentReference-1</b> to <b>NRL-DocumentReference-1</b>.</div>\n\n<p>Links to the NRL FHIR profiles on the NHS FHIR Reference Server.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Profile</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\">NRL-DocumentReference-1</a></td>\n      <td>A DocumentReference resource is used to describe a record that is made available to a healthcare system.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1\">Spine-OperationOutcome-1</a></td>\n      <td>Operation Outcome resource that supports a collection of error, warning or information messages that result from a NRL Service Spine interaction.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/StructureDefinition/spine-operationoutcome-1-0\">Spine-OperationOutcome-1-0</a></td>\n      <td>The default Spine OperationOutcome profile resource that supports exceptions raised by the Spine common requesthandler and not the NRL Service.</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Major changes to the pointer model will be reflected in the NRL DocumentReference FHIR profile, using the naming convention <code class=\"highlighter-rouge\">NRL-DocumentReference-[major_version]</code>. <br /><br /> The FHIR profile which the pointer conforms to will be indicated in the <code class=\"highlighter-rouge\">DocumentReference.meta.profile</code> metadata attribute to enable Consumers to support the different versions of the pointer model. Pointers conforming to the NRLS-DocumentReference-1 profile (v1.2.3-beta specification) will not have this attribute populated.</div>\n\n<h2 id=\"2-nrl-data-model-to-fhir-profile-mapping\">2. NRL Data Model to FHIR Profile Mapping</h2>\n\n<p>The table maps the ‘lean alpha’ <a href=\"overview_data_model.html\">Solution Data Model</a> to NRL-DocumentReference-1 profile elements.</p>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> <code class=\"highlighter-rouge\">NRL-DocumentReference-1</code> inherits from the base HL7 <code class=\"highlighter-rouge\">DocumentReference</code> and restricts some fields that are cardinality <code class=\"highlighter-rouge\">0..*</code> or <code class=\"highlighter-rouge\">1..*</code> in the base profile to <code class=\"highlighter-rouge\">1..1</code>. In addition, due to the mapping between XML elements and JSON properties, FHIR views JSON arrays with a single entry as “flat”.<br /><br />However, to ensure interoperability, JSON arrays with cardinality 1 MUST NOT be flattened. For example, <code class=\"highlighter-rouge\">class.coding</code> MUST be an array containing a single object, rather than an object. For details, see <a href=\"#json-example\">the JSON example</a> below.</div>\n\n<table>\n  <thead>\n    <tr>\n      <th>Data Item</th>\n      <th><a href=\"https://hl7.org/fhirpath/\">FHIRPath</a></th>\n      <th>Data Type</th>\n      <th><abbr title=\"Cardinality\">Card</abbr></th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Identifier</td>\n      <td><code class=\"highlighter-rouge\">id</code></td>\n      <td>string</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation time. Uniquely identifies this record within the NRL. Used by Providers to update or delete.</td>\n    </tr>\n    <tr>\n      <td>Profile</td>\n      <td><code class=\"highlighter-rouge\">meta<wbr />.profile</code></td>\n      <td>uri</td>\n      <td>0..1</td>\n      <td>The URI of the FHIR profile that the resource conforms to. Indicates the version of the pointer model.</td>\n    </tr>\n    <tr>\n      <td>Version</td>\n      <td><code class=\"highlighter-rouge\">meta<wbr />.versionId</code></td>\n      <td>string</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation or update time. Used to track the current version of a Pointer.</td>\n    </tr>\n    <tr>\n      <td>Pointer last updated datetime</td>\n      <td><code class=\"highlighter-rouge\">meta<wbr />.lastUpdated</code></td>\n      <td>datetime</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation and update time. The date and time that the pointer was last updated.</td>\n    </tr>\n    <tr>\n      <td>Pointer indexed datetime</td>\n      <td><code class=\"highlighter-rouge\">indexed</code></td>\n      <td>datetime</td>\n      <td>0..1</td>\n      <td>Assigned by the NRL at creation time. The date and time that the pointer was created.</td>\n    </tr>\n    <tr>\n      <td>Master Identifier</td>\n      <td><code class=\"highlighter-rouge\">masterIdentifier</code></td>\n      <td>Identifier</td>\n      <td>0..1</td>\n      <td>An optional identifier of the document as assigned by the Provider. It is version specific — a new master identifier is required if the document is updated.</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">masterIdentifier<wbr />.system</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>The namespace for the identifier. This element must be completed if the masterIdentifier is to be included.</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">masterIdentifier<wbr />.value</code></td>\n      <td>String</td>\n      <td>1..1</td>\n      <td>The unique value of the identifier. This element must be completed if the masterIdentifier is to be included.</td>\n    </tr>\n    <tr>\n      <td>Pointer Status</td>\n      <td><code class=\"highlighter-rouge\">status</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>The status of the pointer</td>\n    </tr>\n    <tr>\n      <td>Patient</td>\n      <td><code class=\"highlighter-rouge\">subject</code></td>\n      <td>Reference</td>\n      <td>1..1</td>\n      <td>The NHS number of the patient that the record referenced by this Pointer relates to. Supports Pointer retrieval scenarios.</td>\n    </tr>\n    <tr>\n      <td>Pointer owner</td>\n      <td><code class=\"highlighter-rouge\">custodian</code></td>\n      <td>Reference</td>\n      <td>1..1</td>\n      <td>ODS code for the pointer owner organization.</td>\n    </tr>\n    <tr>\n      <td>Record owner</td>\n      <td><code class=\"highlighter-rouge\">author</code></td>\n      <td>Reference</td>\n      <td>1..1</td>\n      <td>ODS code for the record owner organization.</td>\n    </tr>\n    <tr>\n      <td>Record category</td>\n      <td><code class=\"highlighter-rouge\">class</code></td>\n      <td><a href=\"overview_glossary.html#\" data-toggle=\"tooltip\" title=\"\"></a></td>\n      <td>1..1</td>\n      <td>A high-level category of the record. The category will be one of a controlled set. It will not be possible to create a pointer with a category that does not exist within this controlled set</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">class<wbr />.coding<!--[0]--><wbr />.system</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>Identity of the terminology system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">class<wbr />.coding<!--[0]--><wbr />.code</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>Symbol in syntax defined by the system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">class<wbr />.coding<!--[0]--><wbr />.display</code></td>\n      <td>String</td>\n      <td>1..1</td>\n      <td>Representation defined by the system</td>\n    </tr>\n    <tr>\n      <td>Record type</td>\n      <td><code class=\"highlighter-rouge\">type</code></td>\n      <td><a href=\"overview_glossary.html#\" data-toggle=\"tooltip\" title=\"\"></a></td>\n      <td>1..1</td>\n      <td>The clinical type of the record. Used to support searching to allow Consumers to make sense of large result sets of Pointers.</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">type<wbr />.coding<!--[0]--><wbr />.system</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>Example Value: http://snomed.info/sct.</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">type<wbr />.coding<!--[0]--><wbr />.code</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>Symbol in syntax defined by the system. Example Value: 736253002</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">type<wbr />.coding<!--[0]--><wbr />.display</code></td>\n      <td>String</td>\n      <td>1..1</td>\n      <td>Representation defined by the system.</td>\n    </tr>\n    <tr>\n      <td>Record creation clinical setting</td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.practiceSetting</code></td>\n      <td><a href=\"overview_glossary.html#\" data-toggle=\"tooltip\" title=\"\"></a></td>\n      <td>1..1</td>\n      <td>Describes where the content was created, in what clinical setting</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.practiceSetting<wbr />.coding<!--[0]--><wbr />.system</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>Identity of the terminology system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.practiceSetting<wbr />.coding<!--[0]--><wbr />.code</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>Symbol in syntax defined by the system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.practiceSetting<wbr />.coding<!--[0]--><wbr />.display</code></td>\n      <td>String</td>\n      <td>1..1</td>\n      <td>Representation defined by the system</td>\n    </tr>\n    <tr>\n      <td>Period of care</td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.period</code></td>\n      <td>Period</td>\n      <td>0..1</td>\n      <td>Details the time at which the documented care is relevant</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.period<wbr />.start</code></td>\n      <td>dateTime</td>\n      <td>1..1</td>\n      <td>Starting time with inclusive boundary</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">context<wbr />.period<wbr />.end</code></td>\n      <td>dateTime</td>\n      <td>0..1</td>\n      <td>End time with inclusive boundary, if not ongoing</td>\n    </tr>\n    <tr>\n      <td>Pointer referenced</td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--></code></td>\n      <td>BackboneElement</td>\n      <td>1..*</td>\n      <td>Record referenced</td>\n    </tr>\n    <tr>\n      <td>Record creation datetime</td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.attachment<wbr />.creation</code></td>\n      <td>dateTime</td>\n      <td>0..1</td>\n      <td>The date and time (on the Provider’s system) that the record was created, for static records.</td>\n    </tr>\n    <tr>\n      <td>Record URL</td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.attachment<wbr />.url</code></td>\n      <td>uri</td>\n      <td>1..1</td>\n      <td>Absolute URL for the location of the record on the Provider’s system and/ or a service that allows you to look up information based on the provider url e.g. web page with service contact details.</td>\n    </tr>\n    <tr>\n      <td>Record format</td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.format</code></td>\n      <td>Coding</td>\n      <td>1..1</td>\n      <td>Describes the technical structure and rules of the record such that the Consumer can pick an appropriate mechanism to handle the record.</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.format<wbr />.system</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>Identity of the terminology system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.format<wbr />.code</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>Symbol in syntax defined by the system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.format<wbr />.display</code></td>\n      <td>String</td>\n      <td>1..1</td>\n      <td>Representation defined by the system</td>\n    </tr>\n    <tr>\n      <td>Record MIME type</td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.attachment<wbr />.contentType</code></td>\n      <td>code</td>\n      <td>1..1</td>\n      <td>Describes the type of data such that the Consumer can pick an appropriate mechanism to handle the record.</td>\n    </tr>\n    <tr>\n      <td>Record Stability</td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.extension:contentStability</code></td>\n      <td>Extension</td>\n      <td>1..1</td>\n      <td>Record content extension</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.extension:contentStability<wbr />.url</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>identifies the meaning of the extension</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.extension:contentStability.<wbr />valueCodeableConcept</code></td>\n      <td><a href=\"overview_glossary.html#\" data-toggle=\"tooltip\" title=\"\"></a></td>\n      <td>1..1</td>\n      <td>Describes whether the record content at the time of the request is dynamically generated or is static</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.extension:contentStability.<wbr />valueCodeableConcept<wbr />.coding<!--[0]--><wbr />.system</code></td>\n      <td>Uri</td>\n      <td>1..1</td>\n      <td>Identity of the terminology system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.extension:contentStability.<wbr />valueCodeableConcept<wbr />.coding<!--[0]--><wbr />.code</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>Symbol in syntax defined by the system</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">content<!--[0..*]--><wbr />.extension:contentStability.<wbr />valueCodeableConcept<wbr />.coding<!--[0]--><wbr />.display</code></td>\n      <td>String</td>\n      <td>1..1</td>\n      <td>Representation defined by the system</td>\n    </tr>\n    <tr>\n      <td>Related documents</td>\n      <td><code class=\"highlighter-rouge\">relatesTo</code></td>\n      <td>BackboneElement</td>\n      <td>0..1</td>\n      <td>Relationship to another pointer</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">relatesTo<wbr />.code</code></td>\n      <td>Code</td>\n      <td>1..1</td>\n      <td>The type of relationship between the documents. This element is mandatory if the <em>relatesTo</em> element is sent and the value MUST be <em>replaces</em>.</td>\n    </tr>\n    <tr>\n      <td> </td>\n      <td><code class=\"highlighter-rouge\">relatesTo<wbr />.target</code></td>\n      <td>Reference</td>\n      <td>1..1</td>\n      <td>The Target of the relationship. This should contain the logical reference to the target DocumentReference held within the NRL using the identifier property of this <a href=\"https://www.hl7.org/fhir/references.html#logical\">Reference Data Type</a>.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"3-valuesets\">3. ValueSets</h2>\n\n<div class=\"alert alert-warning\" role=\"alert\"><i class=\"fa fa-warning\"></i> <b>Important:</b> The NRL RecordType valueset has been renamed from <b>NRLS-RecordType-1</b> to <b>NRL-RecordType-1</b>.</div>\n\n<p>Links to the NRL FHIR value sets on the NHS FHIR Reference Server.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Valueset</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRL-RecordType-1\">NRL-RecordType-1</a></td>\n      <td>A ValueSet that identifies the NRL record type.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRL-FormatCode-1\">NRL-FormatCode-1</a></td>\n      <td>A ValueSet that identifies the NRL record format.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRL-PracticeSetting-1\">NRL-PracticeSetting-1</a></td>\n      <td>A ValueSet that identifies the NRL record practice setting.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRL-RecordClass-1\">NRL-RecordClass-1</a></td>\n      <td>A ValueSet that identifies the NRL record category.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRL-ContentStability-1\">NRL-ContentStability-1</a></td>\n      <td>A ValueSet that identifies the NRL record stability.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1\">Spine-ErrorOrWarningCode-1</a></td>\n      <td>A ValueSet that identifies the Spine error or warning code in response to a request.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/ValueSet/spine-response-code-1-0\">Spine-Response-Code-1-0</a></td>\n      <td>A set of codes to indicate low level error information about a Spine 2 error response to a request for patient record details. Exceptions raised by the Spine common requesthandler and not the NRL Service will be returned using the Spine default <a href=\"https://fhir.nhs.uk/StructureDefinition/spine-operationoutcome-1-0\">spine-operationoutcome-1-0</a> profile which binds to this default ValueSet.</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Display values for SNOMED CT concepts MUST be as listed in the FHIR value sets. The display value is the preferred term and one of the synonyms for the concept, not the Fully Specified Name, as described in the <a href=\"https://www.hl7.org/fhir/STU3/snomedct.html\">FHIR guidance for usage of SNOMED CT</a>.</div>\n\n<h2 id=\"4-extensions\">4. Extensions</h2>\n\n<p>Links to the NRL FHIR Extensions on the NHS FHIR Reference Server.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Extension</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\">Extension-NRL-ContentStability-1</a></td>\n      <td>NRL Record Content Stability.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"5-codesystems\">5. CodeSystems</h2>\n\n<p>Links to the NRL FHIR CodeSystems on the NHS FHIR Reference Server.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>CodeSystem</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/CodeSystem/Spine-ErrorOrWarningCode-1\">Spine-ErrorOrWarningCode-1</a></td>\n      <td>Spine error codes and descriptions.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\">NRL-ContentStability-1</a></td>\n      <td>NRL record stability codes and descriptions.</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\">NRL-FormatCode-1</a></td>\n      <td>NRL record format codes and descriptions.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 id=\"6-identifiers\">6. Identifiers</h2>\n\n<p>NRL supported URIs:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>identifier</th>\n      <th>URI</th>\n      <th>Comment</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Logical ID</code></td>\n      <td><code class=\"highlighter-rouge\">[baseurl]/DocumentReference/[id]</code></td>\n      <td>Pointer identifier</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Patient</code></td>\n      <td><code class=\"highlighter-rouge\">https://demographics.spineservices.nhs.uk/STU3/Patient/[NHS Number]</code></td>\n      <td>Patient NHS Number</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Organisation</code></td>\n      <td><code class=\"highlighter-rouge\">https://directory.spineservices.nhs.uk/STU3/Organization/[ODS Code]</code></td>\n      <td>Record author or record owner ODS code</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Master Identifier</code></td>\n      <td><code class=\"highlighter-rouge\">Identifier=[system]%7C[value]</code></td>\n      <td>Pointer local/business identifier</td>\n    </tr>\n  </tbody>\n</table>\n\n<div class=\"alert alert-danger\" role=\"alert\"><i class=\"fa fa-exclamation-circle\"></i> <b>Warning:</b> The URIs on subdomain <code class=\"highlighter-rouge\">spineservices.nhs.uk</code> are currently not resolvable, however this will change in the future where references relate to FHIR endpoints in our national systems.</div>\n\n<h2 id=\"7-examples\">7. Examples</h2>\n\n<h3 id=\"json-example\">JSON Example</h3>\n\n<p>A JSON example of a DocumentReference resource is displayed below.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"DocumentReference\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"c037a0cb-0c77-4976-83a1-a5d2703e6aa3-23325861873450086113\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"meta\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"profile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"status\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"current\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"736253002\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health crisis plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"class\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"734163000\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Care plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"subject\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"indexed\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"author\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"custodian\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"content\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"attachment\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"contentType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"application/pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"creation\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"format\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:nhs-ic:unstructured\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Unstructured Document\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"extension\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"valueCodeableConcept\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                            </span><span class=\"p\">{</span><span class=\"w\">\n                                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"static\"</span><span class=\"p\">,</span><span class=\"w\">\n                                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Static\"</span><span class=\"w\">\n                            </span><span class=\"p\">}</span><span class=\"w\">\n                        </span><span class=\"p\">]</span><span class=\"w\">\n                    </span><span class=\"p\">}</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"context\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"period\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"start\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"w\">\n        </span><span class=\"p\">},</span><span class=\"w\">\n        </span><span class=\"s2\">\"practiceSetting\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"708168004\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health service\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n\n<h3 id=\"xml-example\">XML Example</h3>\n\n<p>An XML example of a DocumentReference resource is displayed below.</p>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference</span> <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"c037a0cb-0c77-4976-83a1-a5d2703e6aa3-23325861873450086113\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n"
		
	}
	,

	{
		
		"title": "Retrieval Consumer Guidance",
		"tags": "for_consumersrecord_retrieval",
		"keywords": "structured rest documentreference",
		"url": "retrieval_consumer_guidance.html",
		"summary": "Consumer requirements and guidance for record and document retrieval.",
		"content": "<h2 id=\"http-request\">HTTP Request</h2>\n\n<p>Retrieval of documents/records is achieved through an HTTP GET request. See the <a href=\"retrieval_interaction_read.html\">Retrieval Read Interaction</a> page for details of the requirements for creating and sending an HTTP GET request for retrieval.</p>\n\n<h2 id=\"requests-via-the-ssp\">Requests via the SSP</h2>\n\n<p>Where a document/record is to be retrieved via the SSP, the Consumer MUST percent encode the <code class=\"highlighter-rouge\">content.attachment.url</code> property, taken from an NRL pointer, and prefix it with the SSP server URL. For more details, see the <a href=\"retrieval_interaction_read.html#retrieval-via-the-ssp\">Retrieval Read</a> interaction page.</p>\n\n<h2 id=\"provider-asid\">Provider ASID</h2>\n\n<p>Consumers MUST include the provider ASID in the SSP-To HTTP Header when performing a retrieval request via the SSP.</p>\n\n<p>The provider ASID can be obtained through performing a <a href=\"https://developer.nhs.uk/apis/spine-core-1-0/build_directory.html\">Spine Directory Services (SDS)</a> lookup. This can be done using the record author ODS code, which is included in the pointer metadata, and the interaction ID <code class=\"highlighter-rouge\">urn:nhs:names:services:nrl:DocumentReference.content</code>.</p>\n\n<p>A worked example of the endpoint look-up process can be found in the <a href=\"https://developer.nhs.uk/apis/spine-core-1-0/build_endpoints_example_spine_fhir.html\">Spine Core specification</a>.</p>\n\n<p>If multiple ASIDs are found for the ODS code and interaction ID, the associated FQDN can be matched to the record URL FQDN to obtain the correct ASID.</p>\n\n<h2 id=\"handling-multiple-formats\">Handling Multiple Formats</h2>\n\n<p>Where a Pointer contains reference to multiple formats for a single record, Consuming systems can decide which is the most appropriate format to display within their system.</p>\n\n<p>For example, a record may be available as a PDF document but also as a FHIR resource. In this situation, Consumers may find it preferable to display the FHIR resource if the Consuming system can understand and process this format.</p>\n"
		
	}
	,

	{
		
		"title": "Retrieval Formats",
		"tags": "fhirpointersrecord_retrieval",
		"keywords": "structured rest documentreference",
		"url": "retrieval_formats.html",
		"summary": "Formats for record and document retrieval",
		"content": "<h2 id=\"retrieval-formats\">Retrieval Formats</h2>\n\n<p>The NRL may support retrieval of records and documents in a range of formats, including both unstructured documents and structured data.</p>\n\n<p>The format of the referenced record is detailed in two metadata fields:</p>\n<ul>\n  <li>Record format — describes the technical structure and the rules of the record.</li>\n  <li>Record MIME type — describes the data type of the record.</li>\n</ul>\n\n<p>See <a href=\"explore_reference.html\">FHIR Resources &amp; References</a> for more details on the data model.</p>\n\n<p>The combination of these two metadata fields describes to a Consumer system the type and structure of the content that will be returned. This gives the Consumer system the information it needs to know to render the referenced record. For example, the referenced content could be a publicly accessible web page containing contact details, an unstructured PDF document, or a specific FHIR profile. See below for more details and the list of currently supported formats.</p>\n\n<h2 id=\"supported-formats\">Supported Formats</h2>\n\n<p>The following table describes the formats that are currently supported:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Format</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Contact Details (HTTP Unsecured)</td>\n      <td>A publicly accessible HTML web page or PDF detailing contact details for retrieving a record.<br /><br />Note that retrieval requests for contact details should be made directly and not via the SSP.</td>\n    </tr>\n    <tr>\n      <td>Unstructured Document</td>\n      <td>An unstructured document, such as a PDF. The content-type of the document returned SHOULD be in the MIME type as described on the pointer metadata (<code class=\"highlighter-rouge\">DocumentReference.content[x].attachment.contentType</code>).<br /><br />For unstructured documents, Consumers and Providers SHOULD support PDF as a minimum.<br /><br />An example API endpoint for handling unstructured documents can be seen in the <a href=\"https://nhsconnect.github.io/CareConnectAPI/api_documents_binary.html#readresponse\">CareConnect GET Binary specification (“Query 1 - Default Query” in section 1.1)</a>.</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>Please see the <a href=\"https://fhir.nhs.uk/STU3/ValueSet/NRL-FormatCode-1\">format code value set</a> for the list of codes to use.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> Format codes related to profiles that support structured data are not currently listed in the above referenced valueset and table. These will be added at a later date.</div>\n\n<p>Note that the NRL supports referencing multiple formats of a record document on a single Pointer. See below for details.</p>\n\n<h2 id=\"multiple-formats\">Multiple Formats</h2>\n\n<p>Multiple formats of a record or document can be made available through a single Pointer on the NRL. For example, a Pointer can contain a reference to retrieve a record in PDF format and as a structured FHIR resource. Each format must be detailed in a separate content element on the DocumentReference (Pointer).</p>\n\n<h3 id=\"multiple-format-example\">Multiple Format Example</h3>\n\n<p>The following examples show a pointer for a Mental Health Crisis Plan that can be retrieved over the phone (using the contact details listed on the referenced HTML web page) and directly as a PDF document.</p>\n\n<h4 id=\"xml\">XML</h4>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-xml\" data-lang=\"xml\"><span class=\"nt\">&lt;DocumentReference&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;masterIdentifier&gt;</span>\n        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/masterIdentifier&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">\"current\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"736253002\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health crisis plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/type&gt;</span>\n    <span class=\"nt\">&lt;class&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"734163000\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Care plan\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/class&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;indexed</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;author&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/author&gt;</span>\n    <span class=\"nt\">&lt;custodian&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/custodian&gt;</span>\n    <span class=\"nt\">&lt;relatesTo&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"replaces\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;target&gt;</span>\n            <span class=\"nt\">&lt;identifier&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:ietf:rfc:3986\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/identifier&gt;</span>\n        <span class=\"nt\">&lt;/target&gt;</span>\n    <span class=\"nt\">&lt;/relatesTo&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"application/pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:unstructured\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Unstructured Document\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;content&gt;</span>\n        <span class=\"nt\">&lt;attachment&gt;</span>\n            <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">\"text/html\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"https://p1.nhs.uk/MentalhealthCrisisTeam\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;creation</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/attachment&gt;</span>\n        <span class=\"nt\">&lt;format&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:nhs-ic:record-contact\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Contact details (HTTP Unsecured)\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/format&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"static\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Static\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/content&gt;</span>\n    <span class=\"nt\">&lt;context&gt;</span>\n        <span class=\"nt\">&lt;period&gt;</span>\n            <span class=\"nt\">&lt;start</span> <span class=\"na\">value=</span><span class=\"s\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/period&gt;</span>\n        <span class=\"nt\">&lt;practiceSetting&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"708168004\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Mental health service\"</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/practiceSetting&gt;</span>\n    <span class=\"nt\">&lt;/context&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span></code></pre></figure>\n\n</div>\n\n<h4 id=\"json\">JSON</h4>\n\n<div class=\"github-sample-wrapper scroll-height-350\">\n\n<figure class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"DocumentReference\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"0353e505-f7be-4c20-8f4e-337e79a32c51-76009894321256642261\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"meta\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"profile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/NRL-DocumentReference-1\"</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"masterIdentifier\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:ietf:rfc:3986\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"s2\">\"value\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.7\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"status\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"current\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"736253002\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health crisis plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"class\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n            </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"734163000\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Care plan\"</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">]</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"indexed\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:01+01:00\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">\"subject\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://demographics.spineservices.nhs.uk/STU3/Patient/9876543210\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"author\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RGD\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"custodian\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"reference\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://directory.spineservices.nhs.uk/STU3/Organization/RR8\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">\"relatesTo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"replaces\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"s2\">\"target\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"identifier\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:ietf:rfc:3986\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"value\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:oid:1.3.6.1.4.1.21367.2005.3.6\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"content\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"attachment\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"contentType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"application/pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://p1.nhs.uk/MentalhealthCrisisPlanReport.pdf\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"creation\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"format\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:nhs-ic:unstructured\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Unstructured Document\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"extension\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"valueCodeableConcept\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                        </span><span class=\"p\">{</span><span class=\"w\">\n                            </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"static\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Static\"</span><span class=\"w\">\n                        </span><span class=\"p\">}</span><span class=\"w\">\n                    </span><span class=\"p\">]</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">},</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"attachment\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"contentType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"text/html\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://p1.nhs.uk/MentalhealthCrisisTeam\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"creation\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-08T15:26:00+01:00\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"format\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-FormatCode-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:nhs-ic:record-contact\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Contact details (HTTP Unsecured)\"</span><span class=\"w\">\n            </span><span class=\"p\">},</span><span class=\"w\">\n            </span><span class=\"s2\">\"extension\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                </span><span class=\"s2\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"valueCodeableConcept\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                        </span><span class=\"p\">{</span><span class=\"w\">\n                            </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://fhir.nhs.uk/STU3/CodeSystem/NRL-ContentStability-1\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"static\"</span><span class=\"p\">,</span><span class=\"w\">\n                            </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Static\"</span><span class=\"w\">\n                        </span><span class=\"p\">}</span><span class=\"w\">\n                    </span><span class=\"p\">]</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">}</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">],</span><span class=\"w\">\n    </span><span class=\"s2\">\"context\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">\"period\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"start\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2016-03-07T13:34:00+01:00\"</span><span class=\"w\">\n        </span><span class=\"p\">},</span><span class=\"w\">\n        </span><span class=\"s2\">\"practiceSetting\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"s2\">\"coding\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"p\">{</span><span class=\"w\">\n                    </span><span class=\"s2\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://snomed.info/sct\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"708168004\"</span><span class=\"p\">,</span><span class=\"w\">\n                    </span><span class=\"s2\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Mental health service\"</span><span class=\"w\">\n                </span><span class=\"p\">}</span><span class=\"w\">\n            </span><span class=\"p\">]</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span></code></pre></figure>\n\n</div>\n"
		
	}
	,

	{
		
		"title": "Retrieval Read Interaction",
		"tags": "for_consumersrecord_retrieval",
		"keywords": "structured rest documentreference",
		"url": "retrieval_interaction_read.html",
		"summary": "Requirements and guidance for record and document retrieval Read Interaction.",
		"content": "<h2 id=\"read-request\">Read Request</h2>\n\n<p>Retrieval of a referenced record is done through an <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3\">HTTP(S) GET</a> request to the record URL contained on the pointer.</p>\n\n<p>Retrieval requests should be made through the Spine Secure Proxy (SSP). An exception is made for retrieving publicly accessible contact details (format “Contact Details (HTTP Unsecured)”), for which requests should be made directly.</p>\n\n<p>Consumer and Provider retrieval HTTP requests support the following HTTP request headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header(s)</th>\n      <th>Value</th>\n      <th>Conformance</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Authorization</code></td>\n      <td>The <code class=\"highlighter-rouge\">Authorization</code> header will carry the base64url encoded JSON web token required for audit on the Spine - see <a href=\"integration_access_tokens_JWT.html\">Access Tokens (JWT)</a> for details.</td>\n      <td>REQUIRED</td>\n    </tr>\n    <tr>\n      <td>SSP Headers</td>\n      <td>See below for details</td>\n      <td> </td>\n    </tr>\n  </tbody>\n</table>\n\n<p>Requests SHOULD NOT require any additional custom headers.</p>\n\n<p>Requests SHOULD NOT require any additional parameters to be passed in the URL.</p>\n\n<h2 id=\"read-response\">Read Response</h2>\n\n<p>Success:</p>\n\n<ul>\n  <li>MUST return a <code class=\"highlighter-rouge\">200</code> <strong>SUCCESS</strong> HTTP status code on successful execution of the interaction.</li>\n  <li>MUST return a response body containing the requested record/document in the format described in the format metadata attributes on the pointer. See <a href=\"retrieval_formats.html\">Retrieval Formats</a> for more details.</li>\n</ul>\n\n<p>Failure:</p>\n<ul>\n  <li>MUST return an error type HTTP status code</li>\n  <li>SHOULD return a response body with diagnostic details.</li>\n</ul>\n\n<h2 id=\"retrieval-via-the-ssp\">Retrieval via the SSP</h2>\n\n<p>The role of the SSP in retrieval of documents/records is to be a single common authentication and authorisation gateway for all Consumers and Providers.</p>\n\n<p>Retrieval requests via proxy are secured and audited by the SSP. For full technical details, see the <a href=\"https://developer.nhs.uk/apis/spine-core-1-0/ssp_overview.html\">SSP specification</a>.</p>\n\n<h3 id=\"ssp-url\">SSP URL</h3>\n\n<p>Where a document/record is to be retrieved via the SSP then Consumers MUST percent encode the <code class=\"highlighter-rouge\">content.attachment.url</code> property and prefix it with the SSP server URL as follows:</p>\n\n<div class=\"alert alert-success\" role=\"alert\">\n<code class=\"highlighter-rouge\">GET https://[proxy_server]/[percent_encoded_record_url]</code>\n</div>\n\n<p>For example:</p>\n\n<div class=\"language-http highlighter-rouge\">\n<pre class=\"highlight\">\n<code><span class=\"err\">GET https://[proxy_server]/https%3A%2F%2Fp1.nhs.uk%2FMentalHealthCrisisPlans%2Fda2b6e8a-3c8f-11e8-baae-6c3be5a609f5\n</span></code></pre>\n</div>\n\n<p>This request would fetch a Mental Health Crisis Plan with the logical id of <code class=\"highlighter-rouge\">da2b6e8a-3c8f-11e8-baae-6c3be5a609f5</code> from a Provider system located at <code class=\"highlighter-rouge\">https://p1.nhs.uk</code> via the Spine Secure Proxy.</p>\n\n<div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> When creating Pointers, Providers MUST NOT prefix the Pointer URL property with the SSP server URL and MUST NOT percent encode it. In other words, Consumers are fully responsible for constructing the Spine proxy URL from the Pointer URL.</div>\n\n<h3 id=\"ssp-headers\">SSP Headers</h3>\n\n<p>The HTTP GET request MUST include a number of Spine-specific HTTP headers:</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Header</th>\n      <th>Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Ssp-TraceID</code></td>\n      <td>Consumer’s TraceID (i.e. GUID/UUID)</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Ssp-From</code></td>\n      <td>Consumer’s ASID</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Ssp-To</code></td>\n      <td>Provider’s ASID</td>\n    </tr>\n    <tr>\n      <td><code class=\"highlighter-rouge\">Ssp-InteractionID</code></td>\n      <td>Spine’s Interaction ID.<br /><br />The interaction ID for retrieving a record referenced in an NRL pointer is specific to the NRL service and is as follows:<br /><br /><code class=\"highlighter-rouge\">urn:nhs:names:services:nrl:DocumentReference.content.read</code></td>\n    </tr>\n  </tbody>\n</table>\n\n<p>Please refer to the <a href=\"https://developer.nhs.uk/apis/spine-core-1-0/ssp_overview.html\">Spine Secure Proxy Implementation Guide</a> for full technical details.</p>\n\n<p>Guidance on obtaining the provider ASID can be found on the <a href=\"retrieval_consumer_guidance.html#interaction-id\">Consumer Guidance</a> page.</p>\n\n<h2 id=\"authentication-and-authorisation\">Authentication and Authorisation</h2>\n\n<p>Systems that interact with the SSP MUST meet the secure connection requirements of the SSP.</p>\n\n<p>Consumer systems MUST ensure that users are authenticated and authorised, using an appropriate access control mechanism, before retrieving records and documents. HTTP(S) requests to the SSP for retrieving records and documents will include an access token (JWT), which can be used in Provider systems for auditing purposes. Providers are not required to perform any further authentication or authorisation.</p>\n\n<p>More details can be found on the <a href=\"integration_authentication_authorisation.html\">Authentication &amp; Authorisation</a> page.</p>\n"
		
	}
	,

	{
		
		"title": "Retrieval Overview",
		"tags": "record_retrievalfor_consumersfor_providers",
		"keywords": "structured rest documentreference",
		"url": "retrieval_overview.html",
		"summary": "Solution overview of record and document retrieval",
		"content": "<h2 id=\"retrieval\">Retrieval</h2>\n\n<p>Documents and records can be retrieved directly from the Providers that hold the documents/records. This is achieved by using the location information (record URL/endpoint) stored on a pointer (obtained from a pointer search) and sending a request to this location over HTTP(S) via the Spine Secure Proxy (SSP).</p>\n\n<p>The process of retrieving a document or record from a provider in this way may be manually triggered by the end user. Retrieval could also be an automated process triggered after a successful patient match from PDS, for example.  The latter example would be transparent to the end user.</p>\n\n<h2 id=\"spine-secure-proxy-ssp\">Spine Secure Proxy (SSP)</h2>\n\n<p>The SSP is a content agnostic forward proxy, which is used to control and protect access to health systems. It provides a single security point for both authentication and authorisation for systems. See the <a href=\"https://developer.nhs.uk/apis/spine-core/ssp_overview.html\">SSP specification</a> for more details.</p>\n\n<h2 id=\"end-to-end-retrieval-solution\">End-to-End Retrieval Solution</h2>\n\n<p>The following diagram describes how record retrieval is facilitated through the SSP using the Record URL stored on the pointer.</p>\n\n<p><a href=\"images/retrieval/retrieval_concept_diagram.png\" target=\"_blank\">\n    <img src=\"images/retrieval/retrieval_concept_diagram.png\" alt=\"Retrieval solution end-to-end\" /><br /><br />\n    Click to view the diagram at full size.\n</a></p>\n\n<p>As the diagram depicts, the step-by-step process end-to-end for retrieving a record or document is as follows:</p>\n<ol>\n  <li>Consumer system queries the NRL to see if any Pointers exist for the patient under their care.</li>\n  <li>Consumer system finds a Pointer that references a record which could be of value for the provision of care.</li>\n  <li>\n    <p>Consumer system takes the URL property value (see <a href=\"overview_data_model.html\">Pointer Data Model</a> for details) from the Pointer that was found and uses this value to create a request to the Provider system that holds the record.</p>\n\n    <p>The URL property is prefixed with the URL to the SSP, which will ensure that the request goes via the SSP and that all necessary security checks are performed on the request. The SSP base url prefix is added by the Consumer system. For more details, see the <a href=\"retrieval_interaction_read.html#retrieval-via-the-ssp\">Retrieval Read</a> interaction page.</p>\n\n    <div class=\"alert alert-info\" role=\"alert\"><i class=\"fa fa-info-circle\"></i> <b>Note:</b> The URL property should be fully <a href=\"https://tools.ietf.org/html/rfc3986#section-2.1\">percent encoded per RFC 3986</a> to prevent any possibility of parsing errors.</div>\n\n    <p>An example SSP-prefixed URL:</p>\n\n    <div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>https://testspineproxy.nhs.uk/https%3A%2F%2Fprovider.thirdparty.nhs.uk%2FAB1%2FStatic%2Fc1cd026e-e06b-4121-bb08-a3cb8f53c58b\n</code></pre></div>    </div>\n  </li>\n  <li>Consumer [system] sends the request to the Provider system.</li>\n  <li>Request sent by the Consumer goes through the SSP, where security checks are performed.</li>\n  <li>Request is then sent onto the Provider system that holds the record once security checks are passed.</li>\n  <li>Provider system receives and validates the request.</li>\n  <li>Provider system sends the requested record back to the Consumer, via the SSP.</li>\n  <li>Consumer [system] receives the record and processes it ready to display to the end user.</li>\n</ol>\n\n<p>For more details on requirements for facilitating retrieval, see the <a href=\"retrieval_interaction_read.html\">retrieval read interaction</a>.</p>\n"
		
	}
	,

	{
		
		"title": "Retrieval Provider Guidance",
		"tags": "for_providersrecord_retrieval",
		"keywords": "structured rest documentreference",
		"url": "retrieval_provider_guidance.html",
		"summary": "Provider requirements and guidance for record and document retrieval.",
		"content": "<h2 id=\"http-request\">HTTP Request</h2>\n\n<p>Retrieval of documents/records is achieved through an HTTP GET request. See the <a href=\"retrieval_interaction_read.html\">Retrieval Read Interaction</a> page for details of the requirements for responding to an HTTP GET request for retrieval.</p>\n\n<h2 id=\"provider-endpoint-and-interaction-id-registration\">Provider Endpoint and Interaction ID Registration</h2>\n\n<p>Endpoints for retrieval must be registered on the Spine Directory Service (SDS). For the Beta phase, this will be done by the NHS Digital Deployment Issue and Resolution (DIR) team following completion of assurance.</p>\n\n<p>The requirements for registering endpoints on SDS are as follows:</p>\n\n<ol>\n  <li>Every system MUST have a unique ASID for each organisation using it. For example, the same system deployed into three organisations would be represented by three unique ASIDs.</li>\n  <li>All interactions with the SSP MUST be over port 443.</li>\n  <li>Endpoints MUST NOT include explicit port declarations (e.g. <code class=\"highlighter-rouge\">:443</code>).</li>\n  <li>Endpoints MUST have be registered with the interaction ID <code class=\"highlighter-rouge\">urn:nhs:names:services:nrl:DocumentReference.content</code>.</li>\n</ol>\n\n<p>See the <a href=\"https://developer.nhs.uk/apis/spine-core/ssp_providers.html\">Spine Core specification</a> for further detail on registering provider endpoints.</p>\n\n<p>Providers MUST ensure that the record author ODS code on the pointer metadata matches the ODS code for the endpoint registered in SDS. This is required to enable Consumers to perform an SDS lookup to obtain the Provider system ASID and populate the Ssp-To header in the retrieval request.</p>\n\n<h2 id=\"fully-qualified-domain-name-fqdn\">Fully Qualified Domain Name (FQDN)</h2>\n\n<p>Following completion of assurance, Providers will be supplied with an <a href=\"https://tools.ietf.org/html/rfc5280\" target=\"_blank\">X.509 Certificate</a> and an FQDN. The FQDN will form the base of Provider Endpoints as detailed above. For more details, see the <a href=\"development_api_security_guidance.html\">Security page</a>.</p>\n"
		
	}
	,

	{
		
		"title": "search",
		"tags": "",
		"keywords": "",
		"url": "search.json",
		"summary": "",
		"content": "[\n  {% for post in site.posts %}\n    {\n      \"title\"    : \"{{ post.title | escape }}\",\n      \"category\" : \"{{ post.category }}\",\n      \"tags\"     : \"{{ post.tags | join: ', ' }}\",\n      \"url\"      : \"{{ site.baseurl }}{{ post.url }}\",\n      \"date\"     : \"{{ post.date }}\",\n      \"content\"  : \"{{ post.content | strip_html | strip_newlines }}\"\n    } {% unless forloop.last %},{% endunless %}\n  {% endfor %}\n  {% if post.title != nil %},{% endif %}\n\n{% for page in site.pages %}\n\t{\n\t\t{% if page.title != nil %}\n\t\t\"title\": \"{{ page.title | strip_html | strip_newlines | remove_chars | escape }}\",\n\t\t\"tags\": \"{{ page.tags }}\",\n\t\t\"keywords\": \"{{page.keywords}}\",\n\t\t\"url\": \"{{ page.url | remove: \"/\"}}\",\n\t\t\"summary\": \"{{page.summary | strip_html | strip_newlines | remove_chars | escape }}\",\n\t\t\"content\": {{ page.content | jsonify }}\n\t\t{% endif %}\n\t}\n\t{% unless forloop.last %},{% endunless %}\n{% endfor %}\n\n\n]"
		
	}
	,

	{
		
		"title": "Communication Channels",
		"tags": "support",
		"keywords": "support communications community",
		"url": "support_communications.html",
		"summary": "Communication channels used for the NRL FHIR&amp;reg; API.",
		"content": "## Enquiries\n\nFor general enquiries, please send an email to the NRL team at [nrls@nhs.net](mailto:nrls@nhs.net).\n"
		
	}
	,

	{
		
		"title": "Frequently Asked Questions (FAQ)",
		"tags": "support",
		"keywords": "support faq questions",
		"url": "support_faq.html",
		"summary": "Frequently Asked Questions (FAQ).",
		"content": "{% comment %}\nhttps://idratherbewriting.com/documentation-theme-jekyll/mydoc_faq_layout.html\n{% endcomment %}\n\n{% assign last_idx = site.data.faqs.size | minus: 1 %}\n\n<div class=\"panel-group\" id=\"faqs\">\n{% for idx in (0..last_idx) %}\n<div class=\"panel panel-default\">\n<div class=\"panel-heading\">\n<div class=\"panel-title\">\n<a class=\"noCrossRef accordion-toggle\" data-toggle=\"collapse\" data-parent=\"#faqs\" href=\"#faq-{{ idx }}\" markdown=\"1\">\n{{ site.data.faqs[idx].question }}\n</a>\n</div>\n</div>\n<div id=\"faq-{{ idx }}\" class=\"panel-collapse collapse noCrossRef\">\n<div class=\"panel-body\" markdown=\"1\">\n{{ site.data.faqs[idx].answer }}\n</div>\n</div>\n</div>\n{% endfor %}\n</div>\n"
		
	}
	,

	{
		
		"title": "API",
		"tags": "",
		"keywords": "",
		"url": "tag_api.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Case Studies",
		"tags": "",
		"keywords": "",
		"url": "tag_casestudies.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Clinical",
		"tags": "",
		"keywords": "",
		"url": "tag_clinical.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Design",
		"tags": "",
		"keywords": "",
		"url": "tag_design.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Development",
		"tags": "",
		"keywords": "",
		"url": "tag_development.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Diagnostics",
		"tags": "",
		"keywords": "",
		"url": "tag_diagnostics.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "No CareConnect Profile",
		"tags": "",
		"keywords": "",
		"url": "tag_noccprofile.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Engage",
		"tags": "",
		"keywords": "",
		"url": "tag_engage.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "FHIR",
		"tags": "",
		"keywords": "",
		"url": "tag_fhir.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Foundation",
		"tags": "",
		"keywords": "",
		"url": "tag_foundation.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Identification",
		"tags": "",
		"keywords": "",
		"url": "tag_identification.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Introduction",
		"tags": "",
		"keywords": "",
		"url": "tag_introduction.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Medication",
		"tags": "",
		"keywords": "",
		"url": "tag_medication.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Overview",
		"tags": "",
		"keywords": "",
		"url": "tag_overview.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Pointers",
		"tags": "",
		"keywords": "",
		"url": "tag_pointer.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Rest",
		"tags": "",
		"keywords": "",
		"url": "tag_rest.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Support",
		"tags": "",
		"keywords": "",
		"url": "tag_support.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "User Stories",
		"tags": "",
		"keywords": "",
		"url": "tag_user_stories.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Workflow",
		"tags": "",
		"keywords": "",
		"url": "tag_workflow.html",
		"summary": "",
		"content": "{% include tag_redirect.html %}\n"
		
	}
	,

	{
		
		"title": "Tags",
		"tags": "",
		"keywords": "",
		"url": "tags.html",
		"summary": "Filterable list of pages by tag",
		"content": "{% include taglogic.html %}"
		
	}
	,

	{
		
		"title": "Test Overview",
		"tags": "testing",
		"keywords": "test",
		"url": "test.html",
		"summary": "These pages assist with requirements for testing the API.",
		"content": "{% include custom/under.construction.html content=\"Please check back later for any updates to this page.\" %}\n\n<!--\n### 1. Testing Overview\nThe Test section contains a common baseline for testing FHIR-based APIs to ensure a satisfactory level of technical conformance has been reached. A FHIR-based API contains individual layers that require testing, which when combined will form a complete and detailed test log for the API prior to any formal assurance activities being carried out.\n\nTesting may include the following:\n\n- API conformance based on NHS Digital FHIR policy \n- RESTful conformance\n- Security\n- Authentication\n- Payload(s)\n- Spine Integration\n- Clinical Safety\n- End-to-End Testing\n\nDepending on the API, it may be necessary to carry out the additional non-functional testing:\n\n- Penetration Testing\n- Performance\n- Volumetrics\n\n### 2. FHIR Servers\n\nWhere testing requires the use of a FHIR server, there are several options available.\n\n#### 2.1 Public Servers\n\nThere are many freely available public servers that can be used to test with.  For a comprehensive list of servers, navigate to [Publicly Available FHIR Servers for testing](http://wiki.hl7.org/index.php?title=Publicly_Available_FHIR_Servers_for_testing)\n\n#### 2.2 Local/Private Server\n\nThere are two well supported FHIR servers that can be downloaded and used for testing within your own environment:\n\n**HAPI-FHIR**\n\nA servlet based RESTful server, which is an open-source application written in Java. More information can be found at [http://hapifhir.io/](http://hapifhir.io/).\n\n**Furore Vonk**\n\nVonk is created by Furore and is a user friendly RESTful server. It's free for testing, but does require that you restart the server everyday. It can be ran in Docker or as a .NET executable. More information can be found at [https://fhir.furore.com/](https://fhir.furore.com/)\n-->\n\n<!--\nThe Test section contains descriptions of approaches and suggestions for building APIs.\n\n| Page              |  Description    |\n|+---------------------|+--------------------------------+|\n| Patterns / Topology | Describes access patterns necessary which influence the access, security, and use of APIs. Depending on the pattern or topology of the requesting and responding system. The relationship between the requestor and responder influences the choice of access mechanism, security of payload and access finally build of the system |\n| Access | The access mechanism and of requesting system is influenced by many factors. This section demonstrates the design decisions to consider | \n| Security | The security of the FHIR payload, access, and data at rest are all important design decisions while building an API. | \n| Test Data | The test data allows the testing of the API at the individual response level. | \n\n{% include note.html content=\"This section provides an overview of the main elements of the testing process to consider within API development\" %}\n\n# Providing an API\n\nThe following diagram explains the elements of APIs allowing a the development of APIs:\n\n{% include custom/provide_api.svg %}\n\n# Contribute\n\nThis site is structured around API users, developers, and architects. Please get involved in the journey.\n\n{% include custom/api_overview.svg %}\n-->"
		
	}
	,

	{
		
		"title": "Access | Test",
		"tags": "testing",
		"keywords": "test access security",
		"url": "test_access.html",
		"summary": "The Access page shows developers and users of the API how to access and call the API in the test environment",
		"content": "{% include important.html content=\"All phases outlined below are indicative and subject to on-going review.\" %}\n\n# Access to Test\n\nAccess at the Test stage of API development needs careful consideration of the following key challenges.\n\n- Endpoints\n- Transformation\n- Versioning\n\n{% include note.html content=\"Provided as an overview\" %}\n\n# API Considerations\n\nOther API consideration are shown below. Please click on the parts of the API process to continue your API creation journey.\n\n{% include custom/provide_api.svg %}\n\n{% include custom/contribute.html content=\"Get in involved and contribute to the above API considerations by contacting [interoperabilityteam@nhs.net](mailto:interoperabilityteam@nhs.net).\"%}"
		
	}
	,

	{
		
		"title": "Test Data",
		"tags": "testingsecurity",
		"keywords": "test pattern security",
		"url": "test_data.html",
		"summary": "The test data expected to be delivered by ",
		"content": "{% include important.html content=\"The API security described in this section is not meant to be complete but a starting point to understand some design considerations to consider when implementing APIs.\" %}\n\n# Test Data within Test\n\nThe test data allows the testing of an API at the individual response level.\n\n{% include note.html content=\"Provided as an overview\" %}\n\n# API Considerations\n\nOther API consideration are shown below. Please click on the parts of the API process to continue your API creation journey.\n\n{% include custom/provide_api.svg %}\n\n{% include custom/contribute.html content=\"Get in involved and contribute to the above API considerations by contacting [interoperabilityteam@nhs.net](mailto:interoperabilityteam@nhs.net).\"%}\n"
		
	}
	,

	{
		
		"title": "Design Patterns / Topology",
		"tags": "testing",
		"keywords": "test pattern security",
		"url": "test_patterns.html",
		"summary": "The Design Patterns / Topology demonstrates and describes how various design patterns can influence access, security, and use of APIs",
		"content": "{% include important.html content=\"All phases outlined below are indicative and subject to on-going review.\" %}\n\n# Patterns within Testing\n\nDefining the design pattern (listed below) and your method of testing the pattern is important at this stage. \n\n- Single Shared Application\n- Portal\n- Click Through\n- Store and Notify\n- Broadcast (Point to Point Sharing)\n- Shared Repository\n- Message Broker\n- Registry Repository\n- Publish Subscribe\n\nThe same choice of testing your design pattern will need to meet your Assurance and Deploying criteria.\n\n{% include note.html content=\"Provided as an overview\" %}\n\n# API Considerations\n\nOther API consideration are shown below. Please click on the parts of the API process to continue your API creation journey.\n\n{% include custom/provide_api.svg %}\n\n{% include custom/contribute.html content=\"Get involved and contribute to the above API considerations by contacting [interoperabilityteam@nhs.net](mailto:interoperabilityteam@nhs.net).\"%}\n"
		
	}
	,

	{
		
		"title": "Security",
		"tags": "testingsecurityauthenticationauthorisation",
		"keywords": "test pattern security",
		"url": "test_security.html",
		"summary": "The security page shows how to establish initial security credentials (where necessary) with the API provided",
		"content": "{% include important.html content=\"The API security described in this section is not meant to be complete but a starting point to understand some design considerations to consider when implementing APIs.\" %}\n\n# Security within Test\n\nSecurity starts to be a key element of the design and process for testing at this point. The following four key principles should be considered:\n\n- Authentication\n- Authorisation\n- Encryption\n- Signatures\n\n# Security Examples\n\nThe following non-exhaustive list describes common security patterns and links to example cases where they are used:\n\n- Basic Auth\n- OAuth2\n- Certifications/SSL\n- JWT - GP Connect\n- OpenId\n- NHS Verify (UK only)\n- Citizen Id (UK only)\n- SmartCards (UK only)\n\nDepending on the chosen end usage, channel, and network will influence the chosen security choice.\n\n# API Considerations\n\nOther API consideration are shown below. Please click on the parts of the API process to continue your API creation journey.\n\n{% include custom/provide_api.svg %}\n\n{% include custom/contribute.html content=\"Get involved and contribute to the above API considerations by contacting [nrls@interoperabilityteam.net](mailto:nrls@interoperabilityteam.net).\"%}\n"
		
	}
	,

	{
		
	}
	,

	{
		
	}
	,

	{
		
	}
	,

	{
		
	}
	,

	{
		
	}
	,

	{
		
	}
	



]